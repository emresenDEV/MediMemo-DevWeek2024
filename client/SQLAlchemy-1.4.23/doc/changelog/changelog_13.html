<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

        <title>
            
    
    1.3 Changelog
 &mdash;
    SQLAlchemy 1.4 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/default.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 1.4 Documentation" href="../index.html" />
        <link rel="up" title="Changes and Migration" href="index.html" />
        <link rel="next" title="1.2 Changelog" href="changelog_12.html" />
        <link rel="prev" title="1.4 Changelog" href="changelog_14.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">1.4.23</span>


        | Release Date: August 18, 2021

    </div>

    <h1><a href="../index.html">SQLAlchemy 1.4 Documentation</a></h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">


        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 1.4 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../contents.html">Contents</a> |
                <a href="../genindex.html">Index</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="Changes and Migration">Changes and Migration</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="migration_14.html">What’s New in SQLAlchemy 1.4?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_20.html">Migrating to SQLAlchemy 2.0</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_14.html">1.4 Changelog</a></span></li>
<li class="selected"><span class="link-container"><strong>1.3 Changelog</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.25">1.3.25</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.25-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.25-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.25-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.25-sqlite">sqlite</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24">1.3.24</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.24-mssql">mssql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23">1.3.23</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.23-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.22">1.3.22</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.22-oracle">oracle</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21">1.3.21</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.21-oracle">oracle</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20">1.3.20</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.20-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19">1.3.19</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-orm-declarative">orm declarative</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.19-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18">1.3.18</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.18-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17">1.3.17</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.17-firebird">firebird</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16">1.3.16</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-orm-declarative">orm declarative</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.16-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.15">1.3.15</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.15-orm">orm</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14">1.3.14</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-general">general</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.14-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13">1.3.13</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.13-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.12">1.3.12</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.12-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.12-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.12-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.12-mssql">mssql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11">1.3.11</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-schema">schema</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-firebird">firebird</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.11-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.10">1.3.10</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.10-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.10-oracle">oracle</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9">1.3.9</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.9-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.8">1.3.8</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.8-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.8-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.8-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.8-sqlite">sqlite</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7">1.3.7</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.7-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6">1.3.6</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.6-mssql">mssql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.5">1.3.5</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.5-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.5-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.5-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.5-mysql">mysql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4">1.3.4</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.4-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.3">1.3.3</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.3-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.3-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.3-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.3-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.2">1.3.2</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.2-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.2-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.2-postgresql">postgresql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.1">1.3.1</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.1-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.1-mssql">mssql</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0">1.3.0</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0-schema">schema</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3">1.3.0b3</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3-orm-declarative">orm declarative</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b3-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2">1.3.0b2</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-general">general</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-orm-declarative">orm declarative</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b2-misc">misc</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1">1.3.0b1</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-orm">orm</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-orm-declarative">orm declarative</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-engine">engine</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-sql">sql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-postgresql">postgresql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-mysql">mysql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-sqlite">sqlite</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-mssql">mssql</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-oracle">oracle</a></span></li>
<li><span class="link-container"><a class="reference external" href="#change-1.3.0b1-misc">misc</a></span></li>
</ul>
</li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="changelog_12.html">1.2 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_11.html">1.1 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_10.html">1.0 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_09.html">0.9 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_08.html">0.8 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_07.html">0.7 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_06.html">0.6 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_05.html">0.5 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_04.html">0.4 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_03.html">0.3 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_02.html">0.2 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="changelog_01.html">0.1 Changelog</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_13.html">What’s New in SQLAlchemy 1.3?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_12.html">What’s New in SQLAlchemy 1.2?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_11.html">What’s New in SQLAlchemy 1.1?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_10.html">What’s New in SQLAlchemy 1.0?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_09.html">What’s New in SQLAlchemy 0.9?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_08.html">What’s New in SQLAlchemy 0.8?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_07.html">What’s New in SQLAlchemy 0.7?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_06.html">What’s New in SQLAlchemy 0.6?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_05.html">What’s new in SQLAlchemy 0.5?</a></span></li>
<li><span class="link-container"><a class="reference external" href="migration_04.html">What’s new in SQLAlchemy 0.4?</a></span></li>
</ul>



        </div>

        </div>

    </div>

    

    <div id="docs-body" class="withsidebar changelog-changelog_13" >
        
<section id="changelog">
<h1>1.3 Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h1>
<section id="change-1.3.25">
<h2 class="release-version">1.3.25<a class="headerlink" href="#change-1.3.25" title="Permalink to this headline">¶</a></h2>
no release date<section id="change-1.3.25-orm">
<h3>orm<a class="headerlink" href="#change-1.3.25-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.25-0"><span class="target" id="change-90794fa5771ff688ab465dac27f92af6"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-90794fa5771ff688ab465dac27f92af6">¶</a></span><p>Fixed issue in <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.bulk_save_objects" title="sqlalchemy.orm.Session.bulk_save_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.bulk_save_objects()</span></code></a> when used with persistent
objects which would fail to track the primary key of mappings where the
column name of the primary key were different than the attribute name.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6392">#6392</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.25-schema">
<h3>schema<a class="headerlink" href="#change-1.3.25-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.25-1"><span class="target" id="change-8c6cba8dcad6ab72c1ec226086b245d0"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8c6cba8dcad6ab72c1ec226086b245d0">¶</a></span><p>The <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> object now raises an informative error message if
it is instantiated without passing at least the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.params.name" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.name</span></code></a>
and <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.params.metadata" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.metadata</span></code></a> arguments positionally. Previously, if
these were passed as keyword arguments, the object would silently fail to
initialize correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6135">#6135</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.25-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.25-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.25-2"><span class="target" id="change-6322ad92ec60b2b0773c9c2d6e4edfb4"><strong>[postgresql] [bug] [regression]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6322ad92ec60b2b0773c9c2d6e4edfb4">¶</a></span><p>Fixed regression caused by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6023">#6023</a> where the PostgreSQL cast
operator applied to elements within an <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY" title="sqlalchemy.types.ARRAY"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARRAY</span></code></a> when using
psycopg2 would fail to use the correct type in the case that the datatype
were also embedded within an instance of the <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.Variant" title="sqlalchemy.types.Variant"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code></a>
adapter.</p>
<p>Additionally, repairs support for the correct CREATE TYPE to be emitted
when using a <code class="docutils literal notranslate"><span class="pre">Variant(ARRAY(some_schema_type))</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6182">#6182</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.25-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.25-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.25-3"><span class="target" id="change-5c99e05c998371bf70071fcef0df7808"><strong>[sqlite] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5c99e05c998371bf70071fcef0df7808">¶</a></span><p>Add note regarding encryption-related pragmas for pysqlcipher passed in the
url.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6589">#6589</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.24">
<h2 class="release-version">1.3.24<a class="headerlink" href="#change-1.3.24" title="Permalink to this headline">¶</a></h2>
Released: March 30, 2021<section id="change-1.3.24-orm">
<h3>orm<a class="headerlink" href="#change-1.3.24-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.24-0"><span class="target" id="change-eb1534c1fc60375dbf5c42a01c594fe0"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-eb1534c1fc60375dbf5c42a01c594fe0">¶</a></span><p>Removed very old warning that states that passive_deletes is not intended
for many-to-one relationships. While it is likely that in many cases
placing this parameter on a many-to-one relationship is not what was
intended, there are use cases where delete cascade may want to be
disallowed following from such a relationship.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5983">#5983</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-1"><span class="target" id="change-4adf0b8bddeb193b211bfd4687d9862c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4adf0b8bddeb193b211bfd4687d9862c">¶</a></span><p>Fixed issue where the process of joining two tables could fail if one of
the tables had an unrelated, unresolvable foreign key constraint which
would raise <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.NoReferenceError" title="sqlalchemy.exc.NoReferenceError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoReferenceError</span></code></a> within the join process, which
nonetheless could be bypassed to allow the join to complete. The logic
which tested the exception for significance within the process would make
assumptions about the construct which would fail.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5952">#5952</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-2"><span class="target" id="change-2aa72167178f090222978917b10d104a"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2aa72167178f090222978917b10d104a">¶</a></span><p>Fixed issue where the <a class="reference internal" href="../orm/extensions/mutable.html#sqlalchemy.ext.mutable.MutableComposite" title="sqlalchemy.ext.mutable.MutableComposite"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableComposite</span></code></a> construct could be
placed into an invalid state when the parent object was already loaded, and
then covered by a subsequent query, due to the composite properties’
refresh handler replacing the object with a new one not handled by the
mutable extension.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6001">#6001</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.24-engine">
<h3>engine<a class="headerlink" href="#change-1.3.24-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.24-3"><span class="target" id="change-1b0c3f7d8756cade20f529546bf88fca"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1b0c3f7d8756cade20f529546bf88fca">¶</a></span><p>Fixed bug where the “schema_translate_map” feature failed to be taken into
account for the use case of direct execution of
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.DefaultGenerator" title="sqlalchemy.schema.DefaultGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultGenerator</span></code></a> objects such as sequences, which included
the case where they were “pre-executed” in order to generate primary key
values when implicit_returning was disabled.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5929">#5929</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.24-schema">
<h3>schema<a class="headerlink" href="#change-1.3.24-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.24-4"><span class="target" id="change-2c49baf292f9496b8488f5c7982b8577"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2c49baf292f9496b8488f5c7982b8577">¶</a></span><p>Fixed bug first introduced in as some combination of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/2892">#2892</a>,
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/2919">#2919</a> nnd <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3832">#3832</a> where the attachment events for a
<a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> would be doubled up against the “impl” class,
if the “impl” were also a <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.SchemaType" title="sqlalchemy.types.SchemaType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaType</span></code></a>. The real-world case
is any <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> against <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> or
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Boolean" title="sqlalchemy.types.Boolean"><code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code></a> would get a doubled
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.CheckConstraint" title="sqlalchemy.schema.CheckConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckConstraint</span></code></a> when the <code class="docutils literal notranslate"><span class="pre">create_constraint=True</span></code> flag
is set.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6152">#6152</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-5"><span class="target" id="change-6da74ff1e12dee5e51c9c2f86ebf039d"><strong>[schema] [bug] [sqlite]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6da74ff1e12dee5e51c9c2f86ebf039d">¶</a></span><p>Fixed issue where the CHECK constraint generated by <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Boolean" title="sqlalchemy.types.Boolean"><code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code></a>
or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> would fail to render the naming convention
correctly after the first compilation, due to an unintended change of state
within the name given to the constraint. This issue was first introduced in
0.9 in the fix for issue #3067, and the fix revises the approach taken at
that time which appears to have been more involved than what was needed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6007">#6007</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-6"><span class="target" id="change-79338d9880f2ad3e0b3d9413998a6bbb"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-79338d9880f2ad3e0b3d9413998a6bbb">¶</a></span><p>Repaired / implemented support for primary key constraint naming
conventions that use column names/keys/etc as part of the convention. In
particular, this includes that the <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.PrimaryKeyConstraint" title="sqlalchemy.schema.PrimaryKeyConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryKeyConstraint</span></code></a> object
that’s automatically associated with a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> will update
its name as new primary key <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> objects are added to
the table and then to the constraint. Internal failure modes related to
this constraint construction process including no columns present, no name
present or blank name present are now accommodated.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5919">#5919</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-7"><span class="target" id="change-63bc8a17b4252095ed6af6f3aac92a87"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-63bc8a17b4252095ed6af6f3aac92a87">¶</a></span><p>Adjusted the logic that emits DROP statements for <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>
objects among the dropping of multiple tables, such that all
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> objects are dropped after all tables, even if the
given <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> is related only to a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
object and not directly to the overall <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> object.
The use case supports the same <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> being associated
with more than one <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> at a time.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6071">#6071</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.24-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.24-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.24-8"><span class="target" id="change-785723b3091fdd5518a8893b3ef874fd"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-785723b3091fdd5518a8893b3ef874fd">¶</a></span><p>Fixed issue where using <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.aggregate_order_by" title="sqlalchemy.dialects.postgresql.aggregate_order_by"><code class="xref py py-class docutils literal notranslate"><span class="pre">aggregate_order_by</span></code></a> would
return ARRAY(NullType) under certain conditions, interfering with
the ability of the result object to return data correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5989">#5989</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-9"><span class="target" id="change-3bb7e8ed004c0a11cda49a2518d22db3"><strong>[postgresql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3bb7e8ed004c0a11cda49a2518d22db3">¶</a></span><p>Fixed issue in PostgreSQL reflection where a column expressing “NOT NULL”
will supersede the nullability of a corresponding domain.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6161">#6161</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.24-10"><span class="target" id="change-82a0a92e59d90a0dcdee7f31638effdc"><strong>[postgresql] [bug] [types]</strong> <a class="changelog-reference headerlink reference internal" href="#change-82a0a92e59d90a0dcdee7f31638effdc">¶</a></span><p>Adjusted the psycopg2 dialect to emit an explicit PostgreSQL-style cast for
bound parameters that contain ARRAY elements. This allows the full range of
datatypes to function correctly within arrays. The asyncpg dialect already
generated these internal casts in the final statement. This also includes
support for array slice updates as well as the PostgreSQL-specific
<code class="xref py py-meth docutils literal notranslate"><span class="pre">ARRAY.contains()</span></code> method.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/6023">#6023</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.24-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.24-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.24-11"><span class="target" id="change-e8b47ea1a93ed79212eda33302ec2c5a"><strong>[mssql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e8b47ea1a93ed79212eda33302ec2c5a">¶</a></span><p>Fixed issue regarding SQL Server reflection for older SQL Server 2005
version, a call to sp_columns would not proceed correctly without being
prefixed with the EXEC keyword. This method is not used in current 1.4
series.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5921">#5921</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.23">
<h2 class="release-version">1.3.23<a class="headerlink" href="#change-1.3.23" title="Permalink to this headline">¶</a></h2>
Released: February 1, 2021<section id="change-1.3.23-sql">
<h3>sql<a class="headerlink" href="#change-1.3.23-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.23-0"><span class="target" id="change-6c92cc47cca102492af34efb0f364875"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6c92cc47cca102492af34efb0f364875">¶</a></span><p>Fixed bug where making use of the <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.with_variant" title="sqlalchemy.types.TypeEngine.with_variant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TypeEngine.with_variant()</span></code></a> method
on a <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> type would fail to take into account the
dialect-specific mappings in use, due to a rule in <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a>
that was instead attempting to check for chains of <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a>
instances.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5816">#5816</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.23-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.23-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.23-1"><span class="target" id="change-8d93d5a5d6c874b31bb85a54a9f37f14"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8d93d5a5d6c874b31bb85a54a9f37f14">¶</a></span><p>For SQLAlchemy 1.3 only, setup.py pins pg8000 to a version lower than
1.16.6. Version 1.16.6 and above is supported by SQLAlchemy 1.4. Pull
request courtesy Giuseppe Lumia.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5645">#5645</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-2"><span class="target" id="change-73657ac9aa318eaa698716c30d588f35"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-73657ac9aa318eaa698716c30d588f35">¶</a></span><p>Fixed issue where using <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> (called
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.tometadata" title="sqlalchemy.schema.Table.tometadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.tometadata()</span></code></a> in 1.3) in conjunction with a PostgreSQL
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ExcludeConstraint" title="sqlalchemy.dialects.postgresql.ExcludeConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExcludeConstraint</span></code></a> that made use of ad-hoc column
expressions would fail to copy correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5850">#5850</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.23-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.23-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.23-3"><span class="target" id="change-6dcfad42f03f58eaae3095df21c9f242"><strong>[mysql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6dcfad42f03f58eaae3095df21c9f242">¶</a></span><p>Casting to <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code> is now supported in MySQL &gt;= (8, 0, 17) and
MariaDb &gt;= (10, 4, 5).</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5808">#5808</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-4"><span class="target" id="change-50d7dca70e0351eb9376efdd3127429c"><strong>[mysql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-50d7dca70e0351eb9376efdd3127429c">¶</a></span><p>Fixed bug where MySQL server default reflection would fail for numeric
values with a negation symbol present.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5860">#5860</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-5"><span class="target" id="change-1df03253a8b5e56e09c5e85eda2df873"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1df03253a8b5e56e09c5e85eda2df873">¶</a></span><p>Fixed long-lived bug in MySQL dialect where the maximum identifier length
of 255 was too long for names of all types of constraints, not just
indexes, all of which have a size limit of 64. As metadata naming
conventions can create too-long names in this area, apply the limit to the
identifier generator within the DDL compiler.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5898">#5898</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-6"><span class="target" id="change-a8f868df41454529b3ea2cd1418ca86e"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a8f868df41454529b3ea2cd1418ca86e">¶</a></span><p>Fixed deprecation warnings that arose as a result of the release of PyMySQL
1.0, including deprecation warnings for the “db” and “passwd” parameters
now replaced with “database” and “password”.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5821">#5821</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-7"><span class="target" id="change-f285f5d116afc22cbdc24f45b5aa92b6"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f285f5d116afc22cbdc24f45b5aa92b6">¶</a></span><p>Fixed regression from SQLAlchemy 1.3.20 caused by the fix for
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5462">#5462</a> which adds double-parenthesis for MySQL functional
expressions in indexes, as is required by the backend, this inadvertently
extended to include arbitrary <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a> expressions as well as
Alembic’s internal textual component,  which are required by Alembic for
arbitrary index expressions which don’t imply double parenthesis.  The
check has been narrowed to include only binary/ unary/functional
expressions directly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5800">#5800</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.23-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.23-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.23-8"><span class="target" id="change-54b71006103b0590cb821e6787294f4c"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-54b71006103b0590cb821e6787294f4c">¶</a></span><p>Fixed regression in Oracle dialect introduced by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4894">#4894</a> in
SQLAlchemy 1.3.11 where use of a SQL expression in RETURNING for an UPDATE
would fail to compile, due to a check for “server_default” when an
arbitrary SQL expression is not a column.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5813">#5813</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.23-9"><span class="target" id="change-69ae28dee3e0c2354124993374bc5182"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-69ae28dee3e0c2354124993374bc5182">¶</a></span><p>Fixed bug in Oracle dialect where retriving a CLOB/BLOB column via
<a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.Insert.returning" title="sqlalchemy.sql.expression.Insert.returning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Insert.returning()</span></code></a> would fail as the LOB value would need to be
read when returned; additionally, repaired support for retrieval of Unicode
values via RETURNING under Python 2.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5812">#5812</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.23-misc">
<h3>misc<a class="headerlink" href="#change-1.3.23-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.23-10"><span class="target" id="change-7dbf794fe376d7592fe6b1b1d54d14f1"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7dbf794fe376d7592fe6b1b1d54d14f1">¶</a></span><p>Fixed issue where the stringification that is sometimes called when
attempting to generate the “key” for the <code class="docutils literal notranslate"><span class="pre">.c</span></code> collection on a selectable
would fail if the column were an unlabeled custom SQL construct using the
<code class="docutils literal notranslate"><span class="pre">sqlalchemy.ext.compiler</span></code> extension, and did not provide a default
compilation form; while this seems like an unusual case, it can get invoked
for some ORM scenarios such as when the expression is used in an “order by”
in combination with joined eager loading.  The issue is that the lack of a
default compiler function was raising <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.CompileError" title="sqlalchemy.exc.CompileError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompileError</span></code></a> and not
<a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.UnsupportedCompilationError" title="sqlalchemy.exc.UnsupportedCompilationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnsupportedCompilationError</span></code></a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5836">#5836</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.22">
<h2 class="release-version">1.3.22<a class="headerlink" href="#change-1.3.22" title="Permalink to this headline">¶</a></h2>
Released: December 18, 2020<section id="change-1.3.22-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.22-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.22-0"><span class="target" id="change-a77ccea4f2881b4a5be41b8b1d36b38b"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a77ccea4f2881b4a5be41b8b1d36b38b">¶</a></span><p>Fixed regression which occured due to <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5755">#5755</a> which implemented
isolation level support for Oracle.   It has been reported that many Oracle
accounts don’t actually have permission to query the <code class="docutils literal notranslate"><span class="pre">v$transaction</span></code>
view so this feature has been altered to gracefully fallback when it fails
upon database connect, where the dialect will assume “READ COMMITTED” is
the default isolation level as was the case prior to SQLAlchemy 1.3.21.
However, explicit use of the <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.get_isolation_level" title="sqlalchemy.engine.Connection.get_isolation_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.get_isolation_level()</span></code></a>
method must now necessarily raise an exception, as Oracle databases with
this restriction explicitly disallow the user from reading the current
isolation level.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5784">#5784</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.21">
<h2 class="release-version">1.3.21<a class="headerlink" href="#change-1.3.21" title="Permalink to this headline">¶</a></h2>
Released: December 17, 2020<section id="change-1.3.21-orm">
<h3>orm<a class="headerlink" href="#change-1.3.21-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-0"><span class="target" id="change-1983659ca84de18adc73c0ae3fd5cd60"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1983659ca84de18adc73c0ae3fd5cd60">¶</a></span><p>Added a comprehensive check and an informative error message for the case
where a mapped class, or a string mapped class name, is passed to
<a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship.params.secondary" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">relationship.secondary</span></code></a>.  This is an extremely common error
which warrants a clear message.</p>
<p>Additionally, added a new rule to the class registry resolution such that
with regards to the <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship.params.secondary" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">relationship.secondary</span></code></a> parameter, if a
mapped class and its table are of the identical string name, the
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> will be favored when resolving this parameter.   In all
other cases, the class continues to be favored if a class and table
share the identical name.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5774">#5774</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-1"><span class="target" id="change-377e70b3f06fb4b100c8a4182baf138c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-377e70b3f06fb4b100c8a4182baf138c">¶</a></span><p>Fixed bug in <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.update" title="sqlalchemy.orm.Query.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.update()</span></code></a> where objects in the
<code class="xref py py-class docutils literal notranslate"><span class="pre">_ormsession.Session</span></code> that were already expired would be
unnecessarily SELECTed individually when they were refreshed by the
“evaluate”synchronize strategy.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5664">#5664</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-2"><span class="target" id="change-f7c60804d8991a59bfd0f1bf4deaa2e7"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f7c60804d8991a59bfd0f1bf4deaa2e7">¶</a></span><p>Fixed bug involving the <code class="docutils literal notranslate"><span class="pre">restore_load_context</span></code> option of ORM events such
as <code class="xref py py-meth docutils literal notranslate"><span class="pre">InstanceEvents.load()</span></code> such that the flag would not be
carried along to subclasses which were mapped after the event handler were
first established.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5737">#5737</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-sql">
<h3>sql<a class="headerlink" href="#change-1.3.21-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-3"><span class="target" id="change-a333e56945388d5950141200f347f127"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a333e56945388d5950141200f347f127">¶</a></span><p>A warning is emmitted if a returning() method such as
<a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.Insert.returning" title="sqlalchemy.sql.expression.Insert.returning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Insert.returning()</span></code></a> is called multiple times, as this does not
yet support additive operation.  Version 1.4 will support additive
operation for this.  Additionally, any combination of the
<a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.Insert.returning" title="sqlalchemy.sql.expression.Insert.returning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Insert.returning()</span></code></a> and <a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.ValuesBase.return_defaults" title="sqlalchemy.sql.expression.ValuesBase.return_defaults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ValuesBase.return_defaults()</span></code></a>
methods now raises an error as these methods are mutually exclusive;
previously the operation would fail silently.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5691">#5691</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-4"><span class="target" id="change-62f2f136424abbc603b5f9e12ca53b07"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-62f2f136424abbc603b5f9e12ca53b07">¶</a></span><p>Fixed structural compiler issue where some constructs such as MySQL /
PostgreSQL “on conflict / on duplicate key” would rely upon the state of
the <code class="xref py py-class docutils literal notranslate"><span class="pre">Compiler</span></code> object being fixed against their statement as
the top level statement, which would fail in cases where those statements
are branched from a different context, such as a DDL construct linked to a
SQL statement.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5656">#5656</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.21-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-5"><span class="target" id="change-d08a2199b3ec968c5888066e803e4509"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d08a2199b3ec968c5888066e803e4509">¶</a></span><p>Added new parameter <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.ops" title="sqlalchemy.dialects.postgresql.ExcludeConstraint"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ExcludeConstraint.ops</span></code></a> to the
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ExcludeConstraint" title="sqlalchemy.dialects.postgresql.ExcludeConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExcludeConstraint</span></code></a> object, to support operator class
specification with this constraint.  Pull request courtesy Alon Menczer.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5604">#5604</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-6"><span class="target" id="change-5de8d1c92ac9d1dd4620bc70ff60fe1b"><strong>[postgresql] [bug] [mysql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5de8d1c92ac9d1dd4620bc70ff60fe1b">¶</a></span><p>Fixed regression introduced in 1.3.2 for the PostgreSQL dialect, also
copied out to the MySQL dialect’s feature in 1.3.18, where usage of a non
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> construct such as <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a> as the argument
to <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Select.with_for_update.params.of" title="sqlalchemy.sql.expression.Select.with_for_update"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Select.with_for_update.of</span></code></a> would fail to be accommodated
correctly within the PostgreSQL or MySQL compilers.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5729">#5729</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.21-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-7"><span class="target" id="change-eef365d140876c68efd1542e3bbd5aaa"><strong>[mysql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-eef365d140876c68efd1542e3bbd5aaa">¶</a></span><p>Fixed issue where reflecting a server default on MariaDB only that
contained a decimal point in the value would fail to be reflected
correctly, leading towards a reflected table that lacked any server
default.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5744">#5744</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-8"><span class="target" id="change-87b86012a5e16326df6cd23f8b956cf7"><strong>[mysql] [sql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-87b86012a5e16326df6cd23f8b956cf7">¶</a></span><p>Added missing keywords to the <code class="docutils literal notranslate"><span class="pre">RESERVED_WORDS</span></code> list for the MySQL
dialect: <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">text</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>.
Pull request courtesy Oscar Batori.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5696">#5696</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.21-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-9"><span class="target" id="change-5bcd52b1c2b25b1eb145896782c4c210"><strong>[sqlite] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5bcd52b1c2b25b1eb145896782c4c210">¶</a></span><p>Added <code class="docutils literal notranslate"><span class="pre">sqlite_with_rowid=False</span></code> dialect keyword to enable creating
tables as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">…</span> <span class="pre">WITHOUT</span> <span class="pre">ROWID</span></code>. Patch courtesy Sean Anderson.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5685">#5685</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.21-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-10"><span class="target" id="change-24035bde26e0264dcf311a9ada237482"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-24035bde26e0264dcf311a9ada237482">¶</a></span><p>Fixed bug where a CREATE INDEX statement was rendered incorrectly when
both <code class="docutils literal notranslate"><span class="pre">mssql-include</span></code> and <code class="docutils literal notranslate"><span class="pre">mssql_where</span></code> were specified. Pull request
courtesy &#64;Adiorz.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5751">#5751</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-11"><span class="target" id="change-57f11d758f9bee051c3888b368d535db"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-57f11d758f9bee051c3888b368d535db">¶</a></span><p>Added SQL Server code “01000” to the list of disconnect codes.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5646">#5646</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.21-12"><span class="target" id="change-c046adb5654cad671378007aed006d0a"><strong>[mssql] [reflection] [sqlite]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c046adb5654cad671378007aed006d0a">¶</a></span><p>Fixed issue with composite primary key columns not being reported
in the correct order. Patch courtesy &#64;fulpm.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5661">#5661</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.21-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.21-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.21-13"><span class="target" id="change-253a62e7d30f6c6e27068f1b714e274a"><strong>[oracle] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-253a62e7d30f6c6e27068f1b714e274a">¶</a></span><p>Implemented support for the SERIALIZABLE isolation level for Oracle
databases, as well as a real implementation for
<a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.get_isolation_level" title="sqlalchemy.engine.Connection.get_isolation_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.get_isolation_level()</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/oracle.html#oracle-isolation-level"><span class="std std-ref">Transaction Isolation Level / Autocommit</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5755">#5755</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.20">
<h2 class="release-version">1.3.20<a class="headerlink" href="#change-1.3.20" title="Permalink to this headline">¶</a></h2>
Released: October 12, 2020<section id="change-1.3.20-orm">
<h3>orm<a class="headerlink" href="#change-1.3.20-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-0"><span class="target" id="change-a70a24bbf96fc08a46cc36e247615755"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a70a24bbf96fc08a46cc36e247615755">¶</a></span><p>An <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.ArgumentError" title="sqlalchemy.exc.ArgumentError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentError</span></code></a> with more detail is now raised if the target
parameter for <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> is set to an unmapped object.
Prior to this change a less detailed <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> was raised.
Pull request courtesy Ramon Williams.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4428">#4428</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-1"><span class="target" id="change-1bb0432e083e4d88d181dfd5b9c63117"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1bb0432e083e4d88d181dfd5b9c63117">¶</a></span><p>Fixed issue where using a loader option against a string attribute name
that is not actually a mapped attribute, such as a plain Python descriptor,
would raise an uninformative AttributeError;  a descriptive error is now
raised.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4589">#4589</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-engine">
<h3>engine<a class="headerlink" href="#change-1.3.20-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-2"><span class="target" id="change-96d2bfebec26c4a463863296a4440fb4"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-96d2bfebec26c4a463863296a4440fb4">¶</a></span><p>Fixed issue where a non-string object sent to
<a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.SQLAlchemyError" title="sqlalchemy.exc.SQLAlchemyError"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLAlchemyError</span></code></a> or a subclass, as occurs with some third
party dialects, would fail to stringify correctly. Pull request
courtesy Andrzej Bartosiński.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5599">#5599</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-3"><span class="target" id="change-0f507553a4a9164e04e58f0e7bedcf8c"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-0f507553a4a9164e04e58f0e7bedcf8c">¶</a></span><p>Repaired a function-level import that was not using SQLAlchemy’s standard
late-import system within the sqlalchemy.exc module.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5632">#5632</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-sql">
<h3>sql<a class="headerlink" href="#change-1.3.20-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-4"><span class="target" id="change-cff93db14d2cd95ebfdb9db2b0284376"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-cff93db14d2cd95ebfdb9db2b0284376">¶</a></span><p>Fixed issue where the <code class="docutils literal notranslate"><span class="pre">pickle.dumps()</span></code> operation against
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.Over" title="sqlalchemy.sql.expression.Over"><code class="xref py py-class docutils literal notranslate"><span class="pre">Over</span></code></a> construct would produce a recursion overflow.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5644">#5644</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-5"><span class="target" id="change-9c810ac90dd36369e65847d5100b79dc"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9c810ac90dd36369e65847d5100b79dc">¶</a></span><p>Fixed bug where an error was not raised in the case where a
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.column" title="sqlalchemy.sql.expression.column"><code class="xref py py-func docutils literal notranslate"><span class="pre">column()</span></code></a> were added to more than one <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.table" title="sqlalchemy.sql.expression.table"><code class="xref py py-func docutils literal notranslate"><span class="pre">table()</span></code></a> at a
time.  This raised correctly for the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> and
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects. An <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.ArgumentError" title="sqlalchemy.exc.ArgumentError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentError</span></code></a> is now
raised when this occurs.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5618">#5618</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.20-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-6"><span class="target" id="change-ce602292b1d6943009a8061d05ed44d2"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ce602292b1d6943009a8061d05ed44d2">¶</a></span><p>The psycopg2 dialect now support PostgreSQL multiple host connections, by
passing host/port combinations to the query string. Pull request courtesy
Ramon Williams.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/postgresql.html#psycopg2-multi-host"><span class="std std-ref">Specifying multiple fallback hosts</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4392">#4392</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-7"><span class="target" id="change-a39de5662008fe7962ef3a8aeccde623"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a39de5662008fe7962ef3a8aeccde623">¶</a></span><p>Adjusted the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY.Comparator.any" title="sqlalchemy.types.ARRAY.Comparator.any"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.any()</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY.Comparator.all" title="sqlalchemy.types.ARRAY.Comparator.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.all()</span></code></a> methods to implement a straight “NOT”
operation for negation, rather than negating the comparison operator.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5518">#5518</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-8"><span class="target" id="change-d90e929f13843e1bce61eeec74ed391e"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d90e929f13843e1bce61eeec74ed391e">¶</a></span><p>Fixed issue where the <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ENUM" title="sqlalchemy.dialects.postgresql.ENUM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ENUM</span></code></a> type would not consult the
schema translate map when emitting a CREATE TYPE or DROP TYPE during the
test to see if the type exists or not.  Additionally, repaired an issue
where if the same enum were encountered multiple times in a single DDL
sequence, the “check” query would run repeatedly rather than relying upon a
cached value.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5520">#5520</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.20-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-9"><span class="target" id="change-23a0c766b845c542a279b4a41188a063"><strong>[mysql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-23a0c766b845c542a279b4a41188a063">¶</a></span><p>Adjusted the MySQL dialect to correctly parenthesize functional index
expressions as accepted by MySQL 8. Pull request courtesy Ramon Williams.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5462">#5462</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-10"><span class="target" id="change-30cccf6a7a449d7663c16285d901bf5b"><strong>[mysql] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-30cccf6a7a449d7663c16285d901bf5b">¶</a></span><p>Add new MySQL reserved words: <code class="docutils literal notranslate"><span class="pre">cube</span></code>, <code class="docutils literal notranslate"><span class="pre">lateral</span></code> added in MySQL 8.0.1
and 8.0.14, respectively; this indicates that these terms will be quoted if
used as table or column identifier names.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5539">#5539</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-11"><span class="target" id="change-b84d065a6ba763f54c34bf3157311897"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b84d065a6ba763f54c34bf3157311897">¶</a></span><p>The “skip_locked” keyword used with <code class="docutils literal notranslate"><span class="pre">with_for_update()</span></code> will emit a
warning when used on MariaDB backends, and will then be ignored.   This is
a deprecated behavior that will raise in SQLAlchemy 1.4, as an application
that requests “skip locked” is looking for a non-blocking operation which
is not available on those backends.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5568">#5568</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-12"><span class="target" id="change-2d0170507a99a2bdd69dacf3f67ea900"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2d0170507a99a2bdd69dacf3f67ea900">¶</a></span><p>Fixed bug where an UPDATE statement against a JOIN using MySQL multi-table
format would fail to include the table prefix for the target table if the
statement had no WHERE clause, as only the WHERE clause were scanned to
detect a “multi table update” at that particular point.  The target
is now also scanned if it’s a JOIN to get the leftmost table as the
primary table and the additional entries as additional FROM entries.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5617">#5617</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.20-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-13"><span class="target" id="change-2bbc8440bc6cd5a42487cc55c18e7f93"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2bbc8440bc6cd5a42487cc55c18e7f93">¶</a></span><p>Fixed issue where a SQLAlchemy connection URI for Azure DW with
<code class="docutils literal notranslate"><span class="pre">authentication=ActiveDirectoryIntegrated</span></code> (and no username+password)
was not constructing the ODBC connection string in a way that was
acceptable to the Azure DW instance.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5592">#5592</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.20-misc">
<h3>misc<a class="headerlink" href="#change-1.3.20-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.20-14"><span class="target" id="change-49c7b7d57551a0f03b3159b7fb9d0261"><strong>[bug] [pool]</strong> <a class="changelog-reference headerlink reference internal" href="#change-49c7b7d57551a0f03b3159b7fb9d0261">¶</a></span><p>Fixed issue where the following pool parameters were not being propagated
to the new pool created when <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.dispose()</span></code></a> were called:
<code class="docutils literal notranslate"><span class="pre">pre_ping</span></code>, <code class="docutils literal notranslate"><span class="pre">use_lifo</span></code>.  Additionally the <code class="docutils literal notranslate"><span class="pre">recycle</span></code> and
<code class="docutils literal notranslate"><span class="pre">reset_on_return</span></code> parameter is now propagated for the
<code class="xref py py-class docutils literal notranslate"><span class="pre">AssertionPool</span></code> class.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5582">#5582</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-15"><span class="target" id="change-3e3b73696e37ea66439e602ef2618dbe"><strong>[bug] [associationproxy] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3e3b73696e37ea66439e602ef2618dbe">¶</a></span><p>An informative error is now raised when attempting to use an association
proxy element as a plain column expression to be SELECTed from or used in a
SQL function; this use case is not currently supported.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5541">#5541</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5542">#5542</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.20-16"><span class="target" id="change-bfadf1e6c9d520a428cc2183f597a7fb"><strong>[bug] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bfadf1e6c9d520a428cc2183f597a7fb">¶</a></span><p>Fixed incompatibilities in the test suite when running against Pytest 6.x.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5635">#5635</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.19">
<h2 class="release-version">1.3.19<a class="headerlink" href="#change-1.3.19" title="Permalink to this headline">¶</a></h2>
Released: August 17, 2020<section id="change-1.3.19-orm">
<h3>orm<a class="headerlink" href="#change-1.3.19-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-0"><span class="target" id="change-1bbfe974c92905ffc8d33bcc6db0fb47"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1bbfe974c92905ffc8d33bcc6db0fb47">¶</a></span><p>Adjusted the workings of the <a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper.all_orm_descriptors" title="sqlalchemy.orm.Mapper.all_orm_descriptors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mapper.all_orm_descriptors()</span></code></a>
accessor to represent the attributes in the order that they are located in
a deterministic way, assuming the use of Python 3.6 or higher which
maintains the sorting order of class attributes based on how they were
declared.   This sorting is not guaranteed to match the declared order of
attributes in all cases however; see the method documentation for the exact
scheme.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5494">#5494</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-orm-declarative">
<h3>orm declarative<a class="headerlink" href="#change-1.3.19-orm-declarative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-1"><span class="target" id="change-ea5f0bd17e882055b4935b6821188218"><strong>[orm] [declarative] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ea5f0bd17e882055b4935b6821188218">¶</a></span><p>The name of the virtual column used when using the
<a class="reference internal" href="../orm/extensions/declarative/index.html#sqlalchemy.ext.declarative.AbstractConcreteBase" title="sqlalchemy.ext.declarative.AbstractConcreteBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractConcreteBase</span></code></a> and
<a class="reference internal" href="../orm/extensions/declarative/index.html#sqlalchemy.ext.declarative.ConcreteBase" title="sqlalchemy.ext.declarative.ConcreteBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcreteBase</span></code></a> classes can now be customized, to allow
for models that have a column that is actually named <code class="docutils literal notranslate"><span class="pre">type</span></code>.  Pull
request courtesy Jesse-Bakker.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5513">#5513</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-sql">
<h3>sql<a class="headerlink" href="#change-1.3.19-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-2"><span class="target" id="change-8b09733756d49d79c85091d0f935aa86"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8b09733756d49d79c85091d0f935aa86">¶</a></span><p>Repaired an issue where the “ORDER BY” clause rendering a label name rather
than a complete expression, which is particularly important for SQL Server,
would fail to occur if the expression were enclosed in a parenthesized
grouping in some cases.   This case has been added to test support. The
change additionally adjusts the “automatically add ORDER BY columns when
DISTINCT is present” behavior of ORM query, deprecated in 1.4, to more
accurately detect column expressions that are already present.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5470">#5470</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.19-3"><span class="target" id="change-5b43dc5ac40e9afbbd98e42b9fdbcbaa"><strong>[sql] [bug] [datatypes]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5b43dc5ac40e9afbbd98e42b9fdbcbaa">¶</a></span><p>The <code class="docutils literal notranslate"><span class="pre">LookupError</span></code> message will now provide the user with up to four
possible values that a column is constrained to via the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>.
Values longer than 11 characters will be truncated and replaced with
ellipses. Pull request courtesy Ramon Williams.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4733">#4733</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.19-4"><span class="target" id="change-0f866b4e49d10ae8c73cee8681f94609"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-0f866b4e49d10ae8c73cee8681f94609">¶</a></span><p>Fixed issue where the
<a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.execution_options.params.schema_translate_map" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Connection.execution_options.schema_translate_map</span></code></a>
feature would not take effect when the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence.next_value" title="sqlalchemy.schema.Sequence.next_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sequence.next_value()</span></code></a>
function function for a <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> were used in the
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.server_default</span></code></a> parameter and the create table
DDL were emitted.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5500">#5500</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.19-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-5"><span class="target" id="change-056da765e6c30c093fe05c70a462fa19"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-056da765e6c30c093fe05c70a462fa19">¶</a></span><p>Fixed issue where the return type for the various RANGE comparison
operators would itself be the same RANGE type rather than BOOLEAN, which
would cause an undesirable result in the case that a
<a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> that defined result-processing behavior were in
use.  Pull request courtesy Jim Bosch.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5476">#5476</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.19-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-6"><span class="target" id="change-73345b902c7525e84b7bc8379771907f"><strong>[mysql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-73345b902c7525e84b7bc8379771907f">¶</a></span><p>The MySQL dialect will render FROM DUAL for a SELECT statement that has no
FROM clause but has a WHERE clause. This allows things like “SELECT 1 WHERE
EXISTS (subquery)” kinds of queries to be used as well as other use cases.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5481">#5481</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.19-7"><span class="target" id="change-56d199f2902c4b2b18cafbc6e199af77"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-56d199f2902c4b2b18cafbc6e199af77">¶</a></span><p>Fixed an issue where CREATE TABLE statements were not specifying the
COLLATE keyword correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5411">#5411</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.19-8"><span class="target" id="change-4940e784d27f938f63ec82ea1c5d4097"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4940e784d27f938f63ec82ea1c5d4097">¶</a></span><p>Added MariaDB code 1927 to the list of “disconnect” codes, as recent
MariaDB versions apparently use this code when the database server was
stopped.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5493">#5493</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.19-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-9"><span class="target" id="change-41aee7db17a2852eb4ca01038fe1f4f0"><strong>[sqlite] [bug] [mssql] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-41aee7db17a2852eb4ca01038fe1f4f0">¶</a></span><p>Applied a sweep through all included dialects to ensure names that contain
single or double quotes are properly escaped when querying system tables,
for all <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector" title="sqlalchemy.engine.reflection.Inspector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inspector</span></code></a> methods that accept object names as an argument
(e.g. table names, view names, etc).   SQLite and MSSQL contained two
quoting issues that were repaired.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5456">#5456</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.19-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-10"><span class="target" id="change-7d421c430d3dbfc8c50fe4a860924799"><strong>[mssql] [bug] [sql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7d421c430d3dbfc8c50fe4a860924799">¶</a></span><p>Fixed bug where the mssql dialect incorrectly escaped object names that
contained ‘]’ character(s).</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5467">#5467</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.19-misc">
<h3>misc<a class="headerlink" href="#change-1.3.19-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.19-11"><span class="target" id="change-c8b0867225acab7a00cac3de66c41a67"><strong>[usecase] [py3k]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c8b0867225acab7a00cac3de66c41a67">¶</a></span><p>Added a <code class="docutils literal notranslate"><span class="pre">**kw</span></code> argument to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">DeclarativeMeta.__init__()</span></code> method.
This allows a class to support the <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0487"><strong>PEP 487</strong></a> metaclass hook
<code class="docutils literal notranslate"><span class="pre">__init_subclass__</span></code>.  Pull request courtesy Ewen Gillies.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/#5357">##5357</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.18">
<h2 class="release-version">1.3.18<a class="headerlink" href="#change-1.3.18" title="Permalink to this headline">¶</a></h2>
Released: June 25, 2020<section id="change-1.3.18-orm">
<h3>orm<a class="headerlink" href="#change-1.3.18-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-0"><span class="target" id="change-ea65ddb866c887549572fd46f3eb7135"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ea65ddb866c887549572fd46f3eb7135">¶</a></span><p>Improve error message when using <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.filter_by" title="sqlalchemy.orm.Query.filter_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter_by()</span></code></a> in
a query where the first entity is not a mapped class.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5326">#5326</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-1"><span class="target" id="change-13cf06e8831d3c917a5847e30bda422f"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-13cf06e8831d3c917a5847e30bda422f">¶</a></span><p>Added a new parameter <a class="reference internal" href="../orm/loading_columns.html#sqlalchemy.orm.query_expression.params.default_expr" title="sqlalchemy.orm.query_expression"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">query_expression.default_expr</span></code></a> to the
<a class="reference internal" href="../orm/loading_columns.html#sqlalchemy.orm.query_expression" title="sqlalchemy.orm.query_expression"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_expression()</span></code></a> construct, which will be appled to queries
automatically if the <a class="reference internal" href="../orm/loading_columns.html#sqlalchemy.orm.with_expression" title="sqlalchemy.orm.with_expression"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_expression()</span></code></a> option is not used. Pull
request courtesy Haoyu Sun.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5198">#5198</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-engine">
<h3>engine<a class="headerlink" href="#change-1.3.18-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-2"><span class="target" id="change-83bc52ea196dc68a23a1ac36a39f3229"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-83bc52ea196dc68a23a1ac36a39f3229">¶</a></span><p>Further refinements to the fixes to the “reset” agent fixed in
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5326">#5326</a>, which now emits a warning when it is not being correctly
invoked and corrects for the behavior.  Additional scenarios have been
identified and fixed where this warning was being emitted.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5326">#5326</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-3"><span class="target" id="change-a4bcb1e1c47b780b849c28fea285c81c"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a4bcb1e1c47b780b849c28fea285c81c">¶</a></span><p>Fixed issue in <a class="reference internal" href="../core/engines.html#sqlalchemy.engine.URL" title="sqlalchemy.engine.URL"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> object where stringifying the object
would not URL encode special characters, preventing the URL from being
re-consumable as a real URL.  Pull request courtesy Miguel Grinberg.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5341">#5341</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-sql">
<h3>sql<a class="headerlink" href="#change-1.3.18-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-4"><span class="target" id="change-bec095ab09a7d9c5c1c4d80e0bfb63b1"><strong>[sql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bec095ab09a7d9c5c1c4d80e0bfb63b1">¶</a></span><p>Added a “.schema” parameter to the <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.table" title="sqlalchemy.sql.expression.table"><code class="xref py py-func docutils literal notranslate"><span class="pre">table()</span></code></a> construct,
allowing ad-hoc table expressions to also include a schema name.
Pull request courtesy Dylan Modesitt.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5309">#5309</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-5"><span class="target" id="change-a47f04bf0fe3e71d92fec87033e16eaa"><strong>[sql] [change] [sybase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a47f04bf0fe3e71d92fec87033e16eaa">¶</a></span><p>Added <code class="docutils literal notranslate"><span class="pre">.offset</span></code> support to sybase dialect.
Pull request courtesy Alan D. Snow.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5294">#5294</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-6"><span class="target" id="change-ab2070ab04f12a467776b42d5dac4059"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ab2070ab04f12a467776b42d5dac4059">¶</a></span><p>Correctly apply self_group in type_coerce element.</p>
<p>The type coerce element did not correctly apply grouping rules when using
in an expression</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5344">#5344</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-7"><span class="target" id="change-4ade557668d743829838ead68804a91d"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4ade557668d743829838ead68804a91d">¶</a></span><p>Added <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="sqlalchemy.sql.expression.Select.with_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code></a> output to the generic SQL string that is
produced when calling <code class="docutils literal notranslate"><span class="pre">str()</span></code> on a statement.  Previously, this clause
would be omitted under the assumption that it was dialect specific.
The hint text is presented within brackets to indicate the rendering
of such hints varies among backends.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5353">#5353</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-8"><span class="target" id="change-a1ac25dfb7d4ce3d0becbdbe2c2dc2b6"><strong>[sql] [schema]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a1ac25dfb7d4ce3d0becbdbe2c2dc2b6">¶</a></span><p>Introduce <code class="xref py py-class docutils literal notranslate"><span class="pre">IdentityOptions</span></code> to store common parameters for
sequences and identity columns.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5324">#5324</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-schema">
<h3>schema<a class="headerlink" href="#change-1.3.18-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-9"><span class="target" id="change-41e2eb635ca19e67618170410c50ac3a"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-41e2eb635ca19e67618170410c50ac3a">¶</a></span><p>Fixed issue where <code class="docutils literal notranslate"><span class="pre">dialect_options</span></code> were omitted when a
database object (e.g., <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>) was copied using
<code class="xref py py-func docutils literal notranslate"><span class="pre">tometadata()</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5276">#5276</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.18-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-10"><span class="target" id="change-8e3d798c1f690af21fc5e79c717e42f0"><strong>[mysql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8e3d798c1f690af21fc5e79c717e42f0">¶</a></span><p>Implemented row-level locking support for mysql.  Pull request courtesy
Quentin Somerville.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4860">#4860</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.18-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-11"><span class="target" id="change-3503df8181c9b2756c0061b25838736d"><strong>[sqlite] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3503df8181c9b2756c0061b25838736d">¶</a></span><p>SQLite 3.31 added support for computed column. This change
enables their support in SQLAlchemy when targeting SQLite.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5297">#5297</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-12"><span class="target" id="change-818e6c10d9c7c9fed69637e8ae5d4519"><strong>[sqlite] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-818e6c10d9c7c9fed69637e8ae5d4519">¶</a></span><p>Added “exists” to the list of reserved words for SQLite so that this word
will be quoted when used as a label or column name. Pull request courtesy
Thodoris Sotiropoulos.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5395">#5395</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.18-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-13"><span class="target" id="change-34d49bcefffb555277dc6fc395d29e64"><strong>[mssql] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-34d49bcefffb555277dc6fc395d29e64">¶</a></span><p>Moved the <code class="docutils literal notranslate"><span class="pre">supports_sane_rowcount_returning</span> <span class="pre">=</span> <span class="pre">False</span></code> requirement from
the <code class="docutils literal notranslate"><span class="pre">PyODBCConnector</span></code> level to the <code class="docutils literal notranslate"><span class="pre">MSDialect_pyodbc</span></code> since pyodbc
does work properly in some circumstances.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5321">#5321</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-14"><span class="target" id="change-df48e9fe146d17df3f08d168d3ffc521"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-df48e9fe146d17df3f08d168d3ffc521">¶</a></span><p>Refined the logic used by the SQL Server dialect to interpret multi-part
schema names that contain many dots, to not actually lose any dots if the
name does not have bracking or quoting used, and additionally to support a
“dbname” token that has many parts including that it may have multiple,
independently-bracketed sections.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5364">#5364</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5366">#5366</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-15"><span class="target" id="change-7361be857f64ebfe4e13f1acd050898f"><strong>[mssql] [bug] [pyodbc]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7361be857f64ebfe4e13f1acd050898f">¶</a></span><p>Fixed an issue in the pyodbc connector such that a warning about pyodbc
“drivername” would be emitted when using a totally empty URL.  Empty URLs
are normal when producing a non-connected dialect object or when using the
“creator” argument to create_engine(). The warning now only emits if the
driver name is missing but other parameters are still present.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5346">#5346</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-16"><span class="target" id="change-799058584fa9e5ff395b6bf05267f85b"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-799058584fa9e5ff395b6bf05267f85b">¶</a></span><p>Fixed issue with assembling the ODBC connection string for the pyodbc
DBAPI. Tokens containing semicolons and/or braces “{}” were not being
correctly escaped, causing the ODBC driver to misinterpret the
connection string attributes.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5373">#5373</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-17"><span class="target" id="change-04b79df1911a3ea144792bedf9b13be7"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-04b79df1911a3ea144792bedf9b13be7">¶</a></span><p>Fixed issue where <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> parameters were being converted to
<code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code>, making them incompatible with comparisons like
<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> against an actual <a class="reference internal" href="../dialects/mssql.html#sqlalchemy.dialects.mssql.TIME" title="sqlalchemy.dialects.mssql.TIME"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIME</span></code></a> column.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5339">#5339</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.18-18"><span class="target" id="change-c985e5fa6898f5cf5aba11654234cd7d"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c985e5fa6898f5cf5aba11654234cd7d">¶</a></span><p>Fixed an issue where the <code class="docutils literal notranslate"><span class="pre">is_disconnect</span></code> function in the SQL Server
pyodbc dialect was incorrectly reporting the disconnect state when the
exception messsage had a substring that matched a SQL Server ODBC error
code.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5359">#5359</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.18-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-19"><span class="target" id="change-5621ef0e14d0f95eb6fe568a62d6b65b"><strong>[oracle] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5621ef0e14d0f95eb6fe568a62d6b65b">¶</a></span><p>Fixed bug in Oracle dialect where indexes that contain the full set of
primary key columns would be mistaken as the primary key index itself,
which is omitted, even if there were multiples.  The check has been refined
to compare the name of the primary key constraint against the index name
itself, rather than trying to guess based on the columns present in the
index.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5421">#5421</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.18-misc">
<h3>misc<a class="headerlink" href="#change-1.3.18-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.18-20"><span class="target" id="change-c1300b88334f2e879c6772a436ff4036"><strong>[change] [examples]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c1300b88334f2e879c6772a436ff4036">¶</a></span><p>Added new option <code class="docutils literal notranslate"><span class="pre">--raw</span></code> to the examples.performance suite
which will dump the raw profile test for consumption by any
number of profiling visualizer tools.   Removed the “runsnake”
option as runsnake is very hard to build at this point;</p>
<p></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.17">
<h2 class="release-version">1.3.17<a class="headerlink" href="#change-1.3.17" title="Permalink to this headline">¶</a></h2>
Released: May 13, 2020<section id="change-1.3.17-orm">
<h3>orm<a class="headerlink" href="#change-1.3.17-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-0"><span class="target" id="change-6ab02dea3df87a099bd98f4a60c27a2a"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6ab02dea3df87a099bd98f4a60c27a2a">¶</a></span><p>Added an accessor <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.ColumnProperty.Comparator.expressions" title="sqlalchemy.orm.ColumnProperty.Comparator.expressions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Comparator.expressions</span></code></a> which
provides access to the group of columns mapped under a multi-column
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.ColumnProperty" title="sqlalchemy.orm.ColumnProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnProperty</span></code></a> attribute.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5262">#5262</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-1"><span class="target" id="change-4b7a56c7d66383c7348ce81d287e3005"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4b7a56c7d66383c7348ce81d287e3005">¶</a></span><p>Introduce <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship.params.sync_backref" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">relationship.sync_backref</span></code></a> flag in a relationship
to control if the synchronization events that mutate the in-Python
attributes are added. This supersedes the previous change <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5149">#5149</a>,
which warned that <code class="docutils literal notranslate"><span class="pre">viewonly=True</span></code> relationship target of a
back_populates or backref configuration would be disallowed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5237">#5237</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-2"><span class="target" id="change-200e826f2a7bdc3c562901a1f941b717"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-200e826f2a7bdc3c562901a1f941b717">¶</a></span><p>Fixed bug where using <a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> as the target of a join via
<code class="xref py py-meth docutils literal notranslate"><span class="pre">RelationshipComparator.of_type()</span></code> on a mapper that already has a
subquery-based with_polymorphic setting that’s equivalent to the one
requested would not correctly alias the ON clause in the join.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5288">#5288</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-3"><span class="target" id="change-f4c7272b2e7120bacf9eea57e1810ae8"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f4c7272b2e7120bacf9eea57e1810ae8">¶</a></span><p>Fixed issue in the area of where loader options such as selectinload()
interact with the baked query system, such that the caching of a query is
not supposed to occur if the loader options themselves have elements such
as with_polymorphic() objects in them that currently are not
cache-compatible.  The baked loader could sometimes not fully invalidate
itself in these some of these scenarios leading to missed eager loads.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5303">#5303</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-4"><span class="target" id="change-fe6fd348fea084f3ee83e5525cf4f3c5"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fe6fd348fea084f3ee83e5525cf4f3c5">¶</a></span><p>Modified the internal “identity set” implementation, which is a set that
hashes objects on their id() rather than their hash values, to not actually
call the <code class="docutils literal notranslate"><span class="pre">__hash__()</span></code> method of the objects, which are typically
user-mapped objects.  Some methods were calling this method as a side
effect of the implementation.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5304">#5304</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-5"><span class="target" id="change-624d9cc1b311fc72e0d8aca6f54239b3"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-624d9cc1b311fc72e0d8aca6f54239b3">¶</a></span><p>An informative error message is raised when an ORM many-to-one comparison
is attempted against an object that is not an actual mapped instance.
Comparisons such as those to scalar subqueries aren’t supported;
generalized comparison with subqueries is better achieved using
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.RelationshipProperty.Comparator.has" title="sqlalchemy.orm.RelationshipProperty.Comparator.has"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.has()</span></code></a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5269">#5269</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-engine">
<h3>engine<a class="headerlink" href="#change-1.3.17-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-6"><span class="target" id="change-7a6fdf5e0595f654572e4f8edb32b48c"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7a6fdf5e0595f654572e4f8edb32b48c">¶</a></span><p>Fixed fairly critical issue where the DBAPI connection could be returned to
the connection pool while still in an un-rolled-back state. The reset agent
responsible for rolling back the connection could be corrupted in the case
that the transaction was “closed” without being rolled back or committed,
which can occur in some scenarios when using ORM sessions and emitting
.close() in a certain pattern involving savepoints.   The fix ensures that
the reset agent is always active.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5326">#5326</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-schema">
<h3>schema<a class="headerlink" href="#change-1.3.17-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-7"><span class="target" id="change-984745cb08d2ed8ed2bc08a5f4c09526"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-984745cb08d2ed8ed2bc08a5f4c09526">¶</a></span><p>Fixed issue where an <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a> that is deferred in being associated
with a table, such as as when it contains a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that is not
associated with any <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> yet,  would fail to attach correctly if
it also contained a non table-oriented expression.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5298">#5298</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-8"><span class="target" id="change-5bc5d9f1fe80da24980302c9aa527e36"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5bc5d9f1fe80da24980302c9aa527e36">¶</a></span><p>A warning is emitted when making use of the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData.sorted_tables" title="sqlalchemy.schema.MetaData.sorted_tables"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MetaData.sorted_tables</span></code></a>
attribute as well as the <a class="reference internal" href="../core/ddl.html#sqlalchemy.schema.sort_tables" title="sqlalchemy.schema.sort_tables"><code class="xref py py-func docutils literal notranslate"><span class="pre">sort_tables()</span></code></a> function, and the
given tables cannot be correctly sorted due to a cyclic dependency between
foreign key constraints. In this case, the functions will no longer sort
the involved tables by foreign key, and a warning will be emitted. Other
tables that are not part of the cycle will still be returned in dependency
order. Previously, the sorted_table routines would return a collection that
would unconditionally omit all foreign keys when a cycle was detected, and
no warning was emitted.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5316">#5316</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-9"><span class="target" id="change-b609d2d1ee9904bb6b6132d994a90a4e"><strong>[schema]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b609d2d1ee9904bb6b6132d994a90a4e">¶</a></span><p>Add <code class="docutils literal notranslate"><span class="pre">comment</span></code> attribute to <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> method.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4138">#4138</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.17-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-10"><span class="target" id="change-e57f5913ab592a9c044cad747636edd8"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e57f5913ab592a9c044cad747636edd8">¶</a></span><p>Added support for columns or type <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY" title="sqlalchemy.types.ARRAY"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARRAY</span></code></a> of <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>,
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> or <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB" title="sqlalchemy.dialects.postgresql.JSONB"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSONB</span></code></a> in PostgreSQL.
Previously a workaround was required in these use cases.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5265">#5265</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-11"><span class="target" id="change-7ec8ad542f697afdeca7e88a0be136ab"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7ec8ad542f697afdeca7e88a0be136ab">¶</a></span><p>Raise an explicit <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.CompileError" title="sqlalchemy.exc.CompileError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompileError</span></code></a> when adding a table with a
column of type <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.ARRAY" title="sqlalchemy.types.ARRAY"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARRAY</span></code></a> of <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> configured with
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum.params.native_enum" title="sqlalchemy.types.Enum"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Enum.native_enum</span></code></a> set to <code class="docutils literal notranslate"><span class="pre">False</span></code> when
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum.params.create_constraint" title="sqlalchemy.types.Enum"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Enum.create_constraint</span></code></a> is not set to <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5266">#5266</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.17-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-12"><span class="target" id="change-f4dd4accb16f7c7d83d3fc7209e58a2e"><strong>[mssql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f4dd4accb16f7c7d83d3fc7209e58a2e">¶</a></span><p>Fix a regression introduced by the reflection of computed column in
MSSQL when using the legacy TDS version 4.2. The dialect will try
to detect the protocol version of first connect and run in compatibility
mode if it cannot detect it.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5255">#5255</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-13"><span class="target" id="change-9ef9a30978c8fe33419a4747fa134e32"><strong>[mssql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9ef9a30978c8fe33419a4747fa134e32">¶</a></span><p>Fix a regression introduced by the reflection of computed column in
MSSQL when using SQL server versions before 2012, which does not support
the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5271">#5271</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.17-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-14"><span class="target" id="change-cc5a1743d1951d72594d609e6e1a5c99"><strong>[oracle] [performance] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-cc5a1743d1951d72594d609e6e1a5c99">¶</a></span><p>Changed the implementation of fetching CLOB and BLOB objects to use
cx_Oracle’s native implementation which fetches CLOB/BLOB objects inline
with other result columns, rather than performing a separate fetch. As
always, this can be disabled by setting auto_convert_lobs to False.</p>
<p>As part of this change, the behavior of a CLOB that was given a blank
string on INSERT now returns None on SELECT, which is now consistent with
that of VARCHAR on Oracle.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5314">#5314</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.17-15"><span class="target" id="change-aae71399cbb61c78ebaa99fe5ebbc85f"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-aae71399cbb61c78ebaa99fe5ebbc85f">¶</a></span><p>Some modifications to how the cx_oracle dialect sets up per-column
outputtype handlers for LOB and numeric datatypes to adjust for potential
changes coming in cx_Oracle 8.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5246">#5246</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.17-firebird">
<h3>firebird<a class="headerlink" href="#change-1.3.17-firebird" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.17-16"><span class="target" id="change-3d26d8810b452ce62aee1841b6a4725d"><strong>[firebird] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3d26d8810b452ce62aee1841b6a4725d">¶</a></span><p>Adjusted dialect loading for <code class="docutils literal notranslate"><span class="pre">firebird://</span></code> URIs so the external
sqlalchemy-firebird dialect will be used if it has been installed,
otherwise fall back to the (now deprecated) internal Firebird dialect.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5278">#5278</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.16">
<h2 class="release-version">1.3.16<a class="headerlink" href="#change-1.3.16" title="Permalink to this headline">¶</a></h2>
Released: April 7, 2020<section id="change-1.3.16-orm">
<h3>orm<a class="headerlink" href="#change-1.3.16-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-0"><span class="target" id="change-585a78dc91721222ec2a1fa4787ce49f"><strong>[orm] [performance]</strong> <a class="changelog-reference headerlink reference internal" href="#change-585a78dc91721222ec2a1fa4787ce49f">¶</a></span><p>Modified the queries used by subqueryload and selectinload to no longer
ORDER BY the primary key of the parent entity;  this ordering was there to
allow the rows as they come in to be copied into lists directly with a
minimal level of Python-side collation.   However, these ORDER BY clauses
can negatively impact the performance of the query as in many scenarios
these columns are derived from a subquery or are otherwise not actual
primary key columns such that SQL planners cannot make use of indexes. The
Python-side collation uses the native itertools.group_by() to collate the
incoming rows, and has been modified to allow multiple
row-groups-per-parent to be assembled together using list.extend(), which
should still allow for relatively fast Python-side performance.  There will
still be an ORDER BY present for a relationship that includes an explicit
order_by parameter, however this is the only ORDER BY that will be added to
the query for both kinds of loading.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5162">#5162</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.16-1"><span class="target" id="change-5a83e943d41fc39e6b008c0dd9c4f8d0"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5a83e943d41fc39e6b008c0dd9c4f8d0">¶</a></span><p>Fixed bug in <a class="reference internal" href="../orm/loading_relationships.html#sqlalchemy.orm.selectinload" title="sqlalchemy.orm.selectinload"><code class="xref py py-func docutils literal notranslate"><span class="pre">selectinload()</span></code></a> loading option where two or more
loaders that represent different relationships with the same string key
name as referenced from a single <a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> construct
with multiple subclass mappers would fail to invoke each subqueryload
separately, instead making use of a single string-based slot that would
prevent the other loaders from being invoked.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5228">#5228</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.16-2"><span class="target" id="change-d83a2419f32f718a8b7e2cebbe1b4810"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d83a2419f32f718a8b7e2cebbe1b4810">¶</a></span><p>Fixed issue where a lazyload that uses session-local “get” against a target
many-to-one relationship where an object with the correct primary key is
present, however it’s an instance of a sibling class, does not correctly
return None as is the case when the lazy loader actually emits a load for
that row.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5210">#5210</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-orm-declarative">
<h3>orm declarative<a class="headerlink" href="#change-1.3.16-orm-declarative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-3"><span class="target" id="change-d0fa61cea8b2e8b959b3f654b76c4614"><strong>[orm] [declarative] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d0fa61cea8b2e8b959b3f654b76c4614">¶</a></span><p>The string argument accepted as the first positional argument by the
<a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a> function when using the Declarative API is no longer
interpreted using the Python <code class="docutils literal notranslate"><span class="pre">eval()</span></code> function; instead, the name is dot
separated and the names are looked up directly in the name resolution
dictionary without treating the value as a Python expression.  However,
passing a string argument to the other <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a> parameters
that necessarily must accept Python expressions will still use <code class="docutils literal notranslate"><span class="pre">eval()</span></code>;
the documentation has been clarified to ensure that there is no ambiguity
that this is in use.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../orm/extensions/declarative/relationships.html#declarative-relationship-eval"><span class="std std-ref">Evaluation of relationship arguments</span></a> - details on string evaluation</p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5238">#5238</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-sql">
<h3>sql<a class="headerlink" href="#change-1.3.16-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-4"><span class="target" id="change-d388c44ba6f010e81ba29941ce191863"><strong>[sql] [types]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d388c44ba6f010e81ba29941ce191863">¶</a></span><p>Add ability to literal compile a <code class="xref py py-class docutils literal notranslate"><span class="pre">DateTime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Date</span></code>
or <code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code> when using the string dialect for debugging purposes.
This change does not impact real dialect implementation that retain
their current behavior.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5052">#5052</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-schema">
<h3>schema<a class="headerlink" href="#change-1.3.16-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-5"><span class="target" id="change-242583675b2755b6cc1ad141553980a6"><strong>[schema] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-242583675b2755b6cc1ad141553980a6">¶</a></span><p>Added support for reflection of “computed” columns, which are now returned
as part of the structure returned by <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_columns" title="sqlalchemy.engine.reflection.Inspector.get_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Inspector.get_columns()</span></code></a>.
When reflecting full <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects, computed columns will
be represented using the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Computed" title="sqlalchemy.schema.Computed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Computed</span></code></a> construct.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5063">#5063</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.16-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-6"><span class="target" id="change-81762964eb8b303caf12fc5ded764875"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-81762964eb8b303caf12fc5ded764875">¶</a></span><p>Fixed issue where a “covering” index, e.g. those which have an  INCLUDE
clause, would be reflected including all the columns in INCLUDE clause as
regular columns.  A warning is now emitted if these additional columns are
detected indicating that they are currently ignored.  Note that full
support for “covering” indexes is part of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4458">#4458</a>.  Pull request
courtesy Marat Sharafutdinov.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5205">#5205</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.16-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-7"><span class="target" id="change-5fa71404304690c2a1d11eefe8aeca69"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5fa71404304690c2a1d11eefe8aeca69">¶</a></span><p>Fixed issue in MySQL dialect when connecting to a pseudo-MySQL database
such as that provided by ProxySQL, the up front check for isolation level
when it returns no row will not prevent the dialect from continuing to
connect. A warning is emitted that the isolation level could not be
detected.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5239">#5239</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.16-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-8"><span class="target" id="change-4786673f9a875e26cf92b01ec92c4975"><strong>[sqlite] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4786673f9a875e26cf92b01ec92c4975">¶</a></span><p>Implemented AUTOCOMMIT isolation level for SQLite when using pysqlite.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5164">#5164</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.16-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-9"><span class="target" id="change-d7ba0a82147807804b608eb438d56708"><strong>[mssql] [usecase] [mysql] [oracle]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d7ba0a82147807804b608eb438d56708">¶</a></span><p>Added support for <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.is_distinct_from" title="sqlalchemy.sql.expression.ColumnOperators.is_distinct_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.is_distinct_from()</span></code></a> and
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.isnot_distinct_from" title="sqlalchemy.sql.expression.ColumnOperators.isnot_distinct_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.isnot_distinct_from()</span></code></a> to SQL Server,
MySQL, and Oracle.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5137">#5137</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.16-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-10"><span class="target" id="change-6db518640d15a6f6ab56e5a44a5039a3"><strong>[oracle] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6db518640d15a6f6ab56e5a44a5039a3">¶</a></span><p>Implemented AUTOCOMMIT isolation level for Oracle when using cx_Oracle.
Also added a fixed default isolation level of READ COMMITTED for Oracle.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5200">#5200</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.16-11"><span class="target" id="change-b52951a746bc749b90cb06852678e6a1"><strong>[oracle] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b52951a746bc749b90cb06852678e6a1">¶</a></span><p>Fixed regression / incorrect fix caused by fix for <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5146">#5146</a> where the
Oracle dialect reads from the “all_tab_comments” view to get table comments
but fails to accommodate for the current owner of the table being
requested, causing it to read the wrong comment if multiple tables of the
same name exist in multiple schemas.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5146">#5146</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.16-misc">
<h3>misc<a class="headerlink" href="#change-1.3.16-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.16-12"><span class="target" id="change-63cbc9a81d4ad9896db98d3483c33a96"><strong>[bug] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-63cbc9a81d4ad9896db98d3483c33a96">¶</a></span><p>Fixed an issue that prevented the test suite from running with the
recently released py.test 5.4.0.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5201">#5201</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.16-13"><span class="target" id="change-699d8119ab2063ed26f74748143ddb3f"><strong>[enum] [types]</strong> <a class="changelog-reference headerlink reference internal" href="#change-699d8119ab2063ed26f74748143ddb3f">¶</a></span><p>The <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> type now supports the parameter <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum.params.length" title="sqlalchemy.types.Enum"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Enum.length</span></code></a>
to specify the length of the VARCHAR column to create when using
non native enums by setting <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum.params.native_enum" title="sqlalchemy.types.Enum"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Enum.native_enum</span></code></a> to <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5183">#5183</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.16-14"><span class="target" id="change-164e868e26f8d1d745307ecd2906117b"><strong>[installer]</strong> <a class="changelog-reference headerlink reference internal" href="#change-164e868e26f8d1d745307ecd2906117b">¶</a></span><p>Ensured that the “pyproject.toml” file is not included in builds, as the
presence of this file indicates to pip that a pep-517 installation process
should be used.  As this mode of operation appears to be not well supported
by current tools / distros, these problems are avoided within the scope
of SQLAlchemy installation by omitting the file.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5207">#5207</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.15">
<h2 class="release-version">1.3.15<a class="headerlink" href="#change-1.3.15" title="Permalink to this headline">¶</a></h2>
Released: March 11, 2020<section id="change-1.3.15-orm">
<h3>orm<a class="headerlink" href="#change-1.3.15-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.15-0"><span class="target" id="change-b2bcea69864625e7164628b398498904"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b2bcea69864625e7164628b398498904">¶</a></span><p>Adjusted the error message emitted by <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> when a left hand
side can’t be located that the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.select_from" title="sqlalchemy.orm.Query.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a> method is the
best way to resolve the issue.  Also, within the 1.3 series, used a
deterministic ordering when determining the FROM clause from a given column
entity passed to <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> so that the same expression is determined
each time.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5194">#5194</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.15-1"><span class="target" id="change-8c2c97d1b8fd3f099ea77ce927918cb9"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8c2c97d1b8fd3f099ea77ce927918cb9">¶</a></span><p>Fixed regression in 1.3.14 due to <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4849">#4849</a> where a sys.exc_info()
call failed to be invoked correctly when a flush error would occur. Test
coverage has been added for this exception case.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5196">#5196</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.14">
<h2 class="release-version">1.3.14<a class="headerlink" href="#change-1.3.14" title="Permalink to this headline">¶</a></h2>
Released: March 10, 2020<section id="change-1.3.14-general">
<h3>general<a class="headerlink" href="#change-1.3.14-general" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-0"><span class="target" id="change-810760a73ed03bcdf04152df044eb671"><strong>[general] [bug] [py3k]</strong> <a class="changelog-reference headerlink reference internal" href="#change-810760a73ed03bcdf04152df044eb671">¶</a></span><p>Applied an explicit “cause” to most if not all internally raised exceptions
that are raised from within an internal exception catch, to avoid
misleading stacktraces that suggest an error within the handling of an
exception.  While it would be preferable to suppress the internally caught
exception in the way that the <code class="docutils literal notranslate"><span class="pre">__suppress_context__</span></code> attribute would,
there does not as yet seem to be a way to do this without suppressing an
enclosing user constructed context, so for now it exposes the internally
caught exception as the cause so that full information about the context
of the error is maintained.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4849">#4849</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-orm">
<h3>orm<a class="headerlink" href="#change-1.3.14-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-1"><span class="target" id="change-ef15bb28df62f64419afb8bdaeb7c4df"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ef15bb28df62f64419afb8bdaeb7c4df">¶</a></span><p>Added a new flag <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.InstanceEvents.params.restore_load_context" title="sqlalchemy.orm.InstanceEvents"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">InstanceEvents.restore_load_context</span></code></a> and
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.SessionEvents.params.restore_load_context" title="sqlalchemy.orm.SessionEvents"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">SessionEvents.restore_load_context</span></code></a> which apply to the
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.InstanceEvents.load" title="sqlalchemy.orm.InstanceEvents.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InstanceEvents.load()</span></code></a>, <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.InstanceEvents.refresh" title="sqlalchemy.orm.InstanceEvents.refresh"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InstanceEvents.refresh()</span></code></a>, and
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.SessionEvents.loaded_as_persistent" title="sqlalchemy.orm.SessionEvents.loaded_as_persistent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SessionEvents.loaded_as_persistent()</span></code></a> events, which when set will
restore the “load context” of the object after the event hook has been
called.  This ensures that the object remains within the “loader context”
of the load operation that is already ongoing, rather than the object being
transferred to a new load context due to refresh operations which may have
occurred in the event. A warning is now emitted when this condition occurs,
which recommends use of the flag to resolve this case.  The flag is
“opt-in” so that there is no risk introduced to existing applications.</p>
<p>The change additionally adds support for the <code class="docutils literal notranslate"><span class="pre">raw=True</span></code> flag to
session lifecycle events.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5129">#5129</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-2"><span class="target" id="change-5dee442abbe2118c28f4260c163ee54c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5dee442abbe2118c28f4260c163ee54c">¶</a></span><p>Fixed regression caused in 1.3.13 by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5056">#5056</a> where a refactor of the
ORM path registry system made it such that a path could no longer be
compared to an empty tuple, which can occur in a particular kind of joined
eager loading path.   The “empty tuple” use case has been resolved so that
the path registry is compared to a path registry in all cases;  the
<code class="xref py py-class docutils literal notranslate"><span class="pre">PathRegistry</span></code> object itself now implements <code class="docutils literal notranslate"><span class="pre">__eq__()</span></code> and
<code class="docutils literal notranslate"><span class="pre">__ne__()</span></code> methods which will take place for all equality comparisons and
continue to succeed in the not anticipated case that a non-
<code class="xref py py-class docutils literal notranslate"><span class="pre">PathRegistry</span></code> object is compared, while emitting a warning that
this object should not be the subject of the comparison.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5110">#5110</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-3"><span class="target" id="change-7fb56b0269d9a13d31cc33857913a961"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7fb56b0269d9a13d31cc33857913a961">¶</a></span><p>Setting a relationship to viewonly=True which is also the target of a
back_populates or backref configuration will now emit a warning and
eventually be disallowed. back_populates refers specifically to mutation
of an attribute or collection, which is disallowed when the attribute is
subject to viewonly=True.   The viewonly attribute is not subject to
persistence behaviors which means it will not reflect correct results
when it is locally mutated.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5149">#5149</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-4"><span class="target" id="change-19717b562159d1614e9b2b03d674fe65"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-19717b562159d1614e9b2b03d674fe65">¶</a></span><p>Fixed an additional regression in the same area as that of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5080">#5080</a>
introduced in 1.3.0b3 via <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4468">#4468</a> where the ability to create a
joined option across a <a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> into a relationship
against the base class of that with_polymorphic, and then further into
regular mapped relationships would fail as the base class component would
not add itself to the load path in a way that could be located by the
loader strategy. The changes applied in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5080">#5080</a> have been further
refined to also accommodate this scenario.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5121">#5121</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-engine">
<h3>engine<a class="headerlink" href="#change-1.3.14-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-5"><span class="target" id="change-e42a8355a1a11422a2e16c54fad9cf44"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e42a8355a1a11422a2e16c54fad9cf44">¶</a></span><p>Expanded the scope of cursor/connection cleanup when a statement is
executed to include when the result object fails to be constructed, or an
after_cursor_execute() event raises an error, or autocommit / autoclose
fails.  This allows the DBAPI cursor to be cleaned up on failure and for
connectionless execution allows the connection to be closed out and
returned to the connection pool, where previously it waiting until garbage
collection would trigger a pool return.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5182">#5182</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-sql">
<h3>sql<a class="headerlink" href="#change-1.3.14-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-6"><span class="target" id="change-da64b83d6cd53b30792ae4f26de0f3ba"><strong>[sql] [bug] [postgresql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-da64b83d6cd53b30792ae4f26de0f3ba">¶</a></span><p>Fixed bug where a CTE of an INSERT/UPDATE/DELETE that also uses RETURNING
could then not be SELECTed from directly, as the internal state of the
compiler would try to treat the outer SELECT as a DELETE statement itself
and access nonexistent state.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5181">#5181</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.14-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-7"><span class="target" id="change-fcd2c9754521fb023c2bd3d92bdb63ba"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fcd2c9754521fb023c2bd3d92bdb63ba">¶</a></span><p>Fixed issue where the “schema_translate_map” feature would not work with a
PostgreSQL native enumeration type (i.e. <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>,
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ENUM" title="sqlalchemy.dialects.postgresql.ENUM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ENUM</span></code></a>) in that while the “CREATE TYPE” statement would
be emitted with the correct schema, the schema would not be rendered in
the CREATE TABLE statement at the point at which the enumeration was
referenced.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5158">#5158</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-8"><span class="target" id="change-f28d063fe9a6f0c6c1d9ec9bdc0a6f1e"><strong>[postgresql] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f28d063fe9a6f0c6c1d9ec9bdc0a6f1e">¶</a></span><p>Fixed bug where PostgreSQL reflection of CHECK constraints would fail to
parse the constraint if the SQL text contained newline characters. The
regular expression has been adjusted to accommodate for this case. Pull
request courtesy Eric Borczuk.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5170">#5170</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.14-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-9"><span class="target" id="change-7cc6d5c18488c10b3564df11817e8eaa"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7cc6d5c18488c10b3564df11817e8eaa">¶</a></span><p>Fixed issue in MySQL <a class="reference internal" href="../dialects/mysql.html#sqlalchemy.dialects.mysql.Insert.on_duplicate_key_update" title="sqlalchemy.dialects.mysql.Insert.on_duplicate_key_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Insert.on_duplicate_key_update()</span></code></a> construct
where using a SQL function or other composed expression for a column argument
would not properly render the <code class="docutils literal notranslate"><span class="pre">VALUES</span></code> keyword surrounding the column
itself.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5173">#5173</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.14-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-10"><span class="target" id="change-5e101129ab3ca9f649a1f5252e7eda8d"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5e101129ab3ca9f649a1f5252e7eda8d">¶</a></span><p>Fixed issue where the <a class="reference internal" href="../dialects/mssql.html#sqlalchemy.dialects.mssql.DATETIMEOFFSET" title="sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="xref py py-class docutils literal notranslate"><span class="pre">DATETIMEOFFSET</span></code></a> type would not
accommodate for the <code class="docutils literal notranslate"><span class="pre">None</span></code> value, introduced as part of the series of
fixes for this type first introduced in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4983">#4983</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5045">#5045</a>.
Additionally, added support for passing a backend-specific date formatted
string through this type, as is typically allowed for date/time types on
most other DBAPIs.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5132">#5132</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.14-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-11"><span class="target" id="change-7162fc03c77963ac813c3edb8d9b75da"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7162fc03c77963ac813c3edb8d9b75da">¶</a></span><p>Fixed a reflection bug where table comments could only be retrieved for
tables actually owned by the user but not for tables visible to the user
but owned by someone else.  Pull request courtesy Dave Hirschfeld.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5146">#5146</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.14-misc">
<h3>misc<a class="headerlink" href="#change-1.3.14-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.14-12"><span class="target" id="change-f50027dab71171da288167ea6ede7548"><strong>[usecase] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f50027dab71171da288167ea6ede7548">¶</a></span><p>Added keyword arguments to the <a class="reference internal" href="../orm/extensions/mutable.html#sqlalchemy.ext.mutable.MutableList.sort" title="sqlalchemy.ext.mutable.MutableList.sort"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MutableList.sort()</span></code></a> function so that a
key function as well as the “reverse” keyword argument can be provided.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5114">#5114</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-13"><span class="target" id="change-4aee123e6060a97e0c5cd34e2d4f5ffa"><strong>[performance] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4aee123e6060a97e0c5cd34e2d4f5ffa">¶</a></span><p>Revised an internal change to the test system added as a result of
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5085">#5085</a> where a testing-related module per dialect would be loaded
unconditionally upon making use of that dialect, pulling in SQLAlchemy’s
testing framework as well as the ORM into the module import space.   This
would only impact initial startup time and memory to a modest extent,
however it’s best that these additional modules aren’t reverse-dependent on
straight Core usage.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5180">#5180</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.14-14"><span class="target" id="change-429ab7be36c07f74abf921d69fdacfa6"><strong>[bug] [installation]</strong> <a class="changelog-reference headerlink reference internal" href="#change-429ab7be36c07f74abf921d69fdacfa6">¶</a></span><p>Vendored the <code class="docutils literal notranslate"><span class="pre">inspect.formatannotation</span></code> function inside of
<code class="docutils literal notranslate"><span class="pre">sqlalchemy.util.compat</span></code>, which is needed for the vendored version of
<code class="docutils literal notranslate"><span class="pre">inspect.formatargspec</span></code>.  The function is not documented in cPython and
is not guaranteed to be available in future Python versions.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5138">#5138</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.13">
<h2 class="release-version">1.3.13<a class="headerlink" href="#change-1.3.13" title="Permalink to this headline">¶</a></h2>
Released: January 22, 2020<section id="change-1.3.13-orm">
<h3>orm<a class="headerlink" href="#change-1.3.13-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-0"><span class="target" id="change-495fda32b48b0a36fb370e65ab7e7b02"><strong>[orm] [performance]</strong> <a class="changelog-reference headerlink reference internal" href="#change-495fda32b48b0a36fb370e65ab7e7b02">¶</a></span><p>Identified a performance issue in the system by which a join is constructed
based on a mapped relationship.   The clause adaption system would be used
for the majority of join expressions including in the common case where no
adaptation is needed.   The conditions under which this adaptation occur
have been refined so that average non-aliased joins along a simple
relationship without a “secondary” table use about 70% less function calls.</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-1"><span class="target" id="change-873a12fc296bce0ff5be0f156f21d01a"><strong>[orm] [bug] [engine]</strong> <a class="changelog-reference headerlink reference internal" href="#change-873a12fc296bce0ff5be0f156f21d01a">¶</a></span><p>Added test support and repaired a wide variety of unnecessary reference
cycles created for short-lived objects, mostly in the area of ORM queries.
Thanks much to Carson Ip for the help on this.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5050">#5050</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5056">#5056</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5071">#5071</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-2"><span class="target" id="change-39fb88643a331c1a4491cc730f7bebe3"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-39fb88643a331c1a4491cc730f7bebe3">¶</a></span><p>Fixed regression in loader options introduced in 1.3.0b3 via <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4468">#4468</a>
where the ability to create a loader option using
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.PropComparator.of_type" title="sqlalchemy.orm.PropComparator.of_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PropComparator.of_type()</span></code></a> targeting an aliased entity that is an
inheriting subclass of the entity which the preceding relationship refers
to would fail to produce a matching path.   See also <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5082">#5082</a> fixed
in this same release which involves a similar kind of issue.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5107">#5107</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-3"><span class="target" id="change-132bd6f66ec9a1042e7084a3887191df"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-132bd6f66ec9a1042e7084a3887191df">¶</a></span><p>Fixed regression in joined eager loading introduced in 1.3.0b3 via
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4468">#4468</a> where the ability to create a joined option across a
<a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> into a polymorphic subclass using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">RelationshipProperty.of_type()</span></code> and then further along regular mapped
relationships would fail as the polymorphic subclass would not add itself
to the load path in a way that could be located by the loader strategy.  A
tweak has been made to resolve this scenario.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5082">#5082</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-4"><span class="target" id="change-d91b8acf2d5819d001917dca7baa8efa"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d91b8acf2d5819d001917dca7baa8efa">¶</a></span><p>Repaired a warning in the ORM flush process that was not covered by  test
coverage when deleting objects that use the “version_id” feature. This
warning is generally unreachable unless using a dialect that sets the
“supports_sane_rowcount” flag to False, which  is not typically the case
however is possible for some MySQL configurations as well as older Firebird
drivers, and likely some third party dialects.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5068">#5068</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-5"><span class="target" id="change-09e67fe943fc7b6fbfa77cb7100f78e8"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-09e67fe943fc7b6fbfa77cb7100f78e8">¶</a></span><p>Fixed bug where usage of joined eager loading would not properly wrap the
query inside of a subquery when <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.group_by" title="sqlalchemy.orm.Query.group_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.group_by()</span></code></a> were used against
the query.   When any kind of result-limiting approach is used, such as
DISTINCT, LIMIT, OFFSET, joined eager loading embeds the row-limited query
inside of a subquery so that the collection results are not impacted.   For
some reason, the presence of GROUP BY was never included in this criterion,
even though it has a similar effect as using DISTINCT.   Additionally, the
bug would prevent using GROUP BY at all for a joined eager load query for
most database platforms which forbid non-aggregated, non-grouped columns
from being in the query, as the additional columns for the joined eager
load would not be accepted by the database.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5065">#5065</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.13-engine">
<h3>engine<a class="headerlink" href="#change-1.3.13-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-6"><span class="target" id="change-9a9b7b93b9b5fe3036f9f2b429bba0b1"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9a9b7b93b9b5fe3036f9f2b429bba0b1">¶</a></span><p>Fixed issue where the collection of value processors on a
<a class="reference internal" href="../core/internals.html#sqlalchemy.engine.Compiled" title="sqlalchemy.engine.Compiled"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compiled</span></code></a> object would be mutated when “expanding IN” parameters
were used with a datatype that has bind value processors; in particular,
this would mean that when using statement caching and/or baked queries, the
same compiled._bind_processors collection would be mutated concurrently.
Since these processors are the same function for a given bind parameter
namespace every time, there was no actual negative effect of this issue,
however, the execution of a <a class="reference internal" href="../core/internals.html#sqlalchemy.engine.Compiled" title="sqlalchemy.engine.Compiled"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compiled</span></code></a> object should never be
causing any changes in its state, especially given that they are intended
to be thread-safe and reusable once fully constructed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5048">#5048</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.13-sql">
<h3>sql<a class="headerlink" href="#change-1.3.13-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-7"><span class="target" id="change-9c2aa1d19555834030482e89168ce3be"><strong>[sql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9c2aa1d19555834030482e89168ce3be">¶</a></span><p>A function created using <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a> can now specify that the
name of the function should be rendered with or without quotes by assigning
the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a> construct to the .name element of the object.
Prior to 1.3.4, quoting was never applied to function names, and some
quoting was introduced in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4467">#4467</a> but no means to force quoting for
a mixed case name was available.  Additionally, the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a>
construct when used as the name will properly register its lowercase name
in the function registry so that the name continues to be available via the
<code class="docutils literal notranslate"><span class="pre">func.</span></code> registry.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5079">#5079</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.13-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.13-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-8"><span class="target" id="change-f4f55f376fbbb821310d79d809fcda3c"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f4f55f376fbbb821310d79d809fcda3c">¶</a></span><p>Added support for prefixes to the <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.CTE" title="sqlalchemy.sql.expression.CTE"><code class="xref py py-class docutils literal notranslate"><span class="pre">CTE</span></code></a> construct, to allow
support for Postgresql 12 “MATERIALIZED” and “NOT MATERIALIZED” phrases.
Pull request courtesy Marat Sharafutdinov.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.HasCTE.cte" title="sqlalchemy.sql.expression.HasCTE.cte"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasCTE.cte()</span></code></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5040">#5040</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-9"><span class="target" id="change-1cca47bcc09d93d59eecccf415aafa8e"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1cca47bcc09d93d59eecccf415aafa8e">¶</a></span><p>Fixed issue where the PostgreSQL dialect would fail to parse a reflected
CHECK constraint that was a boolean-valued function (as opposed to a
boolean-valued expression).</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5039">#5039</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-10"><span class="target" id="change-8a8c8062dc9e7a19bef7d69e9340dd20"><strong>[postgresql] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8a8c8062dc9e7a19bef7d69e9340dd20">¶</a></span><p>Improved detection of two phase transactions requirement for the PostgreSQL
database by testing that max_prepared_transactions is set to a value
greater than 0.  Pull request courtesy Federico Caselli.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5057">#5057</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.13-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.13-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-11"><span class="target" id="change-f066bb419f6a53c36675f3f077e37b7a"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f066bb419f6a53c36675f3f077e37b7a">¶</a></span><p>Fixed issue where a timezone-aware <code class="docutils literal notranslate"><span class="pre">datetime</span></code> value being converted to
string for use as a parameter value of a <a class="reference internal" href="../dialects/mssql.html#sqlalchemy.dialects.mssql.DATETIMEOFFSET" title="sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="xref py py-class docutils literal notranslate"><span class="pre">DATETIMEOFFSET</span></code></a>
column was omitting the fractional seconds.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5045">#5045</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.13-misc">
<h3>misc<a class="headerlink" href="#change-1.3.13-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.13-12"><span class="target" id="change-29c1d4af5ca040928cb0b7912e5460fa"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-29c1d4af5ca040928cb0b7912e5460fa">¶</a></span><p>Fixed bug in sqlalchemy.ext.serializer where a unique
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BindParameter</span></code></a> object could conflict with itself if it were
present in the mapping itself, as well as the filter condition of the
query, as one side would be used against the non-deserialized version and
the other side would use the deserialized version.  Logic is added to
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BindParameter</span></code></a> similar to its “clone” method which will uniquify
the parameter name upon deserialize so that it doesn’t conflict with its
original.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5086">#5086</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.13-13"><span class="target" id="change-3b8919b0f48596990d12ac25ce50a702"><strong>[bug] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3b8919b0f48596990d12ac25ce50a702">¶</a></span><p>Fixed a few test failures which would occur on Windows due to SQLite file
locking issues, as well as some timing issues in connection pool related
tests; pull request courtesy Federico Caselli.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4946">#4946</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.12">
<h2 class="release-version">1.3.12<a class="headerlink" href="#change-1.3.12" title="Permalink to this headline">¶</a></h2>
Released: December 16, 2019<section id="change-1.3.12-orm">
<h3>orm<a class="headerlink" href="#change-1.3.12-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.12-0"><span class="target" id="change-fb6b92e7c08d87769b235882e87cbeb5"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fb6b92e7c08d87769b235882e87cbeb5">¶</a></span><p>Fixed issue involving <code class="docutils literal notranslate"><span class="pre">lazy=&quot;raise&quot;</span></code> strategy where an ORM delete of an
object would raise for a simple “use-get” style many-to-one relationship
that had lazy=”raise” configured.  This is inconsistent vs. the change
introduced in 1.3 as part of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4353">#4353</a>, where it was established that
a history operation that does not expect emit SQL should bypass the
<code class="docutils literal notranslate"><span class="pre">lazy=&quot;raise&quot;</span></code> check, and instead effectively treat it as
<code class="docutils literal notranslate"><span class="pre">lazy=&quot;raise_on_sql&quot;</span></code> for this case.  The fix adjusts the lazy loader
strategy to not raise for the case where the lazy load was instructed that
it should not emit SQL if the object were not present.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4997">#4997</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.12-1"><span class="target" id="change-17b3b398c292792e5b40c211c98d2aba"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-17b3b398c292792e5b40c211c98d2aba">¶</a></span><p>Fixed regression introduced in 1.3.0 related to the association proxy
refactor in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4351">#4351</a> that prevented <a class="reference internal" href="../orm/composites.html#sqlalchemy.orm.composite" title="sqlalchemy.orm.composite"><code class="xref py py-func docutils literal notranslate"><span class="pre">composite()</span></code></a> attributes
from working in terms of an association proxy that references them.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5000">#5000</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.12-2"><span class="target" id="change-9c6b7375fb93cb4130f5fcd11816c6d4"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9c6b7375fb93cb4130f5fcd11816c6d4">¶</a></span><p>Setting persistence-related flags on <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a> while also
setting viewonly=True will now emit a regular warning, as these flags do
not make sense for a viewonly=True relationship.   In particular, the
“cascade” settings have their own warning that is generated based on the
individual values, such as “delete, delete-orphan”, that should not apply
to a viewonly relationship.   Note however that in the case of “cascade”,
these settings are still erroneously taking effect even though the
relationship is set up as “viewonly”.   In 1.4, all persistence-related
cascade settings will be disallowed on a viewonly=True relationship in
order to resolve this issue.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4993">#4993</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.12-3"><span class="target" id="change-81c56f8d468bbfdbfb143bb314d8648b"><strong>[orm] [bug] [py3k]</strong> <a class="changelog-reference headerlink reference internal" href="#change-81c56f8d468bbfdbfb143bb314d8648b">¶</a></span><p>Fixed issue where when assigning a collection to itself as a slice, the
mutation operation would fail as it would first erase the assigned
collection inadvertently.   As an assignment that does not change  the
contents should not generate events, the operation is now a no-op. Note
that the fix only applies to Python 3; in Python 2, the <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code>
hook isn’t called in this case; <code class="docutils literal notranslate"><span class="pre">__setslice__</span></code> is used instead which
recreates the list item-by-item in all cases.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4990">#4990</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.12-4"><span class="target" id="change-f5db6d18221987f051e992ab569ca227"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f5db6d18221987f051e992ab569ca227">¶</a></span><p>Fixed issue where by if the “begin” of a transaction failed at the Core
engine/connection level, such as due to network error or database is locked
for some transactional recipes, within the context of the <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>
procuring that connection from the connection pool and then immediately
returning it, the ORM <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> would not close the connection
despite this connection not being stored within the state of that
<a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.  This would lead to the connection being cleaned out by
the connection pool weakref handler within garbage collection which is an
unpreferred codepath that in some special configurations can emit errors in
standard error.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5034">#5034</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.12-sql">
<h3>sql<a class="headerlink" href="#change-1.3.12-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.12-5"><span class="target" id="change-9ecb65d2843094afa1d2c57158ca6d72"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9ecb65d2843094afa1d2c57158ca6d72">¶</a></span><p>Fixed bug where “distinct” keyword passed to <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> would not
treat a string value as a “label reference” in the same way that the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">select.distinct()</span></code> does; it would instead raise unconditionally. This
keyword argument and the others passed to <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> will ultimately
be deprecated for SQLAlchemy 2.0.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5028">#5028</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.12-6"><span class="target" id="change-34d26d9a3d7c194df90bd1428cf4d7a2"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-34d26d9a3d7c194df90bd1428cf4d7a2">¶</a></span><p>Changed the text of the exception for “Can’t resolve label reference” to
include other kinds of label coercions, namely that “DISTINCT” is also in
this category under the PostgreSQL dialect.</p>
<p></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.12-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.12-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.12-7"><span class="target" id="change-26b0f07523eecc35a32c20b1029f2fdc"><strong>[sqlite] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-26b0f07523eecc35a32c20b1029f2fdc">¶</a></span><p>Fixed issue to workaround SQLite’s behavior of assigning “numeric” affinity
to JSON datatypes, first described at <a class="reference internal" href="migration_13.html#change-3850"><span class="std std-ref">Support for SQLite JSON Added</span></a>, which returns
scalar numeric JSON values as a number and not as a string that can be JSON
deserialized.  The SQLite-specific JSON deserializer now gracefully
degrades for this case as an exception and bypasses deserialization for
single numeric values, as from a JSON perspective they are already
deserialized.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/5014">#5014</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.12-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.12-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.12-8"><span class="target" id="change-adcef5c40eeb79c17abce544460e9ec4"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-adcef5c40eeb79c17abce544460e9ec4">¶</a></span><p>Repaired support for the <a class="reference internal" href="../dialects/mssql.html#sqlalchemy.dialects.mssql.DATETIMEOFFSET" title="sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="xref py py-class docutils literal notranslate"><span class="pre">DATETIMEOFFSET</span></code></a> datatype on PyODBC,
by adding PyODBC-level result handlers as it does not include native
support for this datatype.  This includes usage of the Python 3 “timezone”
tzinfo subclass in order to set up a timezone, which on Python 2 makes
use of a minimal backport of “timezone” in sqlalchemy.util.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4983">#4983</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.11">
<h2 class="release-version">1.3.11<a class="headerlink" href="#change-1.3.11" title="Permalink to this headline">¶</a></h2>
Released: November 11, 2019<section id="change-1.3.11-orm">
<h3>orm<a class="headerlink" href="#change-1.3.11-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-0"><span class="target" id="change-fb7f12025e91b3d9b9b505de5f8de86f"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fb7f12025e91b3d9b9b505de5f8de86f">¶</a></span><p>Added accessor <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.is_single_entity" title="sqlalchemy.orm.Query.is_single_entity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.is_single_entity()</span></code></a> to <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, which
will indicate if the results returned by this <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> will be a
list of ORM entities, or a tuple of entities or column expressions.
SQLAlchemy hopes to improve upon the behavior of single entity / tuples in
future releases such that the behavior would be explicit up front, however
this attribute should be helpful with the current behavior.  Pull request
courtesy Patrick Hayes.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4934">#4934</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-1"><span class="target" id="change-49d980c2052c6effb29aaaf65bb78fc5"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-49d980c2052c6effb29aaaf65bb78fc5">¶</a></span><p>The <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship.params.omit_join" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">relationship.omit_join</span></code></a> flag was not intended to be
manually set to True, and will now emit a warning when this occurs.  The
omit_join optimization is detected automatically, and the <code class="docutils literal notranslate"><span class="pre">omit_join</span></code>
flag was only intended to disable the optimization in the hypothetical case
that the optimization may have interfered with correct results, which has
not been observed with the modern version of this feature.   Setting the
flag to True when it is not automatically detected may cause the selectin
load feature to not work correctly when a non-default primary join
condition is in use.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4954">#4954</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-2"><span class="target" id="change-87e222b5abc26d90e74cca60e2c8208b"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-87e222b5abc26d90e74cca60e2c8208b">¶</a></span><p>A warning is emitted if a primary key value is passed to <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a>
that consists of None for all primary key column positions.   Previously,
passing a single None outside of a tuple would raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> and
passing a composite None (tuple of None values) would silently pass
through.   The fix now coerces the single None into a tuple where it is
handled consistently with the other None conditions.  Thanks to Lev
Izraelit for the help with this.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4915">#4915</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-3"><span class="target" id="change-4a800d9eb69f6aebde2bc3a89afaef42"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4a800d9eb69f6aebde2bc3a89afaef42">¶</a></span><p>The <a class="reference internal" href="../orm/extensions/baked.html#sqlalchemy.ext.baked.BakedQuery" title="sqlalchemy.ext.baked.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a> will not cache a query that was modified by a
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.QueryEvents.before_compile" title="sqlalchemy.orm.QueryEvents.before_compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QueryEvents.before_compile()</span></code></a> event, so that compilation hooks that
may be applying ad-hoc modifications to queries will take effect on each
run.  In particular this is helpful for events that modify queries used in
lazy loading as well as eager loading such as “select in” loading.  In
order to re-enable caching for a query modified by this event, a new
flag <code class="docutils literal notranslate"><span class="pre">bake_ok</span></code> is added; see <a class="reference internal" href="../orm/extensions/baked.html#baked-with-before-compile"><span class="std std-ref">Using the before_compile event</span></a> for
details.</p>
<p>A longer term plan to provide a new form of SQL caching should solve this
kind of issue more comprehensively.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4947">#4947</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-4"><span class="target" id="change-d56478bf6f664353dd2d2e80b3bd0d9a"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d56478bf6f664353dd2d2e80b3bd0d9a">¶</a></span><p>Fixed ORM bug where a “secondary” table that referred to a selectable which
in some way would refer to the local primary table would apply aliasing to
both sides of the join condition when a relationship-related join, either
via <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> or by <a class="reference internal" href="../orm/loading_relationships.html#sqlalchemy.orm.joinedload" title="sqlalchemy.orm.joinedload"><code class="xref py py-func docutils literal notranslate"><span class="pre">joinedload()</span></code></a>, were generated.  The
“local” side is now excluded.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4974">#4974</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-engine">
<h3>engine<a class="headerlink" href="#change-1.3.11-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-5"><span class="target" id="change-3721f8766d11997b9492fdcf3be1bacc"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3721f8766d11997b9492fdcf3be1bacc">¶</a></span><p>Fixed bug where parameter repr as used in logging and error reporting needs
additional context in order to distinguish between a list of parameters for
a single statement and a list of parameter lists, as the “list of lists”
structure could also indicate a single parameter list where the first
parameter itself is a list, such as for an array parameter.   The
engine/connection now passes in an additional boolean indicating how the
parameters should be considered.  The only SQLAlchemy backend that expects
arrays as parameters is that of  psycopg2 which uses pyformat parameters,
so this issue has not been too apparent, however as other drivers that use
positional gain more features it is important that this be supported. It
also eliminates the need for the parameter repr function to guess based on
the parameter structure passed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4902">#4902</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-6"><span class="target" id="change-36b5415becccbab5e129a97ec19eeb60"><strong>[engine] [bug] [postgresql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-36b5415becccbab5e129a97ec19eeb60">¶</a></span><p>Fixed bug in <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector" title="sqlalchemy.engine.reflection.Inspector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inspector</span></code></a> where the cache key generation did not
take into account arguments passed in the form of tuples, such as the tuple
of view name styles to return for the PostgreSQL dialect. This would lead
the inspector to cache too generally for a more specific set of criteria.
The logic has been adjusted to include every keyword element in the cache,
as every argument is expected to be appropriate for a cache else the
caching decorator should be bypassed by the dialect.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4955">#4955</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-sql">
<h3>sql<a class="headerlink" href="#change-1.3.11-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-7"><span class="target" id="change-bb9f61c62c8410e277600f5e61b46fad"><strong>[sql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bb9f61c62c8410e277600f5e61b46fad">¶</a></span><p>Added new accessors to expressions of type <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> to allow for
specific datatype access and comparison, covering strings, integers,
numeric, boolean elements.   This revises the documented approach of
CASTing to string when comparing values, instead adding specific
functionality into the PostgreSQL, SQlite, MySQL dialects to reliably
deliver these basic types in all cases.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a></p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_string" title="sqlalchemy.types.JSON.Comparator.as_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_string()</span></code></a></p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_boolean" title="sqlalchemy.types.JSON.Comparator.as_boolean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_boolean()</span></code></a></p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_float" title="sqlalchemy.types.JSON.Comparator.as_float"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_float()</span></code></a></p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_integer" title="sqlalchemy.types.JSON.Comparator.as_integer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_integer()</span></code></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4276">#4276</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-8"><span class="target" id="change-7f362e2f1a2adac150bcd20d92359bb0"><strong>[sql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7f362e2f1a2adac150bcd20d92359bb0">¶</a></span><p>The <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a> construct now supports “unique” bound parameters, which
will dynamically uniquify themselves on compilation thus allowing multiple
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a> constructs with the same bound parameter names to be combined
together.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4933">#4933</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-9"><span class="target" id="change-378bc523e19fd7df6898432f84536ea7"><strong>[sql] [bug] [py3k]</strong> <a class="changelog-reference headerlink reference internal" href="#change-378bc523e19fd7df6898432f84536ea7">¶</a></span><p>Changed the <code class="docutils literal notranslate"><span class="pre">repr()</span></code> of the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a> construct to use
regular string repr() under Python 3, rather than running it through
“backslashreplace” escaping, which can be misleading.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4931">#4931</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-schema">
<h3>schema<a class="headerlink" href="#change-1.3.11-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-10"><span class="target" id="change-391a646c5fe982f3e30903cf6aae06b3"><strong>[schema] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-391a646c5fe982f3e30903cf6aae06b3">¶</a></span><p>Added DDL support for “computed columns”; these are DDL column
specifications for columns that have a server-computed value, either upon
SELECT (known as “virtual”) or at the point of which they are INSERTed or
UPDATEd (known as “stored”).  Support is established for Postgresql, MySQL,
Oracle SQL Server and Firebird. Thanks to Federico Caselli for lots of work
on this one.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/defaults.html#computed-ddl"><span class="std std-ref">Computed Columns (GENERATED ALWAYS AS)</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4894">#4894</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-11"><span class="target" id="change-88ba6306a0f9db52061e4a509f64597b"><strong>[schema] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-88ba6306a0f9db52061e4a509f64597b">¶</a></span><p>Fixed bug where a table that would have a column label overlap with a plain
column name, such as “foo.id AS foo_id” vs. “foo.foo_id”, would prematurely
generate the <code class="docutils literal notranslate"><span class="pre">._label</span></code> attribute for a column before this overlap could
be detected due to the use of the <code class="docutils literal notranslate"><span class="pre">index=True</span></code> or <code class="docutils literal notranslate"><span class="pre">unique=True</span></code> flag on
the column in conjunction with the default naming convention of
<code class="docutils literal notranslate"><span class="pre">&quot;column_0_label&quot;</span></code>.  This would then lead to failures when <code class="docutils literal notranslate"><span class="pre">._label</span></code>
were used later to generate a bound parameter name, in particular those
used by the ORM when generating the WHERE clause for an UPDATE statement.
The issue has been fixed by using an alternate <code class="docutils literal notranslate"><span class="pre">._label</span></code> accessor for DDL
generation that does not affect the state of the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>.   The
accessor also bypasses the key-deduplication step as it is not necessary
for DDL, the naming is now consistently <code class="docutils literal notranslate"><span class="pre">&quot;&lt;tablename&gt;_&lt;columnname&gt;&quot;</span></code>
without any subsequent numeric symbols when used in DDL.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4911">#4911</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.11-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-12"><span class="target" id="change-01563b32035e0bd0d4630e54cced5a1e"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-01563b32035e0bd0d4630e54cced5a1e">¶</a></span><p>Added “Connection was killed” message interpreted from the base
pymysql.Error class in order to detect closed connection, based on reports
that this message is arriving via a pymysql.InternalError() object which
indicates pymysql is not handling it correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4945">#4945</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.11-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-13"><span class="target" id="change-edc3c106a9c040b3bf26c365a5e41d45"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-edc3c106a9c040b3bf26c365a5e41d45">¶</a></span><p>Fixed issue in MSSQL dialect where an expression-based OFFSET value in a
SELECT would be rejected, even though the dialect can render this
expression inside of a ROW NUMBER-oriented LIMIT/OFFSET construct.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4973">#4973</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-14"><span class="target" id="change-e2b763c05565f128881dcc4e58f94e7c"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e2b763c05565f128881dcc4e58f94e7c">¶</a></span><p>Fixed an issue in the <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine.table_names" title="sqlalchemy.engine.Engine.table_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.table_names()</span></code></a> method where it would
feed the dialect’s default schema name back into the dialect level table
function, which in the case of SQL Server would interpret it as a
dot-tokenized schema name as viewed by the mssql dialect, which would
cause the method to fail in the case where the database username actually
had a dot inside of it.  In 1.3, this method is still used by the
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MetaData.reflect()</span></code></a> function so is a prominent codepath. In 1.4,
which is the current master development branch, this issue doesn’t exist,
both because <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MetaData.reflect()</span></code></a> isn’t using this method nor does the
method pass the default schema name explicitly.  The fix nonetheless
guards against the default server name value returned by the dialect from
being interpreted as dot-tokenized name under any circumstances by
wrapping it in quoted_name().</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4923">#4923</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.11-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-15"><span class="target" id="change-ecabed6215423c25dbaabffd240cc534"><strong>[oracle] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ecabed6215423c25dbaabffd240cc534">¶</a></span><p>Added dialect-level flag <code class="docutils literal notranslate"><span class="pre">encoding_errors</span></code> to the cx_Oracle dialect,
which can be specified as part of <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>.   This is passed
to SQLAlchemy’s unicode decoding converter under Python 2, and to
cx_Oracle’s <code class="docutils literal notranslate"><span class="pre">cursor.var()</span></code> object as the <code class="docutils literal notranslate"><span class="pre">encodingErrors</span></code> parameter
under Python 3, for the very unusual case that broken encodings are present
in the target database which cannot be fetched unless error handling is
relaxed.  The value is ultimately one of the Python “encoding errors”
parameters passed to <code class="docutils literal notranslate"><span class="pre">decode()</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4799">#4799</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-16"><span class="target" id="change-6e2130fa6a82e37bd06185bb09cec2a0"><strong>[oracle] [bug] [firebird]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6e2130fa6a82e37bd06185bb09cec2a0">¶</a></span><p>Modified the approach of “name normalization” for the Oracle and Firebird
dialects, which converts from the UPPERCASE-as-case-insensitive convention
of these dialects into lowercase-as-case-insensitive for SQLAlchemy, to not
automatically apply the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a> construct to a name that
matches itself under upper or lower case conversion, as is the case for
many non-european characters.   All names used within metadata structures
are converted to <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a> objects in any case; the change
here would only affect the output of some inspection functions.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4931">#4931</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-17"><span class="target" id="change-961c3e81222021baaff99c8fb04e102f"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-961c3e81222021baaff99c8fb04e102f">¶</a></span><p>The <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.NCHAR" title="sqlalchemy.types.NCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NCHAR</span></code></a> datatype will now bind to the
<code class="docutils literal notranslate"><span class="pre">cx_Oracle.FIXED_NCHAR</span></code> DBAPI data bindings when used in a bound
parameter, which supplies proper comparison behavior against a
variable-length string.  Previously, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.NCHAR" title="sqlalchemy.types.NCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NCHAR</span></code></a> datatype
would bind to <code class="docutils literal notranslate"><span class="pre">cx_oracle.NCHAR</span></code> which is not fixed length; the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.CHAR" title="sqlalchemy.types.CHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAR</span></code></a> datatype already binds to <code class="docutils literal notranslate"><span class="pre">cx_Oracle.FIXED_CHAR</span></code>
so it is now consistent that <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.NCHAR" title="sqlalchemy.types.NCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NCHAR</span></code></a> binds to
<code class="docutils literal notranslate"><span class="pre">cx_Oracle.FIXED_NCHAR</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4913">#4913</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-firebird">
<h3>firebird<a class="headerlink" href="#change-1.3.11-firebird" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-18"><span class="target" id="change-71bd2f96ab811564e04751aeafbbb2bd"><strong>[firebird] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-71bd2f96ab811564e04751aeafbbb2bd">¶</a></span><p>Added additional “disconnect” message “Error writing data to the
connection” to Firebird disconnection detection.  Pull request courtesy
lukens.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4903">#4903</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.11-misc">
<h3>misc<a class="headerlink" href="#change-1.3.11-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.11-19"><span class="target" id="change-ea773cd62256f68eccb5456a1192752a"><strong>[bug] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ea773cd62256f68eccb5456a1192752a">¶</a></span><p>Fixed test failures which would occur with newer SQLite as of version 3.30
or greater, due to their addition of nulls ordering syntax as well as new
restrictions on aggregate functions.  Pull request courtesy Nils Philippsen.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4920">#4920</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.11-20"><span class="target" id="change-006d6676877dc187802636685ef65302"><strong>[bug] [installation] [windows]</strong> <a class="changelog-reference headerlink reference internal" href="#change-006d6676877dc187802636685ef65302">¶</a></span><p>Added a workaround for a setuptools-related failure that has been observed
as occurring on Windows installations, where setuptools is not correctly
reporting a build error when the MSVC build dependencies are not installed
and therefore not allowing graceful degradation into non C extensions
builds.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4967">#4967</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.10">
<h2 class="release-version">1.3.10<a class="headerlink" href="#change-1.3.10" title="Permalink to this headline">¶</a></h2>
Released: October 9, 2019<section id="change-1.3.10-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.10-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.10-0"><span class="target" id="change-a25feb9f973a183da85cd34f127e505e"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a25feb9f973a183da85cd34f127e505e">¶</a></span><p>Fixed bug in SQL Server dialect with new “max_identifier_length” feature
where the mssql dialect already featured this flag, and the implementation
did not accommodate for the new initialization hook correctly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4857">#4857</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.10-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.10-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.10-1"><span class="target" id="change-307744f0411f698a1e7a4b2525f08a9a"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-307744f0411f698a1e7a4b2525f08a9a">¶</a></span><p>Fixed regression in Oracle dialect that was inadvertently using max
identifier length of 128 characters on Oracle server 12.2 and greater even
though the stated contract for the remainder of the 1.3 series is  that
this value stays at 30 until version SQLAlchemy 1.4.  Also repaired issues
with the retrieval of the “compatibility” version, and removed the warning
emitted when the “v$parameter” view was not accessible as this was  causing
user confusion.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4857">#4857</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4898">#4898</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.9">
<h2 class="release-version">1.3.9<a class="headerlink" href="#change-1.3.9" title="Permalink to this headline">¶</a></h2>
Released: October 4, 2019<section id="change-1.3.9-orm">
<h3>orm<a class="headerlink" href="#change-1.3.9-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-0"><span class="target" id="change-c6e170e8016f63927f90a3c3bb20f208"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c6e170e8016f63927f90a3c3bb20f208">¶</a></span><p>Fixed regression in selectinload loader strategy caused by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4775">#4775</a>
(released in version 1.3.6) where a many-to-one attribute of None would no
longer be populated by the loader.  While this was usually not noticeable
due to the lazyloader populating None upon get, it would lead to a detached
instance error if the object were detached.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4872">#4872</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.9-1"><span class="target" id="change-c3a53eddc6dd7646c3f19d98e7fe04ea"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c3a53eddc6dd7646c3f19d98e7fe04ea">¶</a></span><p>Passing a plain string expression to <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a> is deprecated,
as all string coercions were removed in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4481">#4481</a> and this one should
have been included.   The <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal_column()</span></code></a> function may be used to
produce a textual column expression.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4873">#4873</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.9-2"><span class="target" id="change-08cfe387a2ab0b92f2828e9210c4a643"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-08cfe387a2ab0b92f2828e9210c4a643">¶</a></span><p>A warning is emitted for a condition in which the <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> may
implicitly swap an object out of the identity map for another one with the
same primary key, detaching the old one, which can be an observed result of
load operations which occur within the <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.SessionEvents.after_flush" title="sqlalchemy.orm.SessionEvents.after_flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SessionEvents.after_flush()</span></code></a>
hook.  The warning is intended to notify the user that some special
condition has caused this to happen and that the previous object may not be
in the expected state.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4890">#4890</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-engine">
<h3>engine<a class="headerlink" href="#change-1.3.9-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-3"><span class="target" id="change-71c9425076d826a346b7c0380e4ef25c"><strong>[engine] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-71c9425076d826a346b7c0380e4ef25c">¶</a></span><p>Added new <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> parameter
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.max_identifier_length" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.max_identifier_length</span></code></a>. This overrides the
dialect-coded “max identifier length” in order to accommodate for databases
that have recently changed this length and the SQLAlchemy dialect has
not yet been adjusted to detect for that version.  This parameter interacts
with the existing <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.label_length" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.label_length</span></code></a> parameter in that
it establishes the maximum (and default) value for anonymously generated
labels.   Additionally, post-connection detection of max identifier lengths
has been added to the dialect system.  This feature is first being used
by the Oracle dialect.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/oracle.html#oracle-max-identifier-lengths"><span class="std std-ref">Max Identifier Lengths</span></a> - in the Oracle dialect documentation</p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4857">#4857</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-sql">
<h3>sql<a class="headerlink" href="#change-1.3.9-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-4"><span class="target" id="change-27fcac827fd3d7b0a43ee981120012eb"><strong>[sql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-27fcac827fd3d7b0a43ee981120012eb">¶</a></span><p>Added an explicit error message for the case when objects passed to
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> are not <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects, rather than resolving
to an attribute error.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4847">#4847</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.9-5"><span class="target" id="change-36f30c6cfbebecb5815ec7badf8d1ac6"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-36f30c6cfbebecb5815ec7badf8d1ac6">¶</a></span><p>Characters that interfere with “pyformat” or “named” formats in bound
parameters, namely <code class="docutils literal notranslate"><span class="pre">%,</span> <span class="pre">(,</span> <span class="pre">)</span></code> and the space character, as well as a few
other typically undesirable characters, are stripped early for a
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal notranslate"><span class="pre">bindparam()</span></code></a> that is using an anonymized name, which is typically
generated automatically from a named column which itself includes these
characters in its name and does not use a <code class="docutils literal notranslate"><span class="pre">.key</span></code>, so that they do not
interfere either with the SQLAlchemy compiler’s use of string formatting or
with the driver-level parsing of the parameter, both of which could be
demonstrated before the fix.  The change only applies to anonymized
parameter names that are generated and consumed internally, not end-user
defined names, so the change should have no impact on any existing code.
Applies in particular to the psycopg2 driver which does not otherwise quote
special parameter names, but also strips leading underscores to suit Oracle
(but not yet leading numbers, as some anon parameters are currently
entirely numeric/underscore based); Oracle in any case continues to quote
parameter names that include special characters.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4837">#4837</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.9-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-6"><span class="target" id="change-bcbd8b81fb54100338568d1093456fae"><strong>[sqlite] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bcbd8b81fb54100338568d1093456fae">¶</a></span><p>Added support for sqlite “URI” connections, which allow for sqlite-specific
flags to be passed in the query string such as “read only” for Python
sqlite3 drivers that support this.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/sqlite.html#pysqlite-uri-connections"><span class="std std-ref">URI Connections</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4863">#4863</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.9-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-7"><span class="target" id="change-f2d1754ffb70a578e19c41eada3fb411"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f2d1754ffb70a578e19c41eada3fb411">¶</a></span><p>Added identifier quoting to the schema name applied to the “use” statement
which is invoked when a SQL Server multipart schema name is used within  a
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> that is being reflected, as well as for <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector" title="sqlalchemy.engine.reflection.Inspector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inspector</span></code></a>
methods such as <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_table_names" title="sqlalchemy.engine.reflection.Inspector.get_table_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Inspector.get_table_names()</span></code></a>; this accommodates for
special characters or spaces in the database name.  Additionally, the “use”
statement is not emitted if the current database matches the target owner
database name being passed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4883">#4883</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.9-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-8"><span class="target" id="change-09a2115c335ea2a0dbdee665cffc9f0c"><strong>[oracle] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-09a2115c335ea2a0dbdee665cffc9f0c">¶</a></span><p>The Oracle dialect now emits a warning if Oracle version 12.2 or greater is
used, and the <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.max_identifier_length" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.max_identifier_length</span></code></a> parameter is
not set.   The version in this specific case defaults to that of the
“compatibility” version set in the Oracle server configuration, not the
actual server version.   In version 1.4, the default max_identifier_length
for 12.2 or greater will move to 128 characters.  In order to maintain
forwards compatibility, applications should set
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.max_identifier_length" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.max_identifier_length</span></code></a> to 30 in order to maintain
the same length behavior, or to 128 in order to test the upcoming behavior.
This length determines among other things how generated constraint names
are truncated for statements like <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">CONSTRAINT</span></code> and <code class="docutils literal notranslate"><span class="pre">DROP</span>
<span class="pre">CONSTRAINT</span></code>, which means a the new length may produce a name-mismatch
against a name that was generated with the old length, impacting database
migrations.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/oracle.html#oracle-max-identifier-lengths"><span class="std std-ref">Max Identifier Lengths</span></a> - in the Oracle dialect documentation</p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4857">#4857</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.9-9"><span class="target" id="change-976475eab1c7564961b03f3cd2c498fd"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-976475eab1c7564961b03f3cd2c498fd">¶</a></span><p>Restored adding cx_Oracle.DATETIME to the setinputsizes() call when a
SQLAlchemy <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Date" title="sqlalchemy.types.Date"><code class="xref py py-class docutils literal notranslate"><span class="pre">Date</span></code></a>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">DateTime</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Time" title="sqlalchemy.types.Time"><code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code></a> datatype is
used, as some complex queries require this to be present.  This was removed
in the 1.2 series for arbitrary reasons.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4886">#4886</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.9-misc">
<h3>misc<a class="headerlink" href="#change-1.3.9-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.9-10"><span class="target" id="change-3cb82324e231941401ce9b9ad7fd725f"><strong>[bug] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3cb82324e231941401ce9b9ad7fd725f">¶</a></span><p>Fixed unit test regression released in 1.3.8 that would cause failure for
Oracle, SQL Server and other non-native ENUM platforms due to new
enumeration tests added as part of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4285">#4285</a> enum sortability in the
unit of work; the enumerations created constraints that were duplicated on
name.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4285">#4285</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.8">
<h2 class="release-version">1.3.8<a class="headerlink" href="#change-1.3.8" title="Permalink to this headline">¶</a></h2>
Released: August 27, 2019<section id="change-1.3.8-orm">
<h3>orm<a class="headerlink" href="#change-1.3.8-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.8-0"><span class="target" id="change-ac119f6307026142f7a0ccbf81065f25"><strong>[orm] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ac119f6307026142f7a0ccbf81065f25">¶</a></span><p>Added support for the use of an <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> datatype using Python
pep-435 enumeration objects as values for use as a primary key column
mapped by the ORM.  As these values are not inherently sortable, as
required by the ORM for primary keys, a new
<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.sort_key_function" title="sqlalchemy.types.TypeEngine.sort_key_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TypeEngine.sort_key_function</span></code></a> attribute is added to the typing
system which allows any SQL type to  implement a sorting for Python objects
of its type which is consulted by the unit of work.   The <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>
type then defines this using the  database value of a given enumeration.
The sorting scheme can be  also be redefined by passing a callable to the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum.params.sort_key_function" title="sqlalchemy.types.Enum"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Enum.sort_key_function</span></code></a> parameter.  Pull request courtesy
Nicolas Caniart.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4285">#4285</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.8-1"><span class="target" id="change-9b2927f524e02bec34c1c02e54b9038c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9b2927f524e02bec34c1c02e54b9038c">¶</a></span><p>Fixed bug where <a class="reference internal" href="../orm/loading_relationships.html#sqlalchemy.orm.Load" title="sqlalchemy.orm.Load"><code class="xref py py-class docutils literal notranslate"><span class="pre">Load</span></code></a> objects were not pickleable due to
mapper/relationship state in the internal context dictionary.  These
objects are now converted to picklable using similar techniques as that of
other elements within the loader option system that have long been
serializable.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4823">#4823</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.8-engine">
<h3>engine<a class="headerlink" href="#change-1.3.8-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.8-2"><span class="target" id="change-b5ab681947321043ec2c942835adf374"><strong>[engine] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b5ab681947321043ec2c942835adf374">¶</a></span><p>Added new parameter <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.hide_parameters" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.hide_parameters</span></code></a> which when
set to True will cause SQL parameters to no longer be logged, nor rendered
in the string representation of a <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.StatementError" title="sqlalchemy.exc.StatementError"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatementError</span></code></a> object.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4815">#4815</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.8-3"><span class="target" id="change-c786ebd8187c48835411438d55c1d683"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c786ebd8187c48835411438d55c1d683">¶</a></span><p>Fixed an issue whereby if the dialect “initialize” process which occurs on
first connect would encounter an unexpected exception, the initialize
process would fail to complete and then no longer attempt on subsequent
connection attempts, leaving the dialect in an un-initialized, or partially
initialized state, within the scope of parameters that need to be
established based on inspection of a live connection.   The “invoke once”
logic in the event system has been reworked to accommodate for this
occurrence using new, private API features that establish an “exec once”
hook that will continue to allow the initializer to fire off on subsequent
connections, until it completes without raising an exception. This does not
impact the behavior of the existing <code class="docutils literal notranslate"><span class="pre">once=True</span></code> flag within the event
system.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4807">#4807</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.8-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.8-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.8-4"><span class="target" id="change-db9bcbbb4a98d4d29f469d2b2fae93c5"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-db9bcbbb4a98d4d29f469d2b2fae93c5">¶</a></span><p>Added support for reflection of CHECK constraints that include the special
PostgreSQL qualifier “NOT VALID”, which can be present for CHECK
constraints that were added to an existing table with the directive that
they not be applied to existing data in the table. The PostgreSQL
dictionary for CHECK constraints as returned by
<a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_check_constraints" title="sqlalchemy.engine.reflection.Inspector.get_check_constraints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Inspector.get_check_constraints()</span></code></a> may include an additional entry
<code class="docutils literal notranslate"><span class="pre">dialect_options</span></code> which within will contain an entry <code class="docutils literal notranslate"><span class="pre">&quot;not_valid&quot;:</span>
<span class="pre">True</span></code> if this symbol is detected.   Pull request courtesy Bill Finn.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4824">#4824</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.8-5"><span class="target" id="change-9b1057d829ec2bb1a574199d0d894953"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9b1057d829ec2bb1a574199d0d894953">¶</a></span><p>Revised the approach for the just added support for the psycopg2
“execute_values()” feature added in 1.3.7 for <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4623">#4623</a>.  The approach
relied upon a regular expression that would fail to match for a more
complex INSERT statement such as one which had subqueries involved.   The
new approach matches exactly the string that was rendered as the VALUES
clause.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4623">#4623</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.8-6"><span class="target" id="change-830ba546a6ea4b8cbcfc1fbd6041cd96"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-830ba546a6ea4b8cbcfc1fbd6041cd96">¶</a></span><p>Fixed bug where Postgresql operators such as
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ARRAY.Comparator.contains" title="sqlalchemy.dialects.postgresql.ARRAY.Comparator.contains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.contains()</span></code></a> and
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ARRAY.Comparator.contained_by" title="sqlalchemy.dialects.postgresql.ARRAY.Comparator.contained_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.contained_by()</span></code></a> would fail to function
correctly for non-integer values when used against a
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.array" title="sqlalchemy.dialects.postgresql.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></a> object, due to an erroneous assert statement.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4822">#4822</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.8-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.8-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.8-7"><span class="target" id="change-81ea1a958e09a9d1cb8d55966db673e8"><strong>[sqlite] [bug] [reflection]</strong> <a class="changelog-reference headerlink reference internal" href="#change-81ea1a958e09a9d1cb8d55966db673e8">¶</a></span><p>Fixed bug where a FOREIGN KEY that was set up to refer to the parent table
by table name only without the column names would not correctly be
reflected as far as setting up the “referred columns”, since SQLite’s
PRAGMA does not report on these columns if they weren’t given explicitly.
For some reason this was hardcoded to assume the name of the local column,
which might work for some cases but is not correct. The new approach
reflects the primary key of the referred table and uses the constraint
columns list as the referred columns list, if the remote column(s) aren’t
present in the reflected pragma directly.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4810">#4810</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.7">
<h2 class="release-version">1.3.7<a class="headerlink" href="#change-1.3.7" title="Permalink to this headline">¶</a></h2>
Released: August 14, 2019<section id="change-1.3.7-orm">
<h3>orm<a class="headerlink" href="#change-1.3.7-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-0"><span class="target" id="change-9e17da7aa51a93c0911ba41cd9455efd"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9e17da7aa51a93c0911ba41cd9455efd">¶</a></span><p>Fixed regression caused by new selectinload for many-to-one logic where
a primaryjoin condition not based on real foreign keys would cause
KeyError if a related object did not exist for a given key value on the
parent object.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4777">#4777</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-1"><span class="target" id="change-d8965362e2cf6126aa653f5f6c5ee6d4"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d8965362e2cf6126aa653f5f6c5ee6d4">¶</a></span><p>Fixed bug where using <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.first" title="sqlalchemy.orm.Query.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></a> or a slice expression in
conjunction with a query that has an expression based “offset” applied
would raise TypeError, due to an “or” conditional against “offset” that did
not expect it to be a SQL expression as opposed to an integer or None.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4803">#4803</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-sql">
<h3>sql<a class="headerlink" href="#change-1.3.7-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-2"><span class="target" id="change-c8c6c26d954823420bb150a4933b0730"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c8c6c26d954823420bb150a4933b0730">¶</a></span><p>Fixed issue where <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a> object which contained a mixture of
functional expressions which were not resolvable to a particular column,
in combination with string-based column names, would fail to initialize
its internal state correctly leading to failures during DDL compilation.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4778">#4778</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-3"><span class="target" id="change-6e58c1424086df8040e2391c84ad4e0b"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6e58c1424086df8040e2391c84ad4e0b">¶</a></span><p>Fixed bug where <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.column_expression" title="sqlalchemy.types.TypeEngine.column_expression"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TypeEngine.column_expression()</span></code></a> method would not be
applied to subsequent SELECT statements inside of a UNION or other
<code class="xref py py-class docutils literal notranslate"><span class="pre">_selectable.CompoundSelect</span></code>, even though the SELECT statements are rendered at
the topmost level of the statement.   New logic now differentiates between
rendering the column expression, which is needed for all SELECTs in the
list, vs. gathering the returned data type for the result row, which is
needed only for the first SELECT.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4787">#4787</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-4"><span class="target" id="change-415d349b1f56e15600ba41c86b32776d"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-415d349b1f56e15600ba41c86b32776d">¶</a></span><p>Fixed issue where internal cloning of SELECT constructs could lead to a key
error if the copy of the SELECT changed its state such that its list of
columns changed.  This was observed to be occurring in some ORM scenarios
which may be unique to 1.3 and above, so is partially a regression fix.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4780">#4780</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.7-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-5"><span class="target" id="change-81adffad59eb0409dda978709ac23896"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-81adffad59eb0409dda978709ac23896">¶</a></span><p>Added new dialect flag for the psycopg2 dialect, <code class="docutils literal notranslate"><span class="pre">executemany_mode</span></code> which
supersedes the previous experimental <code class="docutils literal notranslate"><span class="pre">use_batch_mode</span></code> flag.
<code class="docutils literal notranslate"><span class="pre">executemany_mode</span></code> supports both the “execute batch” and “execute values”
functions provided by psycopg2, the latter which is used for compiled
<a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.insert" title="sqlalchemy.sql.expression.insert"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert()</span></code></a> constructs.   Pull request courtesy Yuval Dinari.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/postgresql.html#psycopg2-executemany-mode"><span class="std std-ref">Psycopg2 Fast Execution Helpers</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4623">#4623</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.7-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-6"><span class="target" id="change-a2719376c01036b46eadcd36153c68ae"><strong>[mysql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a2719376c01036b46eadcd36153c68ae">¶</a></span><p>Added reserved words ARRAY and MEMBER to the MySQL reserved words list, as
MySQL 8.0 has now made these reserved.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4783">#4783</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-7"><span class="target" id="change-cbf0ceb704e09d20731e08bb7395f248"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-cbf0ceb704e09d20731e08bb7395f248">¶</a></span><p>The MySQL dialects will emit “SET NAMES” at the start of a connection when
charset is given to the MySQL driver, to appease an apparent behavior
observed in MySQL 8.0 that raises a collation error when a UNION includes
string columns unioned against columns of the form CAST(NULL AS CHAR(..)),
which is what SQLAlchemy’s polymorphic_union function does.   The issue
seems to have affected PyMySQL for at least a year, however has recently
appeared as of mysqlclient 1.4.4 based on changes in how this DBAPI creates
a connection.  As the presence of this directive impacts three separate
MySQL charset settings which each have intricate effects based on their
presense,  SQLAlchemy will now emit the directive on new connections to
ensure correct behavior.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4804">#4804</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-8"><span class="target" id="change-334ebbd9d86e60cecb4f72c0ae4652e0"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-334ebbd9d86e60cecb4f72c0ae4652e0">¶</a></span><p>Added another fix for an upstream MySQL 8 issue where a case sensitive
table name is reported incorrectly in foreign key constraint reflection,
this is an extension of the fix first added for <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4344">#4344</a> which
affects a case sensitive column name.  The new issue occurs through MySQL
8.0.17, so the general logic of the 88718 fix remains in place.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://bugs.mysql.com/bug.php?id=96365">https://bugs.mysql.com/bug.php?id=96365</a> - upstream bug</p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4751">#4751</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.7-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-9"><span class="target" id="change-939ddce6557fce9c08672ae2ba623236"><strong>[sqlite] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-939ddce6557fce9c08672ae2ba623236">¶</a></span><p>The dialects that support json are supposed to take arguments
<code class="docutils literal notranslate"><span class="pre">json_serializer</span></code> and <code class="docutils literal notranslate"><span class="pre">json_deserializer</span></code> at the create_engine() level,
however the SQLite dialect calls them <code class="docutils literal notranslate"><span class="pre">_json_serializer</span></code> and
<code class="docutils literal notranslate"><span class="pre">_json_deserilalizer</span></code>.  The names have been corrected, the old names are
accepted with a change warning, and these parameters are now documented as
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.json_serializer" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.json_serializer</span></code></a> and
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.json_deserializer" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.json_deserializer</span></code></a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4798">#4798</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.7-10"><span class="target" id="change-d8878320642f308978ccfd408d035957"><strong>[sqlite] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d8878320642f308978ccfd408d035957">¶</a></span><p>Fixed bug where usage of “PRAGMA table_info” in SQLite dialect meant that
reflection features to detect for table existence, list of table columns,
and list of foreign keys, would default to any table in any attached
database, when no schema name was given and the table did not exist in the
base schema.  The fix explicitly runs PRAGMA for the ‘main’ schema and then
the ‘temp’ schema if the ‘main’ returned no rows, to maintain the behavior
of tables + temp tables in the “no schema” namespace, attached tables only
in the “schema” namespace.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4793">#4793</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.7-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-11"><span class="target" id="change-32cb271c96066f8ab833a38d05dd6f3d"><strong>[mssql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-32cb271c96066f8ab833a38d05dd6f3d">¶</a></span><p>Added new <a class="reference internal" href="../dialects/mssql.html#sqlalchemy.dialects.mssql.try_cast" title="sqlalchemy.dialects.mssql.try_cast"><code class="xref py py-func docutils literal notranslate"><span class="pre">try_cast()</span></code></a> construct for SQL Server which emits
“TRY_CAST” syntax.  Pull request courtesy Leonel Atencio.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4782">#4782</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.7-misc">
<h3>misc<a class="headerlink" href="#change-1.3.7-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.7-12"><span class="target" id="change-e2f3e721e36bd8a14630e8cd2e8666c1"><strong>[bug] [events]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e2f3e721e36bd8a14630e8cd2e8666c1">¶</a></span><p>Fixed issue in event system where using the <code class="docutils literal notranslate"><span class="pre">once=True</span></code> flag with
dynamically generated listener functions would cause event registration of
future events to fail if those listener functions were garbage collected
after they were used, due to an assumption that a listened function is
strongly referenced.  The “once” wrapped is now modified to strongly
reference the inner function persistently, and documentation is updated
that using “once” does not imply automatic de-registration of listener
functions.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4794">#4794</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.6">
<h2 class="release-version">1.3.6<a class="headerlink" href="#change-1.3.6" title="Permalink to this headline">¶</a></h2>
Released: July 21, 2019<section id="change-1.3.6-orm">
<h3>orm<a class="headerlink" href="#change-1.3.6-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-0"><span class="target" id="change-dd0f089772d6d70336d9f15737495fe8"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-dd0f089772d6d70336d9f15737495fe8">¶</a></span><p>Added new loader option method <a class="reference internal" href="../orm/loading_relationships.html#sqlalchemy.orm.Load.options" title="sqlalchemy.orm.Load.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Load.options()</span></code></a> which allows loader
options to be constructed hierarchically, so that many sub-options can be
applied to a particular path without needing to call <a class="reference internal" href="../orm/loading_relationships.html#sqlalchemy.orm.defaultload" title="sqlalchemy.orm.defaultload"><code class="xref py py-func docutils literal notranslate"><span class="pre">defaultload()</span></code></a>
many times.  Thanks to Alessio Bogon for the idea.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4736">#4736</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-1"><span class="target" id="change-fead3cd4da1007c1243a4b6d3bb69640"><strong>[orm] [performance]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fead3cd4da1007c1243a4b6d3bb69640">¶</a></span><p>The optimization applied to selectin loading in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4340">#4340</a> where a JOIN
is not needed to eagerly load related items is now applied to many-to-one
relationships as well, so that only the related table is queried for a
simple join condition.   In this case, the related items are queried
based on the value of a foreign key column on the parent; if these columns
are deferred or otherwise not loaded on any of the parent objects in
the collection, the loader falls back to the JOIN method.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4775">#4775</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-2"><span class="target" id="change-c7ec6081d782036102725c5259e22182"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c7ec6081d782036102725c5259e22182">¶</a></span><p>Fixed regression caused by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4365">#4365</a> where a join from an entity to
itself without using aliases no longer raises an informative error message,
instead failing on an assertion.  The informative error condition has been
restored.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4773">#4773</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-3"><span class="target" id="change-69112dd0e0428007dad23c417534d7eb"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-69112dd0e0428007dad23c417534d7eb">¶</a></span><p>Fixed an issue where the <code class="xref py py-meth docutils literal notranslate"><span class="pre">_ORMJoin.join()</span></code> method, which is a
not-internally-used ORM-level method that exposes what is normally an
internal process of <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>, did not propagate the <code class="docutils literal notranslate"><span class="pre">full</span></code> and
<code class="docutils literal notranslate"><span class="pre">outerjoin</span></code> keyword arguments correctly.  Pull request courtesy Denis
Kataev.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4713">#4713</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-4"><span class="target" id="change-ba2299f83c70a5386392cab48c65061f"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ba2299f83c70a5386392cab48c65061f">¶</a></span><p>Fixed bug where a many-to-one relationship that specified <code class="docutils literal notranslate"><span class="pre">uselist=True</span></code>
would fail to update correctly during a primary key change where a related
column needs to change.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4772">#4772</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-5"><span class="target" id="change-55ecf4cbe0d5787c158b619bc51af81a"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-55ecf4cbe0d5787c158b619bc51af81a">¶</a></span><p>Fixed bug where the detection for many-to-one or one-to-one use with a
“dynamic” relationship, which is an invalid configuration, would fail to
raise if the relationship were configured with <code class="docutils literal notranslate"><span class="pre">uselist=True</span></code>.  The
current fix is that it warns, instead of raises, as this would otherwise be
backwards incompatible, however in a future release it will be a raise.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4772">#4772</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-6"><span class="target" id="change-9143b9288ce80712f75000eaaec97079"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9143b9288ce80712f75000eaaec97079">¶</a></span><p>Fixed bug where a synonym created against a mapped attribute that does not
exist yet, as is the case when it refers to backref before mappers are
configured, would raise recursion errors when trying to test for attributes
on it which ultimately don’t exist (as occurs when the classes are run
through Sphinx autodoc), as the unconfigured state of the synonym would put
it into an attribute not found loop.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4767">#4767</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-engine">
<h3>engine<a class="headerlink" href="#change-1.3.6-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-7"><span class="target" id="change-ae910a3904bdfbc4b9bdeef3482567dc"><strong>[engine] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ae910a3904bdfbc4b9bdeef3482567dc">¶</a></span><p>Fixed bug where using reflection function such as <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MetaData.reflect()</span></code></a>
with an <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object that had execution options applied to it
would fail, as the resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">OptionEngine</span></code> proxy object failed to
include a <code class="docutils literal notranslate"><span class="pre">.engine</span></code> attribute used within the reflection routines.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4754">#4754</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-sql">
<h3>sql<a class="headerlink" href="#change-1.3.6-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-8"><span class="target" id="change-07b0b0d7547c2a3de1465b661178d822"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-07b0b0d7547c2a3de1465b661178d822">¶</a></span><p>Adjusted the initialization for <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Enum" title="sqlalchemy.types.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a> to minimize how often it
invokes the <code class="docutils literal notranslate"><span class="pre">.__members__</span></code> attribute of a given PEP-435 enumeration
object, to suit the case where this attribute is expensive to invoke, as is
the case for some popular third party enumeration libraries.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4758">#4758</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-9"><span class="target" id="change-1a9048039acb73e027205fe857ead6ad"><strong>[sql] [bug] [postgresql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1a9048039acb73e027205fe857ead6ad">¶</a></span><p>Fixed issue where the <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.array_agg" title="sqlalchemy.sql.functions.array_agg"><code class="xref py py-class docutils literal notranslate"><span class="pre">array_agg</span></code></a> construct in combination with
<a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.FunctionElement.filter" title="sqlalchemy.sql.functions.FunctionElement.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FunctionElement.filter()</span></code></a> would not produce the correct operator
precedence in combination with the array index operator.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4760">#4760</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-10"><span class="target" id="change-6d31ce658d3b6da9ceb5b0469739a672"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6d31ce658d3b6da9ceb5b0469739a672">¶</a></span><p>Fixed an unlikely issue where the “corresponding column” routine for unions
and other <code class="xref py py-class docutils literal notranslate"><span class="pre">_selectable.CompoundSelect</span></code> objects could return the wrong column in
some overlapping column situations, thus potentially impacting some ORM
operations when set operations are in use, if the underlying
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> constructs were used previously in other similar kinds of
routines, due to a cached value not being cleared.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4747">#4747</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.6-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-11"><span class="target" id="change-b688caaa5b852fed2dee3a63c09fefea"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b688caaa5b852fed2dee3a63c09fefea">¶</a></span><p>Added support for reflection of indexes on PostgreSQL partitioned tables,
which was added to PostgreSQL as of version 11.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4771">#4771</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-12"><span class="target" id="change-1684f4b94cf2ce70ed82d77524fa0ec6"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1684f4b94cf2ce70ed82d77524fa0ec6">¶</a></span><p>Added support for multidimensional Postgresql array literals via nesting
the <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.array" title="sqlalchemy.dialects.postgresql.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></a> object within another one.  The
multidimensional array type is detected automatically.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.array" title="sqlalchemy.dialects.postgresql.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4756">#4756</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.6-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-13"><span class="target" id="change-6e5af8406937bb823d9de0be1f0b2066"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6e5af8406937bb823d9de0be1f0b2066">¶</a></span><p>Fixed bug where the special logic to render “NULL” for the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.TIMESTAMP" title="sqlalchemy.types.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a> datatype when <code class="docutils literal notranslate"><span class="pre">nullable=True</span></code> would not work if the
column’s datatype were a <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> or a <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.Variant" title="sqlalchemy.types.Variant"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code></a>.
The logic now ensures that it unwraps down to the original
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.TIMESTAMP" title="sqlalchemy.types.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a> so that this special case NULL keyword is correctly
rendered when requested.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4743">#4743</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.6-14"><span class="target" id="change-89be6e7618116a4f448ec39de9d26342"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-89be6e7618116a4f448ec39de9d26342">¶</a></span><p>Enhanced MySQL/MariaDB version string parsing to accommodate for exotic
MariaDB version strings where the “MariaDB” word is embedded among other
alphanumeric characters such as “MariaDBV1”.   This detection is critical in
order to correctly accommodate for API features that have split between MySQL
and MariaDB such as the “transaction_isolation” system variable.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4624">#4624</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.6-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-15"><span class="target" id="change-ff72be221ca8833a7265864456027d5e"><strong>[sqlite] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ff72be221ca8833a7265864456027d5e">¶</a></span><p>Added support for composite (tuple) IN operators with SQLite, by rendering
the VALUES keyword for this backend.  As other backends such as DB2 are
known to use the same syntax, the syntax is enabled in the base compiler
using a dialect-level flag <code class="docutils literal notranslate"><span class="pre">tuple_in_values</span></code>.   The change also includes
support for “empty IN tuple” expressions for SQLite when using “in_()”
between a tuple value and an empty set.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4766">#4766</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.6-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.6-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.6-16"><span class="target" id="change-be70c0ec4b1f10a6e52a0fabfbcd464d"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-be70c0ec4b1f10a6e52a0fabfbcd464d">¶</a></span><p>Ensured that the queries used to reflect indexes and view definitions will
explicitly CAST string parameters into NVARCHAR, as many SQL Server drivers
frequently treat string values, particularly those with non-ascii
characters or larger string values, as TEXT which often don’t compare
correctly against VARCHAR characters in SQL Server’s information schema
tables for some reason.    These CAST operations already take place for
reflection queries against SQL Server <code class="docutils literal notranslate"><span class="pre">information_schema.</span></code> tables but
were missing from three additional queries that are against <code class="docutils literal notranslate"><span class="pre">sys.</span></code>
tables.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4745">#4745</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.5">
<h2 class="release-version">1.3.5<a class="headerlink" href="#change-1.3.5" title="Permalink to this headline">¶</a></h2>
Released: June 17, 2019<section id="change-1.3.5-orm">
<h3>orm<a class="headerlink" href="#change-1.3.5-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.5-0"><span class="target" id="change-f7c6e23c686ccca2d91410a9b1943902"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f7c6e23c686ccca2d91410a9b1943902">¶</a></span><p>Fixed a series of related bugs regarding joined table inheritance more than
two levels deep, in conjunction with modification to primary key values,
where those primary key columns are also linked together in a foreign key
relationship as is typical for joined table inheritance.  The intermediary
table in a  three-level inheritance hierarchy will now get its UPDATE if
only the primary key value has changed and passive_updates=False (e.g.
foreign key constraints not being enforced), whereas before it would be
skipped; similarly, with passive_updates=True (e.g. ON UPDATE  CASCADE in
effect), the third-level table will not receive an UPDATE statement as was
the case earlier which would fail since CASCADE already modified it.   In a
related issue, a relationship linked to a three-level inheritance hierarchy
on the primary key of an intermediary table of a joined-inheritance
hierarchy will also correctly have its foreign key column updated when the
parent object’s primary key is modified, even if that parent object is a
subclass of the linked parent class, whereas before these classes would
not be counted.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4723">#4723</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.5-1"><span class="target" id="change-c9c1a19084805538d2fccfc0b1a689d4"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c9c1a19084805538d2fccfc0b1a689d4">¶</a></span><p>Fixed bug where the <a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper.all_orm_descriptors" title="sqlalchemy.orm.Mapper.all_orm_descriptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Mapper.all_orm_descriptors</span></code></a> accessor would
return an entry for the <a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> itself under the declarative
<code class="docutils literal notranslate"><span class="pre">__mapper___</span></code> key, when this is not a descriptor.  The <code class="docutils literal notranslate"><span class="pre">.is_attribute</span></code>
flag that’s present on all <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.InspectionAttr" title="sqlalchemy.orm.InspectionAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">InspectionAttr</span></code></a> objects is now
consulted, which has also been modified to be <code class="docutils literal notranslate"><span class="pre">True</span></code> for an association
proxy, as it was erroneously set to False for this object.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4729">#4729</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.5-2"><span class="target" id="change-991345d7f98890b7261c0d30fb6a04d8"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-991345d7f98890b7261c0d30fb6a04d8">¶</a></span><p>Fixed regression in <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> where the <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> flag
would not properly apply clause adaptation to filter criteria, if a
previous join were made to the same entity.  This is because the adapters
were placed in the wrong order.   The order has been reversed so that the
adapter for the most recent <code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> call takes precedence as was
the case in 1.2 and earlier.  This broke the “elementtree” examples among
other things.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4704">#4704</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.5-3"><span class="target" id="change-3d30a514a7daa1c30894aa39c3d5c583"><strong>[orm] [bug] [py3k]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3d30a514a7daa1c30894aa39c3d5c583">¶</a></span><p>Replaced the Python compatibility routines for <code class="docutils literal notranslate"><span class="pre">getfullargspec()</span></code> with a
fully vendored version from Python 3.3.  Originally, Python was emitting
deprecation warnings for this function in Python 3.8 alphas.  While this
change was reverted, it was observed that Python 3 implementations for
<code class="docutils literal notranslate"><span class="pre">getfullargspec()</span></code> are an order of magnitude slower as of the 3.4 series
where it was rewritten against <code class="docutils literal notranslate"><span class="pre">Signature</span></code>.  While Python plans to
improve upon this situation, SQLAlchemy projects for now are using a simple
replacement to avoid any future issues.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4674">#4674</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.5-4"><span class="target" id="change-41bce3204362cd2cb28f50f62ba6d8cc"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-41bce3204362cd2cb28f50f62ba6d8cc">¶</a></span><p>Reworked the attribute mechanics used by <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.util.AliasedClass" title="sqlalchemy.orm.util.AliasedClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code></a> to no
longer rely upon calling <code class="docutils literal notranslate"><span class="pre">__getattribute__</span></code> on the MRO of the wrapped
class, and to instead resolve the attribute normally on the wrapped class
using getattr(), and then unwrap/adapt that.  This allows a greater range
of attribute styles on the mapped class including special <code class="docutils literal notranslate"><span class="pre">__getattr__()</span></code>
schemes; but it also makes the code simpler and more resilient in general.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4694">#4694</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.5-sql">
<h3>sql<a class="headerlink" href="#change-1.3.5-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.5-5"><span class="target" id="change-81d45dad5dfea3a321cfc4ddf0e773a9"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-81d45dad5dfea3a321cfc4ddf0e773a9">¶</a></span><p>Fixed a series of quoting issues which all stemmed from the concept of the
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal_column()</span></code></a> construct, which when being “proxied” through a
subquery to be referred towards by a label that matches its text, the label
would not have quoting rules applied to it, even if the string in the
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.Label" title="sqlalchemy.sql.expression.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">Label</span></code></a> were set up as a <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.quoted_name" title="sqlalchemy.sql.expression.quoted_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">quoted_name</span></code></a> construct.  Not
applying quoting to the text of the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.Label" title="sqlalchemy.sql.expression.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">Label</span></code></a> is a bug because this
text is strictly a SQL identifier name and not a SQL expression, and the
string should not have quotes embedded into it already unlike the
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal_column()</span></code></a> which it may be applied towards.   The existing
behavior of a non-labeled <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal_column()</span></code></a> being propagated as is on
the outside of a subquery is maintained in order to help with manual
quoting schemes, although it’s not clear if valid SQL can be generated for
such a construct in any case.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4730">#4730</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.5-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.5-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.5-6"><span class="target" id="change-526670499c184afa2ce093f917b35210"><strong>[postgresql] [usecase]</strong> <a class="changelog-reference headerlink reference internal" href="#change-526670499c184afa2ce093f917b35210">¶</a></span><p>Added support for column sorting flags when reflecting indexes for
PostgreSQL, including ASC, DESC, NULLSFIRST, NULLSLAST.  Also adds this
facility to the reflection system in general which can be applied to other
dialects in future releases.  Pull request courtesy Eli Collins.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4717">#4717</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.5-7"><span class="target" id="change-5c60f9aab3a30f6f1b43661495ad0269"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5c60f9aab3a30f6f1b43661495ad0269">¶</a></span><p>Fixed bug where PostgreSQL dialect could not correctly reflect an ENUM
datatype that has no members, returning a list with <code class="docutils literal notranslate"><span class="pre">None</span></code> for the
<code class="docutils literal notranslate"><span class="pre">get_enums()</span></code> call and raising a TypeError when reflecting a column which
has such a datatype.   The inspection now returns an empty list.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4701">#4701</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.5-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.5-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.5-8"><span class="target" id="change-d76da00b79420e9a267ca7c27d58299f"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d76da00b79420e9a267ca7c27d58299f">¶</a></span><p>Fixed bug where MySQL ON DUPLICATE KEY UPDATE would not accommodate setting
a column to the value NULL.  Pull request courtesy Lukáš Banič.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4715">#4715</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.4">
<h2 class="release-version">1.3.4<a class="headerlink" href="#change-1.3.4" title="Permalink to this headline">¶</a></h2>
Released: May 27, 2019<section id="change-1.3.4-orm">
<h3>orm<a class="headerlink" href="#change-1.3.4-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-0"><span class="target" id="change-527a9a092c076e7dd72f94bc53134185"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-527a9a092c076e7dd72f94bc53134185">¶</a></span><p>Fixed issue where the <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.AttributeEvents.params.active_history" title="sqlalchemy.orm.AttributeEvents"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">AttributeEvents.active_history</span></code></a> flag
would not be set for an event listener that propagated to a subclass via the
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.AttributeEvents.params.propagate" title="sqlalchemy.orm.AttributeEvents"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">AttributeEvents.propagate</span></code></a> flag.   This bug has been present
for the full span of the <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.AttributeEvents" title="sqlalchemy.orm.AttributeEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeEvents</span></code></a> system.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4695">#4695</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-1"><span class="target" id="change-a4efe1aa09e4791c6800b91874f6f0fd"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a4efe1aa09e4791c6800b91874f6f0fd">¶</a></span><p>Fixed regression where new association proxy system was still not proxying
hybrid attributes when they made use of the <code class="docutils literal notranslate"><span class="pre">&#64;hybrid_property.expression</span></code>
decorator to return an alternate SQL expression, or when the hybrid
returned an arbitrary <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.PropComparator" title="sqlalchemy.orm.PropComparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropComparator</span></code></a>, at the expression level.
This involved further generalization of the heuristics used to detect the
type of object being proxied at the level of <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.QueryableAttribute" title="sqlalchemy.orm.QueryableAttribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryableAttribute</span></code></a>,
to better detect if the descriptor ultimately serves mapped classes or
column expressions.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4690">#4690</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-2"><span class="target" id="change-c74d8a44a1f4588e657a125f1f89ab58"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-c74d8a44a1f4588e657a125f1f89ab58">¶</a></span><p>Applied the mapper “configure mutex” against the declarative class mapping
process, to guard against the race which can occur if mappers are used
while dynamic module import schemes are still in the process of configuring
mappers for related classes.  This does not guard against all possible race
conditions, such as if the concurrent import has not yet encountered the
dependent classes as of yet, however it guards against as much as possible
within the SQLAlchemy declarative process.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4686">#4686</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-3"><span class="target" id="change-697d930ba034e0e742c6c208fac0d69e"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-697d930ba034e0e742c6c208fac0d69e">¶</a></span><p>A warning is now emitted for the case where a transient object is being
merged into the session with <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.merge" title="sqlalchemy.orm.Session.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code></a> when that object is
already transient in the <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.   This warns for the case where
the object would normally be double-inserted.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4647">#4647</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-4"><span class="target" id="change-79c0b6da168627917c2e9bf4c567b936"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-79c0b6da168627917c2e9bf4c567b936">¶</a></span><p>Fixed regression in new relationship m2o comparison logic first introduced
at <a class="reference internal" href="migration_13.html#change-4359"><span class="std std-ref">Improvement to the behavior of many-to-one query expressions</span></a> when comparing to an attribute that is persisted as
NULL and is in an un-fetched state in the mapped instance.  Since the
attribute has no explicit default, it needs to default to NULL when
accessed in a persistent setting.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4676">#4676</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-engine">
<h3>engine<a class="headerlink" href="#change-1.3.4-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-5"><span class="target" id="change-72fb6e6d786b02c7498f1f5612bd22d6"><strong>[engine] [bug] [postgresql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-72fb6e6d786b02c7498f1f5612bd22d6">¶</a></span><p>Moved the “rollback” which occurs during dialect initialization so that it
occurs after additional dialect-specific initialize steps, in particular
those of the psycopg2 dialect which would inadvertently leave transactional
state on the first new connection, which could interfere with some
psycopg2-specific APIs which require that no transaction is started.  Pull
request courtesy Matthew Wilkes.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4663">#4663</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-sql">
<h3>sql<a class="headerlink" href="#change-1.3.4-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-6"><span class="target" id="change-1a1f7679cfa113b0ed89624234b9b98f"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1a1f7679cfa113b0ed89624234b9b98f">¶</a></span><p>Fixed that the <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a> class was inadvertently
registering itself as one of the named functions.  Pull request courtesy
Adrien Berchet.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4653">#4653</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-7"><span class="target" id="change-ef9fa4c1f80c1f24f6712380f75259d7"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ef9fa4c1f80c1f24f6712380f75259d7">¶</a></span><p>Fixed issue where double negation of a boolean column wouldn’t reset
the “NOT” operator.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4618">#4618</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-8"><span class="target" id="change-5192b6f7c963dd9e19f4b2ce8e4e221b"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5192b6f7c963dd9e19f4b2ce8e4e221b">¶</a></span><p>The <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a> namespace is being migrated so that function
names are looked up in a case-insensitive manner, as SQL  functions do not
collide on case sensitive differences nor is this something which would
occur with user-defined functions or stored procedures.   Lookups for
functions declared with <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a> now use a case
insensitive scheme,  however a deprecation case is supported which allows
two or more <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.GenericFunction" title="sqlalchemy.sql.functions.GenericFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericFunction</span></code></a> objects with the same name of
different cases to exist, which will cause case sensitive lookups to occur
for that particular name, while emitting a warning at function registration
time.  Thanks to Adrien Berchet for a lot of work on this complicated
feature.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4569">#4569</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.4-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-9"><span class="target" id="change-4400e3621b39ee13ffe8445d4fa6e285"><strong>[postgresql] [bug] [orm]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4400e3621b39ee13ffe8445d4fa6e285">¶</a></span><p>Fixed an issue where the “number of rows matched” warning would emit even if
the dialect reported “supports_sane_multi_rowcount=False”, as is the case
for psycogp2 with <code class="docutils literal notranslate"><span class="pre">use_batch_mode=True</span></code> and others.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4661">#4661</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.4-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-10"><span class="target" id="change-b09b087026f5143acfb39e9c6b4f3cf0"><strong>[mysql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b09b087026f5143acfb39e9c6b4f3cf0">¶</a></span><p>Added support for DROP CHECK constraint which is required by MySQL 8.0.16
to drop a CHECK constraint; MariaDB supports plain DROP CONSTRAINT.  The
logic distinguishes between the two syntaxes by checking the server version
string for MariaDB presence.    Alembic migrations has already worked
around this issue by implementing its own DROP for MySQL / MariaDB CHECK
constraints, however this change implements it straight in Core so that its
available for general use.   Pull request courtesy Hannes Hansen.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4650">#4650</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.4-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-11"><span class="target" id="change-cd65f06e64aa7517e3b2be57063a2407"><strong>[mssql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-cd65f06e64aa7517e3b2be57063a2407">¶</a></span><p>Added support for SQL Server filtered indexes, via the <code class="docutils literal notranslate"><span class="pre">mssql_where</span></code>
parameter which works similarly to that of the <code class="docutils literal notranslate"><span class="pre">postgresql_where</span></code> index
function in the PostgreSQL dialect.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/mssql.html#mssql-index-where"><span class="std std-ref">Filtered Indexes</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4657">#4657</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.4-12"><span class="target" id="change-1ff2af502f01bc791808a73ca2036237"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1ff2af502f01bc791808a73ca2036237">¶</a></span><p>Added error code 20047 to “is_disconnect” for pymssql.  Pull request
courtesy Jon Schuff.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4680">#4680</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.4-misc">
<h3>misc<a class="headerlink" href="#change-1.3.4-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.4-13"><span class="target" id="change-318646b05cd537379c6b01d5e4b40f38"><strong>[misc] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-318646b05cd537379c6b01d5e4b40f38">¶</a></span><p>Removed errant “sqla_nose.py” symbol from MANIFEST.in which created an
undesirable warning message.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4625">#4625</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.3">
<h2 class="release-version">1.3.3<a class="headerlink" href="#change-1.3.3" title="Permalink to this headline">¶</a></h2>
Released: April 15, 2019<section id="change-1.3.3-orm">
<h3>orm<a class="headerlink" href="#change-1.3.3-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.3-0"><span class="target" id="change-0ef2df514d4d40ea01d9b62a9c5fdae1"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-0ef2df514d4d40ea01d9b62a9c5fdae1">¶</a></span><p>Fixed 1.3 regression in new “ambiguous FROMs” query logic introduced in
<a class="reference internal" href="migration_13.html#change-4365"><span class="std std-ref">Query.join() handles ambiguity in deciding the “left” side more explicitly</span></a> where a <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> that explicitly places an entity
in the FROM clause with <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.select_from" title="sqlalchemy.orm.Query.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a> and also joins to it
using <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> would later cause an “ambiguous FROM” error if
that entity were used in additional joins, as the entity appears twice in
the “from” list of the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.  The fix resolves this ambiguity by
folding the standalone entity into the join that it’s already a part of in
the same way that ultimately happens when the SELECT statement is rendered.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4584">#4584</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.3-1"><span class="target" id="change-6539bd0d116fc849738e24441b79595a"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6539bd0d116fc849738e24441b79595a">¶</a></span><p>Adjusted the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.filter_by" title="sqlalchemy.orm.Query.filter_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter_by()</span></code></a> method to not call <code class="xref py py-func docutils literal notranslate"><span class="pre">and()</span></code>
internally against multiple criteria, instead passing it off to
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.filter" title="sqlalchemy.orm.Query.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code></a> as a series of criteria, instead of a single criteria.
This allows <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.filter_by" title="sqlalchemy.orm.Query.filter_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter_by()</span></code></a> to defer to <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.filter" title="sqlalchemy.orm.Query.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code></a>’s
treatment of variable numbers of clauses, including the case where the list
is empty.  In this case, the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object will not have a
<code class="docutils literal notranslate"><span class="pre">.whereclause</span></code>, which allows subsequent “no whereclause” methods like
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.select_from" title="sqlalchemy.orm.Query.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a> to behave consistently.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4606">#4606</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.3-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.3-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.3-2"><span class="target" id="change-85c41a11787cfd9557572eeca3443c22"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-85c41a11787cfd9557572eeca3443c22">¶</a></span><p>Fixed regression from release 1.3.2 caused by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4562">#4562</a> where a URL
that contained only a query string and no hostname, such as for the
purposes of specifying a service file with connection information, would no
longer be propagated to psycopg2 properly.   The change in <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4562">#4562</a>
has been adjusted to further suit psycopg2’s exact requirements, which is
that if there are any connection parameters whatsoever, the “dsn” parameter
is no longer required, so in this case the query string parameters are
passed alone.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4601">#4601</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.3-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.3-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.3-3"><span class="target" id="change-3c0205a6f066ae773c8f41750a6451de"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3c0205a6f066ae773c8f41750a6451de">¶</a></span><p>Fixed issue in SQL Server dialect where if a bound parameter were present in
an ORDER BY expression that would ultimately not be rendered in the SQL
Server version of the statement, the parameters would still be part of the
execution parameters, leading to DBAPI-level errors.  Pull request courtesy
Matt Lewellyn.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4587">#4587</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.3-misc">
<h3>misc<a class="headerlink" href="#change-1.3.3-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.3-4"><span class="target" id="change-bd3ad321f22504d6f4718418eee910bf"><strong>[bug] [pool]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bd3ad321f22504d6f4718418eee910bf">¶</a></span><p>Fixed behavioral regression as a result of deprecating the “use_threadlocal”
flag for <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, where the <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> no longer
makes use of this option which causes the “rollback on return” logic to take
place when the same <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> is used multiple times in the context
of a transaction to connect or implicitly execute, thereby cancelling the
transaction.   While this is not the recommended way to work with engines
and connections, it is nonetheless a confusing behavioral change as when
using <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a>, the transaction should stay open
regardless of what else is done with the same engine in the same thread.
The <code class="docutils literal notranslate"><span class="pre">use_threadlocal</span></code> flag remains deprecated however the
<a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> now implements its own version of the same
logic.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4585">#4585</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.3-5"><span class="target" id="change-56ad28f66664deb283c67750ebe28cae"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-56ad28f66664deb283c67750ebe28cae">¶</a></span><p>Fixed bug where using <code class="docutils literal notranslate"><span class="pre">copy.copy()</span></code> or <code class="docutils literal notranslate"><span class="pre">copy.deepcopy()</span></code> on
<a class="reference internal" href="../orm/extensions/mutable.html#sqlalchemy.ext.mutable.MutableList" title="sqlalchemy.ext.mutable.MutableList"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableList</span></code></a> would cause the items within the list to be
duplicated, due to an inconsistency in how Python pickle and copy both make
use of <code class="docutils literal notranslate"><span class="pre">__getstate__()</span></code> and <code class="docutils literal notranslate"><span class="pre">__setstate__()</span></code> regarding lists.  In order
to resolve, a <code class="docutils literal notranslate"><span class="pre">__reduce_ex__</span></code> method had to be added to
<a class="reference internal" href="../orm/extensions/mutable.html#sqlalchemy.ext.mutable.MutableList" title="sqlalchemy.ext.mutable.MutableList"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableList</span></code></a>.  In order to maintain backwards compatibility with
existing pickles based on <code class="docutils literal notranslate"><span class="pre">__getstate__()</span></code>, the <code class="docutils literal notranslate"><span class="pre">__setstate__()</span></code> method
remains as well; the test suite asserts that pickles made against the old
version of the class can still be deserialized by the pickle module.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4603">#4603</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.2">
<h2 class="release-version">1.3.2<a class="headerlink" href="#change-1.3.2" title="Permalink to this headline">¶</a></h2>
Released: April 2, 2019<section id="change-1.3.2-orm">
<h3>orm<a class="headerlink" href="#change-1.3.2-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.2-0"><span class="target" id="change-3fea31ddd29487f5f164d2d77ad80603"><strong>[orm] [bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3fea31ddd29487f5f164d2d77ad80603">¶</a></span><p>Restored instance-level support for plain Python descriptors, e.g.
<code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> objects, in conjunction with association proxies, in that if
the proxied object is not within ORM scope at all, it gets classified as
“ambiguous” but is proxed directly.  For class level access, a basic class
level``__get__()`` now returns the
<code class="xref py py-class docutils literal notranslate"><span class="pre">AmbiguousAssociationProxyInstance</span></code> directly, rather than raising
its exception, which is the closest approximation to the previous behavior
that returned the <a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy" title="sqlalchemy.ext.associationproxy.AssociationProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssociationProxy</span></code></a> itself that’s possible.  Also
improved the stringification of these objects to be more descriptive of
current state.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4573">#4573</a>, <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4574">#4574</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.2-1"><span class="target" id="change-782a2b34df7b44a1e5aca2a74f9d536c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-782a2b34df7b44a1e5aca2a74f9d536c">¶</a></span><p>Fixed bug where use of <a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> or other aliased construct
would not properly adapt when the aliased target were used as the
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Select.correlate_except" title="sqlalchemy.sql.expression.Select.correlate_except"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.correlate_except()</span></code></a> target of a subquery used inside of a
<a class="reference internal" href="../orm/mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal notranslate"><span class="pre">column_property()</span></code></a>. This required a fix to the clause adaption
mechanics to properly handle a selectable that shows up in the “correlate
except” list, in a similar manner as which occurs for selectables that show
up in the “correlate” list.  This is ultimately a fairly fundamental bug
that has lasted for a long time but it is hard to come across it.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4537">#4537</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.2-2"><span class="target" id="change-e7295dd963e9034cbad550c2fb659f45"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e7295dd963e9034cbad550c2fb659f45">¶</a></span><p>Fixed regression where a new error message that was supposed to raise when
attempting to link a relationship option to an AliasedClass without using
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.PropComparator.of_type" title="sqlalchemy.orm.PropComparator.of_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PropComparator.of_type()</span></code></a> would instead raise an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>.
Note that in 1.3, it is no longer valid to create an option path from a
plain mapper relationship to an <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.util.AliasedClass" title="sqlalchemy.orm.util.AliasedClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code></a> without using
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.PropComparator.of_type" title="sqlalchemy.orm.PropComparator.of_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PropComparator.of_type()</span></code></a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4566">#4566</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.2-sql">
<h3>sql<a class="headerlink" href="#change-1.3.2-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.2-3"><span class="target" id="change-33e14205571c0d7746a46b88bb9717fd"><strong>[sql] [bug] [documentation]</strong> <a class="changelog-reference headerlink reference internal" href="#change-33e14205571c0d7746a46b88bb9717fd">¶</a></span><p>Thanks to <a class="reference internal" href="migration_13.html#change-3981"><span class="std std-ref">TypeEngine methods bind_expression, column_expression work with Variant, type-specific types</span></a>, we no longer need to rely on recipes that
subclass dialect-specific types directly, <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> can now
handle all cases.   Additionally, the above change made it slightly less
likely that a direct subclass of a base SQLAlchemy type would work as
expected, which could be misleading.  Documentation has been updated to use
<a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> for these examples including the PostgreSQL
“ArrayOfEnum” example datatype and direct support for the “subclass a type
directly” has been removed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4580">#4580</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.2-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.2-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.2-4"><span class="target" id="change-f5315b482fc3d0f2ec88daa2f010684f"><strong>[postgresql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f5315b482fc3d0f2ec88daa2f010684f">¶</a></span><p>Added support for parameter-less connection URLs for the psycopg2 dialect,
meaning, the URL can be passed to <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> as
<code class="docutils literal notranslate"><span class="pre">&quot;postgresql+psycopg2://&quot;</span></code> with no additional arguments to indicate an
empty DSN passed to libpq, which indicates to connect to “localhost” with
no username, password, or database given. Pull request courtesy Julian
Mehnle.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4562">#4562</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.2-5"><span class="target" id="change-4ed436b64a29a95f3993b18e66e34bc0"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4ed436b64a29a95f3993b18e66e34bc0">¶</a></span><p>Modified the <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Select.with_for_update.params.of" title="sqlalchemy.sql.expression.Select.with_for_update"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Select.with_for_update.of</span></code></a> parameter so that if a
join or other composed selectable is passed, the individual <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
objects will be filtered from it, allowing one to pass a join() object to
the parameter, as occurs normally when using joined table inheritance with
the ORM.  Pull request courtesy Raymond Lu.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4550">#4550</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.1">
<h2 class="release-version">1.3.1<a class="headerlink" href="#change-1.3.1" title="Permalink to this headline">¶</a></h2>
Released: March 9, 2019<section id="change-1.3.1-orm">
<h3>orm<a class="headerlink" href="#change-1.3.1-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.1-0"><span class="target" id="change-bb2cb9d2332fa1bd029f6bc3f365303e"><strong>[orm] [bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-bb2cb9d2332fa1bd029f6bc3f365303e">¶</a></span><p>Fixed regression where an association proxy linked to a synonym would no
longer work, both at instance level and at class level.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4522">#4522</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.1-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.1-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.1-1"><span class="target" id="change-4bfabd228e99f4e50dbc2320ecda40f7"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4bfabd228e99f4e50dbc2320ecda40f7">¶</a></span><p>A commit() is emitted after an isolation level change to SNAPSHOT, as both
pyodbc and pymssql open an implicit transaction which blocks subsequent SQL
from being emitted in the current transaction.</p>
<p>This change is also <strong>backported</strong> to: 1.2.19</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4536">#4536</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.1-2"><span class="target" id="change-9f6073d7d38d609acd14d89b92ccec5c"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9f6073d7d38d609acd14d89b92ccec5c">¶</a></span><p>Fixed regression in SQL Server reflection due to <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4393">#4393</a> where the
removal of open-ended <code class="docutils literal notranslate"><span class="pre">**kw</span></code> from the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Float" title="sqlalchemy.types.Float"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></a> datatype caused
reflection of this type to fail due to a “scale” argument being passed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4525">#4525</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.0">
<h2 class="release-version">1.3.0<a class="headerlink" href="#change-1.3.0" title="Permalink to this headline">¶</a></h2>
Released: March 4, 2019<section id="change-1.3.0-orm">
<h3>orm<a class="headerlink" href="#change-1.3.0-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0-0"><span class="target" id="change-9318d41138de43df43dbf845d075c092"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9318d41138de43df43dbf845d075c092">¶</a></span><p>The <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a> method can now accept a dictionary of attribute keys
and values as a means of indicating the primary key value to load; is
particularly useful for composite primary keys.  Pull request courtesy
Sanjana S.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4316">#4316</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0-1"><span class="target" id="change-d6a4de873a904452c25ab365ad777e73"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d6a4de873a904452c25ab365ad777e73">¶</a></span><p>A SQL expression can now be assigned to a primary key attribute for an ORM
flush in the same manner as ordinary attributes as described in
<a class="reference internal" href="../orm/persistence_techniques.html#flush-embedded-sql-expressions"><span class="std std-ref">Embedding SQL Insert/Update Expressions into a Flush</span></a> where the expression will be evaulated
and then returned to the ORM using RETURNING, or in the case of pysqlite,
works using the cursor.lastrowid attribute.Requires either a database that
supports RETURNING (e.g. Postgresql, Oracle, SQL Server) or pysqlite.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3133">#3133</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0-engine">
<h3>engine<a class="headerlink" href="#change-1.3.0-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0-2"><span class="target" id="change-20c3de1ba4832c1a2fd44a092656b9ef"><strong>[engine] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-20c3de1ba4832c1a2fd44a092656b9ef">¶</a></span><p>Revised the formatting for <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.StatementError" title="sqlalchemy.exc.StatementError"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatementError</span></code></a> when stringified. Each
error detail is broken up over multiple newlines instead of spaced out on a
single line.  Additionally, the SQL representation now stringifies the SQL
statement rather than using <code class="docutils literal notranslate"><span class="pre">repr()</span></code>, so that newlines are rendered as is.
Pull request courtesy Nate Clark.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4500"><span class="std std-ref">Changed StatementError formatting (newlines and %s)</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4500">#4500</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0-sql">
<h3>sql<a class="headerlink" href="#change-1.3.0-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0-3"><span class="target" id="change-369f705ea57081237d4a2106a01966f6"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-369f705ea57081237d4a2106a01966f6">¶</a></span><p>The <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal notranslate"><span class="pre">Alias</span></code></a> class and related subclasses <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.CTE" title="sqlalchemy.sql.expression.CTE"><code class="xref py py-class docutils literal notranslate"><span class="pre">CTE</span></code></a>,
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Lateral" title="sqlalchemy.sql.expression.Lateral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lateral</span></code></a> and <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.TableSample" title="sqlalchemy.sql.expression.TableSample"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableSample</span></code></a> have been reworked so that it is
not possible for a user to construct the objects directly.  These constructs
require that the standalone construction function or selectable-bound method
be used to instantiate new objects.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4509">#4509</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0-schema">
<h3>schema<a class="headerlink" href="#change-1.3.0-schema" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0-4"><span class="target" id="change-64ac776996da1a5c3e3460b4c0f0b257"><strong>[schema] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-64ac776996da1a5c3e3460b4c0f0b257">¶</a></span><p>Added new parameters <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.params.resolve_fks" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.resolve_fks</span></code></a> and
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData.reflect.params.resolve_fks" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">MetaData.reflect.resolve_fks</span></code></a> which when set to False will
disable the automatic reflection of related tables encountered in
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.ForeignKey" title="sqlalchemy.schema.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a> objects, which can both reduce SQL overhead for omitted
tables as well as avoid tables that can’t be reflected for database-specific
reasons.  Two <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects present in the same <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a>
collection can still refer to each other even if the reflection of the two
tables occurred separately.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4517">#4517</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.0b3">
<h2 class="release-version">1.3.0b3<a class="headerlink" href="#change-1.3.0b3" title="Permalink to this headline">¶</a></h2>
Released: February 8, 2019<section id="change-1.3.0b3-orm">
<h3>orm<a class="headerlink" href="#change-1.3.0b3-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b3-0"><span class="target" id="change-9824ef7ff64a049136769ccf353ec7b3"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9824ef7ff64a049136769ccf353ec7b3">¶</a></span><p>Improved the behavior of <a class="reference internal" href="../orm/inheritance_loading.html#sqlalchemy.orm.with_polymorphic" title="sqlalchemy.orm.with_polymorphic"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_polymorphic()</span></code></a> in conjunction with
loader options, in particular wildcard operations as well as
<a class="reference internal" href="../orm/loading_columns.html#sqlalchemy.orm.load_only" title="sqlalchemy.orm.load_only"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_only()</span></code></a>.  The polymorphic object will be more accurately
targeted so that column-level options on the entity will correctly take
effect.The issue is a continuation of the same kinds of things fixed in
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4468">#4468</a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4469">#4469</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b3-orm-declarative">
<h3>orm declarative<a class="headerlink" href="#change-1.3.0b3-orm-declarative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b3-1"><span class="target" id="change-e9cdb733b3e1ecf9c994e540d7366733"><strong>[orm] [declarative] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-e9cdb733b3e1ecf9c994e540d7366733">¶</a></span><p>Added some helper exceptions that invoke when a mapping based on
<a class="reference internal" href="../orm/extensions/declarative/index.html#sqlalchemy.ext.declarative.AbstractConcreteBase" title="sqlalchemy.ext.declarative.AbstractConcreteBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractConcreteBase</span></code></a>, <a class="reference internal" href="../orm/extensions/declarative/index.html#sqlalchemy.ext.declarative.DeferredReflection" title="sqlalchemy.ext.declarative.DeferredReflection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredReflection</span></code></a>, or
<code class="xref py py-class docutils literal notranslate"><span class="pre">AutoMap</span></code> is used before the mapping is ready to be used, which
contain descriptive information on the class, rather than falling through
into other failure modes that are less informative.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4470">#4470</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b3-sql">
<h3>sql<a class="headerlink" href="#change-1.3.0b3-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b3-2"><span class="target" id="change-096e1e64a6a2c7ad62313c83506341a3"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-096e1e64a6a2c7ad62313c83506341a3">¶</a></span><p>Fully removed the behavior of strings passed directly as components of a
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> or <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object being coerced to <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a>
constructs automatically; the warning that has been emitted is now an
ArgumentError or in the case of order_by() / group_by() a CompileError.
This has emitted a warning since version 1.0 however its presence continues
to create concerns for the potential of mis-use of this behavior.</p>
<p>Note that public CVEs have been posted for order_by() / group_by() which
are resolved by this commit:  CVE-2019-7164  CVE-2019-7548</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4481"><span class="std std-ref">Coercion of string SQL fragments to text() fully removed</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4481">#4481</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b3-3"><span class="target" id="change-2da08b51a38dcb9b9335b7c427b5c33d"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2da08b51a38dcb9b9335b7c427b5c33d">¶</a></span><p>Quoting is applied to <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.Function" title="sqlalchemy.sql.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> names, those which are usually but
not necessarily generated from the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.func" title="sqlalchemy.sql.expression.func"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.func</span></code></a> construct,  at compile
time if they contain illegal characters, such as spaces or punctuation. The
names are as before treated as case insensitive however, meaning if the
names contain uppercase or mixed case characters, that alone does not
trigger quoting. The case insensitivity is currently maintained for
backwards compatibility.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4467">#4467</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b3-4"><span class="target" id="change-6f9078780a4e13f9da4579ba3037cb2c"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6f9078780a4e13f9da4579ba3037cb2c">¶</a></span><p>Added “SQL phrase validation” to key DDL phrases that are accepted as plain
strings, including <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.ForeignKeyConstraint.params.on_delete" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ForeignKeyConstraint.on_delete</span></code></a>,
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.ForeignKeyConstraint.params.on_update" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ForeignKeyConstraint.on_update</span></code></a>,
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ExcludeConstraint.params.using" title="sqlalchemy.dialects.postgresql.ExcludeConstraint"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ExcludeConstraint.using</span></code></a>,
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.ForeignKeyConstraint.params.initially" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ForeignKeyConstraint.initially</span></code></a>, for areas where a series of SQL
keywords only are expected.Any non-space characters that suggest the phrase
would need to be quoted will raise a <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.CompileError" title="sqlalchemy.exc.CompileError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompileError</span></code></a>.   This change
is related to the series of changes committed as part of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4481">#4481</a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4481">#4481</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b3-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.0b3-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b3-5"><span class="target" id="change-d60777a86906baffe2c58f261906613f"><strong>[postgresql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d60777a86906baffe2c58f261906613f">¶</a></span><p>Fixed issue where using an uppercase name for an index type (e.g. GIST,
BTREE, etc. ) or an EXCLUDE constraint would treat it as an identifier to
be quoted, rather than rendering it as is. The new behavior converts these
types to lowercase and ensures they contain only valid SQL characters.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4473">#4473</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b3-misc">
<h3>misc<a class="headerlink" href="#change-1.3.0b3-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b3-6"><span class="target" id="change-ea33e18bbba6450980840d4e8c2874a7"><strong>[change] [tests]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ea33e18bbba6450980840d4e8c2874a7">¶</a></span><p>The test system has removed support for Nose, which is unmaintained for
several years and is producing warnings under Python 3. The test suite is
currently standardized on Pytest.  Pull request courtesy Parth Shandilya.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4460">#4460</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b3-7"><span class="target" id="change-11e958da2343b2aa4f78610a74d5fe2f"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-11e958da2343b2aa4f78610a74d5fe2f">¶</a></span><p>Implemented a more comprehensive assignment operation (e.g. “bulk replace”)
when using association proxy with sets or dictionaries.  Fixes the problem
of redundant proxy objects being created to replace the old ones, which
leads to excessive events and SQL and in the case of unique constraints
will cause the flush to fail.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-2642"><span class="std std-ref">Implemented bulk replace for sets, dicts with AssociationProxy</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/2642">#2642</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.0b2">
<h2 class="release-version">1.3.0b2<a class="headerlink" href="#change-1.3.0b2" title="Permalink to this headline">¶</a></h2>
Released: January 25, 2019<section id="change-1.3.0b2-general">
<h3>general<a class="headerlink" href="#change-1.3.0b2-general" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-0"><span class="target" id="change-823251756ce0c54ec326a4f53bae7d37"><strong>[general] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-823251756ce0c54ec326a4f53bae7d37">¶</a></span><p>A large change throughout the library has ensured that all objects,
parameters, and behaviors which have been noted as deprecated or legacy now
emit <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> warnings when invoked.As the Python 3
interpreter now defaults to displaying deprecation warnings, as well as that
modern test suites based on tools like tox and pytest tend to display
deprecation warnings, this change should make it easier to note what API
features are obsolete. A major rationale for this change is so that long-
deprecated features that nonetheless still see continue to see real world
use can  finally be removed in the near future; the biggest example of this
are the <code class="xref py py-class docutils literal notranslate"><span class="pre">SessionExtension</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">MapperExtension</span></code> classes as
well as a handful of other pre-event extension hooks, which have been
deprecated since version 0.7 but still remain in the library.  Another is
that several major longstanding behaviors are to be deprecated as well,
including the threadlocal engine strategy, the convert_unicode flag, and non
primary mappers.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4393-general"><span class="std std-ref">Deprecation warnings are emitted for all deprecated elements; new deprecations added</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4393">#4393</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-orm">
<h3>orm<a class="headerlink" href="#change-1.3.0b2-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-1"><span class="target" id="change-6c6af33a3cb496179dc2f6cbc80deb14"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-6c6af33a3cb496179dc2f6cbc80deb14">¶</a></span><p>Implemented a new feature whereby the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.util.AliasedClass" title="sqlalchemy.orm.util.AliasedClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code></a> construct can
now be used as the target of a <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a>.  This allows the
concept of “non primary mappers” to no longer be necessary, as the
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.util.AliasedClass" title="sqlalchemy.orm.util.AliasedClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code></a> is much easier to configure and automatically inherits
all the relationships of the mapped class, as well as preserves the
ability for loader options to work normally.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4423"><span class="std std-ref">Relationship to AliasedClass replaces the need for non primary mappers</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4423">#4423</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-2"><span class="target" id="change-985b6ac7e8291e905e5881009eeed1bf"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-985b6ac7e8291e905e5881009eeed1bf">¶</a></span><p>Added new <a class="reference internal" href="../orm/events.html#sqlalchemy.orm.MapperEvents.before_mapper_configured" title="sqlalchemy.orm.MapperEvents.before_mapper_configured"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.before_mapper_configured()</span></code></a> event.   This
event complements the other “configure” stage mapper events with a per
mapper event that receives each <a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> right before its
configure step, and additionally may be used to prevent or delay the
configuration of specific <a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> objects using a new
return value <code class="xref py py-attr docutils literal notranslate"><span class="pre">interfaces.EXT_SKIP</span></code>.  See the
documentation link for an example.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../orm/events.html#sqlalchemy.orm.MapperEvents.before_mapper_configured" title="sqlalchemy.orm.MapperEvents.before_mapper_configured"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MapperEvents.before_mapper_configured()</span></code></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4397">#4397</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-3"><span class="target" id="change-91d164d060931acf4b7b0b5fcc836ef5"><strong>[orm] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-91d164d060931acf4b7b0b5fcc836ef5">¶</a></span><p>Added a new function <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.close_all_sessions" title="sqlalchemy.orm.close_all_sessions"><code class="xref py py-func docutils literal notranslate"><span class="pre">close_all_sessions()</span></code></a> which takes
over the task of the <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.close_all" title="sqlalchemy.orm.Session.close_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.close_all()</span></code></a> method, which
is now deprecated as this is confusing as a classmethod.
Pull request courtesy Augustin Trancart.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4412">#4412</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-4"><span class="target" id="change-93b931b84e834f1631c8fd4f2e956af6"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-93b931b84e834f1631c8fd4f2e956af6">¶</a></span><p>Fixed long-standing issue where duplicate collection members would cause a
backref to delete the association between the member and its parent object
when one of the duplicates were removed, as occurs as a side effect of
swapping two objects in one statement.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-1103"><span class="std std-ref">Many-to-one backref checks for collection duplicates during remove operation</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/1103">#1103</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-5"><span class="target" id="change-5952a958e33dc98bd5740b8db114463b"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5952a958e33dc98bd5740b8db114463b">¶</a></span><p>Extended the fix first made as part of <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3287">#3287</a>, where a loader option
made against a subclass using a wildcard would extend itself to include
application of the wildcard to attributes on the super classes as well, to a
“bound” loader option as well, e.g. in an expression like
<code class="docutils literal notranslate"><span class="pre">Load(SomeSubClass).load_only('foo')</span></code>.  Columns that are part of the
parent class of <code class="docutils literal notranslate"><span class="pre">SomeSubClass</span></code> will also be excluded in the same way as if
the unbound option <code class="docutils literal notranslate"><span class="pre">load_only('foo')</span></code> were used.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4373">#4373</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-6"><span class="target" id="change-06bb19987596baf9c8e09fab0780a264"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-06bb19987596baf9c8e09fab0780a264">¶</a></span><p>Improved error messages emitted by the ORM in the area of loader option
traversal.  This includes early detection of mis-matched loader strategies
along with a clearer explanation why these strategies don’t match.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4433">#4433</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-7"><span class="target" id="change-a96f862c4415770a1b41ea60f51fd80d"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a96f862c4415770a1b41ea60f51fd80d">¶</a></span><p>The “remove” event for collections is now called before the item is removed
in the case of the <code class="docutils literal notranslate"><span class="pre">collection.remove()</span></code> method, as is consistent with the
behavior for most other forms of collection item removal (such as
<code class="docutils literal notranslate"><span class="pre">__delitem__</span></code>, replacement under <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code>).  For <code class="docutils literal notranslate"><span class="pre">pop()</span></code> methods,
the remove event still fires after the operation.</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-8"><span class="target" id="change-afad6c1bde8bd7f2c60ed840227d8020"><strong>[orm] [bug] [engine]</strong> <a class="changelog-reference headerlink reference internal" href="#change-afad6c1bde8bd7f2c60ed840227d8020">¶</a></span><p>Added accessors for execution options to Core and ORM, via
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.get_execution_options" title="sqlalchemy.orm.Query.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get_execution_options()</span></code></a>,
<a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.get_execution_options" title="sqlalchemy.engine.Connection.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.get_execution_options()</span></code></a>,
<a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine.get_execution_options" title="sqlalchemy.engine.Engine.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.get_execution_options()</span></code></a>, and
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Executable.get_execution_options" title="sqlalchemy.sql.expression.Executable.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Executable.get_execution_options()</span></code></a>.  PR courtesy Daniel Lister.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4464">#4464</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-9"><span class="target" id="change-d2b955e8847391cb31690d7bf292ad08"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d2b955e8847391cb31690d7bf292ad08">¶</a></span><p>Fixed issue in association proxy due to <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3423">#3423</a> which caused the use
of custom <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.PropComparator" title="sqlalchemy.orm.PropComparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropComparator</span></code></a> objects with hybrid attributes, such as
the one demonstrated in  the <code class="docutils literal notranslate"><span class="pre">dictlike-polymorphic</span></code> example to not
function within an association proxy.  The strictness that was added in
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3423">#3423</a> has been relaxed, and additional logic to accommodate for
an association proxy that links to a custom hybrid have been added.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4446">#4446</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-10"><span class="target" id="change-155445ae71bc6bd71bc606cbbc203d6e"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-155445ae71bc6bd71bc606cbbc203d6e">¶</a></span><p>Implemented the <code class="docutils literal notranslate"><span class="pre">.get_history()</span></code> method, which also implies availability
of <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.AttributeState.history" title="sqlalchemy.orm.AttributeState.history"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AttributeState.history</span></code></a>, for <a class="reference internal" href="../orm/mapped_attributes.html#sqlalchemy.orm.synonym" title="sqlalchemy.orm.synonym"><code class="xref py py-func docutils literal notranslate"><span class="pre">synonym()</span></code></a> attributes.
Previously, trying to access attribute history via a synonym would raise an
<code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3777">#3777</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-orm-declarative">
<h3>orm declarative<a class="headerlink" href="#change-1.3.0b2-orm-declarative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-11"><span class="target" id="change-317f6719daf2eb3a27c25ffa431a70da"><strong>[bug] [orm declarative]</strong> <a class="changelog-reference headerlink reference internal" href="#change-317f6719daf2eb3a27c25ffa431a70da">¶</a></span><p>Added a <code class="docutils literal notranslate"><span class="pre">__clause_element__()</span></code> method to <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.ColumnProperty" title="sqlalchemy.orm.ColumnProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnProperty</span></code></a> which
can allow the usage of a not-fully-declared column or deferred attribute in
a declarative mapped class slightly more friendly when it’s used in a
constraint or other column-oriented scenario within the class declaration,
though this still can’t work in open-ended expressions; prefer to call the
<a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.ColumnProperty.expression" title="sqlalchemy.orm.ColumnProperty.expression"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ColumnProperty.expression</span></code></a> attribute if receiving <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4372">#4372</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-engine">
<h3>engine<a class="headerlink" href="#change-1.3.0b2-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-12"><span class="target" id="change-8cd1c34d591605e6915158d33d334b73"><strong>[engine] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8cd1c34d591605e6915158d33d334b73">¶</a></span><p>Added public accessor <code class="xref py py-meth docutils literal notranslate"><span class="pre">QueuePool.timeout()</span></code> that returns the configured
timeout for a <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> object.  Pull request courtesy Irina Delamare.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3689">#3689</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-13"><span class="target" id="change-b4f464d4ac6bb689736f87e3aa169707"><strong>[engine] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b4f464d4ac6bb689736f87e3aa169707">¶</a></span><p>The “threadlocal” engine strategy which has been a legacy feature of
SQLAlchemy since around version 0.2 is now deprecated, along with the
<a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.Pool.params.threadlocal" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.threadlocal</span></code></a> parameter of <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> which has no
effect in most modern use cases.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4393-threadlocal"><span class="std std-ref">“threadlocal” engine strategy deprecated</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4393">#4393</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-sql">
<h3>sql<a class="headerlink" href="#change-1.3.0b2-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-14"><span class="target" id="change-0e26b03ec9e5135d1a2f6b009a0bfa8b"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-0e26b03ec9e5135d1a2f6b009a0bfa8b">¶</a></span><p>Amended the <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.AnsiFunction" title="sqlalchemy.sql.functions.AnsiFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnsiFunction</span></code></a> class, the base of common SQL
functions like <code class="docutils literal notranslate"><span class="pre">CURRENT_TIMESTAMP</span></code>, to accept positional arguments
like a regular ad-hoc function.  This to suit the case that many of
these functions on specific backends accept arguments such as
“fractional seconds” precision and such.  If the function is created
with arguments, it renders the parenthesis and the arguments.  If
no arguments are present, the compiler generates the non-parenthesized form.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4386">#4386</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b2-15"><span class="target" id="change-a4c66fb948a7b7e678b45144aa05d940"><strong>[sql] [change]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a4c66fb948a7b7e678b45144aa05d940">¶</a></span><p>The <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.convert_unicode" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.convert_unicode</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String.params.convert_unicode" title="sqlalchemy.types.String"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">String.convert_unicode</span></code></a> parameters have been deprecated.  These
parameters were built back when most Python DBAPIs had little to no support
for Python Unicode objects, and SQLAlchemy needed to take on the very
complex task of marshalling data and SQL strings between Unicode and
bytestrings throughout the system in a performant way.  Thanks to Python 3,
DBAPIs were compelled to adapt to Unicode-aware APIs and today all DBAPIs
supported by SQLAlchemy support Unicode natively, including on Python 2,
allowing this long-lived and very complicated feature to finally be (mostly)
removed.  There are still of course a few Python 2 edge cases where
SQLAlchemy has to deal with Unicode however these are handled automatically;
in modern use, there should be no need for end-user interaction with these
flags.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4393-convertunicode"><span class="std std-ref">convert_unicode parameters deprecated</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4393">#4393</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.0b2-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-16"><span class="target" id="change-f0b4de97ec1342d9d0b0c78034929cdd"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f0b4de97ec1342d9d0b0c78034929cdd">¶</a></span><p>The <code class="docutils literal notranslate"><span class="pre">literal_processor</span></code> for the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a> datatypes now render an <code class="docutils literal notranslate"><span class="pre">N</span></code> character in front of
the literal string expression as required by SQL Server for Unicode string
values rendered in SQL expressions.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4442">#4442</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b2-misc">
<h3>misc<a class="headerlink" href="#change-1.3.0b2-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b2-17"><span class="target" id="change-4ae4f352dab5c983ba9413aaab186694"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4ae4f352dab5c983ba9413aaab186694">¶</a></span><p>Fixed a regression in 1.3.0b1 caused by <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3423">#3423</a> where association
proxy objects that access an attribute that’s only present on a polymorphic
subclass would raise an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> even though the actual instance
being accessed was an instance of that subclass.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4401">#4401</a></p>
</p>
</li>
</ul>
</section>
</section>
<section id="change-1.3.0b1">
<h2 class="release-version">1.3.0b1<a class="headerlink" href="#change-1.3.0b1" title="Permalink to this headline">¶</a></h2>
Released: November 16, 2018<section id="change-1.3.0b1-orm">
<h3>orm<a class="headerlink" href="#change-1.3.0b1-orm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-0"><span class="target" id="change-82670998e42ec619e51a2cbd5bac57d0"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-82670998e42ec619e51a2cbd5bac57d0">¶</a></span><p>Added new feature <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.only_return_tuples" title="sqlalchemy.orm.Query.only_return_tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.only_return_tuples()</span></code></a>.  Causes the
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object to return keyed tuple objects unconditionally even
if the query is against a single entity.   Pull request courtesy Eric
Atkin.</p>
<p>This change is also <strong>backported</strong> to: 1.2.5</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-1"><span class="target" id="change-74af19c2c3a9f1fdd4f9920a1a96b50e"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-74af19c2c3a9f1fdd4f9920a1a96b50e">¶</a></span><p>Added new flag <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.bulk_save_objects.params.preserve_order" title="sqlalchemy.orm.Session.bulk_save_objects"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Session.bulk_save_objects.preserve_order</span></code></a> to the
<a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session.bulk_save_objects" title="sqlalchemy.orm.Session.bulk_save_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.bulk_save_objects()</span></code></a> method, which defaults to True. When set
to False, the given mappings will be grouped into inserts and updates per
each object type, to allow for greater opportunities to batch common
operations together.  Pull request courtesy Alessandro Cucci.</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-2"><span class="target" id="change-9d01ecd75495e32dcaf9bfed6d4168fb"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9d01ecd75495e32dcaf9bfed6d4168fb">¶</a></span><p>The “selectin” loader strategy now omits the JOIN in the case of a simple
one-to-many load, where it instead relies loads only from the related
table, relying upon the foreign key columns of the related table in order
to match up to primary keys in the parent table.   This optimization can be
disabled by setting the <a class="reference internal" href="../orm/relationship_api.html#sqlalchemy.orm.relationship.params.omit_join" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">relationship.omit_join</span></code></a> flag to False.
Many thanks to Jayson Reis for the efforts on this.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4340"><span class="std std-ref">selectin loading no longer uses JOIN for simple one-to-many</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4340">#4340</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-3"><span class="target" id="change-aeb0f6a92ae8559fd93969741f95c9ff"><strong>[orm] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-aeb0f6a92ae8559fd93969741f95c9ff">¶</a></span><p>Added <code class="docutils literal notranslate"><span class="pre">.info</span></code> dictionary to the <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.InstanceState" title="sqlalchemy.orm.InstanceState"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceState</span></code></a> class, the object
that comes from calling <a class="reference internal" href="../core/inspection.html#sqlalchemy.inspect" title="sqlalchemy.inspect"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect()</span></code></a> on a mapped object.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4257"><span class="std std-ref">info dictionary added to InstanceState</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4257">#4257</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-4"><span class="target" id="change-90b24d2b4df07a21c167a98323104f4e"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-90b24d2b4df07a21c167a98323104f4e">¶</a></span><p>Fixed bug where use of <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.Lateral" title="sqlalchemy.sql.expression.Lateral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lateral</span></code></a> construct in conjunction with
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> as well as <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.select_entity_from" title="sqlalchemy.orm.Query.select_entity_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code></a> would not
apply clause adaption to the right side of the join.   “lateral” introduces
the use case of the right side of a join being correlatable.  Previously,
adaptation of this clause wasn’t considered.   Note that in 1.2 only,
a selectable introduced by <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.subquery" title="sqlalchemy.orm.Query.subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.subquery()</span></code></a> is still not adapted
due to <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4304">#4304</a>; the selectable needs to be produced by the
<a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> function to be the right side of the “lateral” join.</p>
<p>This change is also <strong>backported</strong> to: 1.2.12</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4334">#4334</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-5"><span class="target" id="change-fe5ca788e10f93a43a134c3e104d47ed"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fe5ca788e10f93a43a134c3e104d47ed">¶</a></span><p>Fixed issue regarding passive_deletes=”all”, where the foreign key
attribute of an object is maintained with its value even after the object
is removed from its parent collection.  Previously, the unit of work would
set this to NULL even though passive_deletes indicated it should not be
modified.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3844"><span class="std std-ref">passive_deletes=’all’ will leave FK unchanged for object removed from collection</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3844">#3844</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-6"><span class="target" id="change-8810507a2cb170c19ab69225b6e011cd"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-8810507a2cb170c19ab69225b6e011cd">¶</a></span><p>Improved the behavior of a relationship-bound many-to-one object expression
such that the retrieval of column values on the related object are now
resilient against the object being detached from its parent
<a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, even if the attribute has been expired.  New features
within the <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.InstanceState" title="sqlalchemy.orm.InstanceState"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceState</span></code></a> are used to memoize the last known value
of a particular column attribute before its expired, so that the expression
can still evaluate when the object is detached and expired at the same
time.  Error conditions are also improved using modern attribute state
features to produce more specific messages as needed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4359"><span class="std std-ref">Improvement to the behavior of many-to-one query expressions</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4359">#4359</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-7"><span class="target" id="change-b0abbcc6d85a806caf5e58024c13e001"><strong>[orm] [bug] [mysql] [postgresql]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b0abbcc6d85a806caf5e58024c13e001">¶</a></span><p>The ORM now doubles the “FOR UPDATE” clause within the subquery that
renders in conjunction with joined eager loading in some cases, as it has
been observed that MySQL does not lock the rows from a subquery.   This
means the query renders with two FOR UPDATE clauses; note that on some
backends such as Oracle, FOR UPDATE clauses on subqueries are silently
ignored since they are unnecessary.  Additionally, in the case of the “OF”
clause used primarily with PostgreSQL, the FOR UPDATE is rendered only on
the inner subquery when this is used so that the selectable can be targeted
to the table within the SELECT statement.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4246"><span class="std std-ref">FOR UPDATE clause is rendered within the joined eager load subquery as well as outside</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4246">#4246</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-8"><span class="target" id="change-58f7747db4d2ca6a9ff6f7d86132b6d1"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-58f7747db4d2ca6a9ff6f7d86132b6d1">¶</a></span><p>Refactored <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> to further clarify the individual components
of structuring the join. This refactor adds the ability for
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> to determine the most appropriate “left” side of the
join when there is more than one element in the FROM list or the query is
against multiple entities.  If more than one FROM/entity matches, an error
is raised that asks for an ON clause to be specified to resolve the
ambiguity.  In particular this targets the regression we saw in
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4363">#4363</a> but is also of general use.   The codepaths within
<a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> are now easier to follow and the error cases are
decided more specifically at an earlier point in the operation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4365"><span class="std std-ref">Query.join() handles ambiguity in deciding the “left” side more explicitly</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4365">#4365</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-9"><span class="target" id="change-d6ba069fbb7edc3c9b392de4ec0aa4b9"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d6ba069fbb7edc3c9b392de4ec0aa4b9">¶</a></span><p>Fixed long-standing issue in <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> where a scalar subquery such
as produced by <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.exists" title="sqlalchemy.orm.Query.exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.exists()</span></code></a>, <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.as_scalar" title="sqlalchemy.orm.Query.as_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.as_scalar()</span></code></a> and other
derivations from <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.statement" title="sqlalchemy.orm.Query.statement"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code></a> would not correctly be adapted
when used in a new <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> that required entity adaptation, such as
when the query were turned into a union, or a from_self(), etc. The change
removes the “no adaptation” annotation from the <a class="reference internal" href="../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> object
produced by the <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.statement" title="sqlalchemy.orm.Query.statement"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code></a> accessor.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4304">#4304</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-10"><span class="target" id="change-1edbb0caaa73c3616a385f1125e591eb"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-1edbb0caaa73c3616a385f1125e591eb">¶</a></span><p>An informative exception is re-raised when a primary key value is not
sortable in Python during an ORM flush under Python 3, such as an <code class="docutils literal notranslate"><span class="pre">Enum</span></code>
that has no <code class="docutils literal notranslate"><span class="pre">__lt__()</span></code> method; normally Python 3 raises a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>
in this case.   The flush process sorts persistent objects by primary key
in Python so the values must be sortable.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4232">#4232</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-11"><span class="target" id="change-3ac5fa358763be242bfc623eaecd92a7"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3ac5fa358763be242bfc623eaecd92a7">¶</a></span><p>Removed the collection converter used by the <a class="reference internal" href="../orm/collections.html#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MappedCollection</span></code></a>
class. This converter was used only to assert that the incoming dictionary
keys matched that of their corresponding objects, and only during a bulk set
operation.  The converter can interfere with a custom validator or
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.AttributeEvents.bulk_replace" title="sqlalchemy.orm.AttributeEvents.bulk_replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AttributeEvents.bulk_replace()</span></code></a> listener that wants to convert
incoming values further.  The <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> which would be raised by this
converter when an incoming key didn’t match the value is removed; incoming
values during a bulk assignment will be keyed to their value-generated key,
and not the key that’s explicitly present in the dictionary.</p>
<p>Overall, &#64;converter is superseded by the
<a class="reference internal" href="../orm/events.html#sqlalchemy.orm.AttributeEvents.bulk_replace" title="sqlalchemy.orm.AttributeEvents.bulk_replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AttributeEvents.bulk_replace()</span></code></a> event handler added as part of
<a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3896">#3896</a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3604">#3604</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-12"><span class="target" id="change-9680d97f1ca1a315f99faf211e2c777c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-9680d97f1ca1a315f99faf211e2c777c">¶</a></span><p>Added new behavior to the lazy load that takes place when the “old” value of
a many-to-one is retrieved, such that exceptions which would be raised due
to either <code class="docutils literal notranslate"><span class="pre">lazy=&quot;raise&quot;</span></code> or a detached session error are skipped.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4353"><span class="std std-ref">Many-to-one replacement won’t raise for “raiseload” or detached for “old” object</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4353">#4353</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-13"><span class="target" id="change-fdaae3c040ae7c8ea321a730e5938d5c"><strong>[orm] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-fdaae3c040ae7c8ea321a730e5938d5c">¶</a></span><p>A long-standing oversight in the ORM, the <code class="docutils literal notranslate"><span class="pre">__delete__</span></code> method for a many-
to-one relationship was non-functional, e.g. for an operation such as <code class="docutils literal notranslate"><span class="pre">del</span>
<span class="pre">a.b</span></code>.  This is now implemented and is equivalent to setting the attribute
to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4354"><span class="std std-ref">“del” implemented for ORM attributes</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4354">#4354</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-orm-declarative">
<h3>orm declarative<a class="headerlink" href="#change-1.3.0b1-orm-declarative" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-14"><span class="target" id="change-5da521e28035da8c188413c97b5b25e6"><strong>[orm] [declarative] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5da521e28035da8c188413c97b5b25e6">¶</a></span><p>Fixed bug where declarative would not update the state of the
<a class="reference internal" href="../orm/mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> as far as what attributes were present, when additional
attributes were added or removed after the mapper attribute collections had
already been called and memoized.  Additionally, a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>
is now raised if a fully mapped attribute (e.g. column, relationship, etc.)
is deleted from a class that is currently mapped, since the mapper will not
function correctly if the attribute has been removed.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4133">#4133</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-engine">
<h3>engine<a class="headerlink" href="#change-1.3.0b1-engine" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-15"><span class="target" id="change-4ef9a807aeffe2e9a49a9e80121b1924"><strong>[engine] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-4ef9a807aeffe2e9a49a9e80121b1924">¶</a></span><p>Added new “lifo” mode to <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>, typically enabled by setting
the flag <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.pool_use_lifo" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_use_lifo</span></code></a> to True.   “lifo” mode
means the same connection just checked in will be the first to be checked
out again, allowing excess connections to be cleaned up from the server
side during periods of the pool being only partially utilized.  Pull request
courtesy Taem Park.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-pr467"><span class="std std-ref">New last-in-first-out strategy for QueuePool</span></a></p>
</div>
<p></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-sql">
<h3>sql<a class="headerlink" href="#change-1.3.0b1-sql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-16"><span class="target" id="change-f8553fccc490c50b62ae6d3cd1a6e051"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f8553fccc490c50b62ae6d3cd1a6e051">¶</a></span><p>Refactored <a class="reference internal" href="../core/internals.html#sqlalchemy.sql.compiler.SQLCompiler" title="sqlalchemy.sql.compiler.SQLCompiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLCompiler</span></code></a> to expose a
<a class="reference internal" href="../core/internals.html#sqlalchemy.sql.compiler.SQLCompiler.group_by_clause" title="sqlalchemy.sql.compiler.SQLCompiler.group_by_clause"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLCompiler.group_by_clause()</span></code></a> method similar to the
<a class="reference internal" href="../core/internals.html#sqlalchemy.sql.compiler.SQLCompiler.order_by_clause" title="sqlalchemy.sql.compiler.SQLCompiler.order_by_clause"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLCompiler.order_by_clause()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLCompiler.limit_clause()</span></code>
methods, which can be overridden by dialects to customize how GROUP BY
renders.  Pull request courtesy Samuel Chou.</p>
<p>This change is also <strong>backported</strong> to: 1.2.13</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-17"><span class="target" id="change-64b2c0b2ea56a550d42b32f946bb843c"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-64b2c0b2ea56a550d42b32f946bb843c">¶</a></span><p>Added <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> to the “string SQL” system that will render a
meaningful string expression (<code class="docutils literal notranslate"><span class="pre">&quot;&lt;next</span> <span class="pre">sequence</span> <span class="pre">value:</span> <span class="pre">my_sequence&gt;&quot;</span></code>)
when stringifying without a dialect a statement that includes a “sequence
nextvalue” expression, rather than raising a compilation error.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4144">#4144</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-18"><span class="target" id="change-58b8e69a995c21d8bfd9890f43d7e60b"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-58b8e69a995c21d8bfd9890f43d7e60b">¶</a></span><p>Added new naming convention tokens <code class="docutils literal notranslate"><span class="pre">column_0N_name</span></code>, <code class="docutils literal notranslate"><span class="pre">column_0_N_name</span></code>,
etc., which will render the names / keys / labels for all columns referenced
by a particular constraint in a sequence.  In order to accommodate for the
length of such a naming convention, the SQL compiler’s auto-truncation
feature now applies itself to constraint names as well, which creates a
shortened, deterministically generated name for the constraint that will
apply to a target backend without going over the character limit of that
backend.</p>
<p>The change also repairs two other issues.  One is that the  <code class="docutils literal notranslate"><span class="pre">column_0_key</span></code>
token wasn’t available even though this token was documented, the other was
that the <code class="docutils literal notranslate"><span class="pre">referred_column_0_name</span></code> token would  inadvertently render the
<code class="docutils literal notranslate"><span class="pre">.key</span></code> and not the <code class="docutils literal notranslate"><span class="pre">.name</span></code> of the column if these two values were
different.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3989"><span class="std std-ref">New multi-column naming convention tokens, long name truncation</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3989">#3989</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-19"><span class="target" id="change-cee1f4d663a92f30df15742c304c6961"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-cee1f4d663a92f30df15742c304c6961">¶</a></span><p>Added new logic to the “expanding IN” bound parameter feature whereby if
the given list is empty, a special “empty set” expression that is specific
to different backends is generated, thus allowing IN expressions to be
fully dynamic including empty IN expressions.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4271"><span class="std std-ref">Expanding IN feature now supports empty lists</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4271">#4271</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-20"><span class="target" id="change-29f7f330efd224a685fd110dbc955601"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-29f7f330efd224a685fd110dbc955601">¶</a></span><p>The Python builtin <code class="docutils literal notranslate"><span class="pre">dir()</span></code> is now supported for a SQLAlchemy “properties”
object, such as that of a Core columns collection (e.g. <code class="docutils literal notranslate"><span class="pre">.c</span></code>),
<code class="docutils literal notranslate"><span class="pre">mapper.attrs</span></code>, etc.  Allows iPython autocompletion to work as well.
Pull request courtesy Uwe Korn.</p>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-21"><span class="target" id="change-74d53ea4beaacc61386292725463830a"><strong>[sql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-74d53ea4beaacc61386292725463830a">¶</a></span><p>Added new feature <a class="reference internal" href="../core/functions.html#sqlalchemy.sql.functions.FunctionElement.as_comparison" title="sqlalchemy.sql.functions.FunctionElement.as_comparison"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FunctionElement.as_comparison()</span></code></a> which allows a SQL
function to act as a binary comparison operation that can work within the
ORM.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3831"><span class="std std-ref">Binary comparison interpretation for SQL functions</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3831">#3831</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-22"><span class="target" id="change-f689a26d3629c6719377d1fcee2eee72"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f689a26d3629c6719377d1fcee2eee72">¶</a></span><p>Added “like” based operators as “comparison” operators, including
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.startswith" title="sqlalchemy.sql.expression.ColumnOperators.startswith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.startswith()</span></code></a> <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.endswith" title="sqlalchemy.sql.expression.ColumnOperators.endswith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.endswith()</span></code></a>
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.ilike" title="sqlalchemy.sql.expression.ColumnOperators.ilike"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.ilike()</span></code></a> <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.notilike" title="sqlalchemy.sql.expression.ColumnOperators.notilike"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.notilike()</span></code></a> among many
others, so that all of these operators can be the basis for an ORM
“primaryjoin” condition.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4302">#4302</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-23"><span class="target" id="change-a8c39b13d40954d1ec2fa413ba93283e"><strong>[sql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-a8c39b13d40954d1ec2fa413ba93283e">¶</a></span><p>Fixed issue with <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.bind_expression" title="sqlalchemy.types.TypeEngine.bind_expression"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TypeEngine.bind_expression()</span></code></a> and
<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.column_expression" title="sqlalchemy.types.TypeEngine.column_expression"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TypeEngine.column_expression()</span></code></a> methods where these methods would not
work if the target type were part of a <a class="reference internal" href="../core/type_api.html#sqlalchemy.types.Variant" title="sqlalchemy.types.Variant"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code></a>, or other target
type of a <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a>.  Additionally, the SQL compiler now
calls upon the dialect-level implementation when it renders these methods
so that dialects can now provide for SQL-level processing for built-in
types.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3981"><span class="std std-ref">TypeEngine methods bind_expression, column_expression work with Variant, type-specific types</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3981">#3981</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-postgresql">
<h3>postgresql<a class="headerlink" href="#change-1.3.0b1-postgresql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-24"><span class="target" id="change-b9f84975e2ff0494556c8760438ab9fe"><strong>[postgresql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-b9f84975e2ff0494556c8760438ab9fe">¶</a></span><p>Added new PG type <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.REGCLASS" title="sqlalchemy.dialects.postgresql.REGCLASS"><code class="xref py py-class docutils literal notranslate"><span class="pre">REGCLASS</span></code></a> which assists in casting
table names to OID values.  Pull request courtesy Sebastian Bank.</p>
<p>This change is also <strong>backported</strong> to: 1.2.7</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4160">#4160</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-25"><span class="target" id="change-5f24a76d22ad3e2a0fb7605aadcd657b"><strong>[postgresql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-5f24a76d22ad3e2a0fb7605aadcd657b">¶</a></span><p>Added rudimental support for reflection of PostgreSQL
partitioned tables, e.g. that relkind=’p’ is added to reflection
queries that return table information.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4237"><span class="std std-ref">Added basic reflection support for PostgreSQL partitioned tables</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4237">#4237</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-mysql">
<h3>mysql<a class="headerlink" href="#change-1.3.0b1-mysql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-26"><span class="target" id="change-2ca251ff461d74aacf027f3eed92844a"><strong>[mysql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-2ca251ff461d74aacf027f3eed92844a">¶</a></span><p>Support added for the “WITH PARSER” syntax of CREATE FULLTEXT INDEX
in MySQL, using the <code class="docutils literal notranslate"><span class="pre">mysql_with_parser</span></code> keyword argument.  Reflection
is also supported, which accommodates MySQL’s special comment format
for reporting on this option as well.  Additionally, the “FULLTEXT” and
“SPATIAL” index prefixes are now reflected back into the <code class="docutils literal notranslate"><span class="pre">mysql_prefix</span></code>
index option.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4219">#4219</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-27"><span class="target" id="change-d48f2305e0809a3bf9a1eac6e6fd4f65"><strong>[mysql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-d48f2305e0809a3bf9a1eac6e6fd4f65">¶</a></span><p>Added support for the parameters in an ON DUPLICATE KEY UPDATE statement on
MySQL to be ordered, since parameter order in a MySQL UPDATE clause is
significant, in a similar manner as that described at
<a class="reference internal" href="../core/tutorial.html#updates-order-parameters"><span class="std std-ref">Parameter-Ordered Updates</span></a>.  Pull request courtesy Maxim Bublis.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-mysql-ondupordering"><span class="std std-ref">Control of parameter ordering within ON DUPLICATE KEY UPDATE</span></a></p>
</div>
<p></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-28"><span class="target" id="change-3f995f0f9ddd4176100a62954596165a"><strong>[mysql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-3f995f0f9ddd4176100a62954596165a">¶</a></span><p>The “pre-ping” feature of the connection pool now uses
the <code class="docutils literal notranslate"><span class="pre">ping()</span></code> method of the DBAPI connection in the case of
mysqlclient, PyMySQL and mysql-connector-python.  Pull request
courtesy Maxim Bublis.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-mysql-ping"><span class="std std-ref">Protocol-level ping now used for pre-ping</span></a></p>
</div>
<p></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-sqlite">
<h3>sqlite<a class="headerlink" href="#change-1.3.0b1-sqlite" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-29"><span class="target" id="change-ae84b9438454d2b118f79e2c77b514b8"><strong>[sqlite] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ae84b9438454d2b118f79e2c77b514b8">¶</a></span><p>Added support for SQLite’s json functionality via the new
SQLite implementation for <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a>, <a class="reference internal" href="../dialects/sqlite.html#sqlalchemy.dialects.sqlite.JSON" title="sqlalchemy.dialects.sqlite.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a>.
The name used for the type is <code class="docutils literal notranslate"><span class="pre">JSON</span></code>, following an example found at
SQLite’s own documentation. Pull request courtesy Ilja Everilä.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3850"><span class="std std-ref">Support for SQLite JSON Added</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3850">#3850</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-30"><span class="target" id="change-670275150261403de3cd1c425b604685"><strong>[sqlite] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-670275150261403de3cd1c425b604685">¶</a></span><p>Implemented the SQLite <code class="docutils literal notranslate"><span class="pre">ON</span> <span class="pre">CONFLICT</span></code> clause as understood at the DDL
level, e.g. for primary key, unique, and CHECK constraints as well as
specified on a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> to satisfy inline primary key and NOT NULL.
Pull request courtesy Denis Kataev.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4360"><span class="std std-ref">Support for SQLite ON CONFLICT in constraints added</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4360">#4360</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-mssql">
<h3>mssql<a class="headerlink" href="#change-1.3.0b1-mssql" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-31"><span class="target" id="change-22124fa5c93f7a843ededffef565710a"><strong>[mssql] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-22124fa5c93f7a843ededffef565710a">¶</a></span><p>Added <code class="docutils literal notranslate"><span class="pre">fast_executemany=True</span></code> parameter to the SQL Server pyodbc dialect,
which enables use of pyodbc’s new performance feature of the same name
when using Microsoft ODBC drivers.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4158"><span class="std std-ref">Support for pyodbc fast_executemany</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4158">#4158</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-32"><span class="target" id="change-66176c8a7b5a187f268e1ce7803f3a21"><strong>[mssql] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-66176c8a7b5a187f268e1ce7803f3a21">¶</a></span><p>Deprecated the use of <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> with SQL Server in order to affect
the “start” and “increment” of the IDENTITY value, in favor of new
parameters <code class="docutils literal notranslate"><span class="pre">mssql_identity_start</span></code> and <code class="docutils literal notranslate"><span class="pre">mssql_identity_increment</span></code> which
set these parameters directly.  <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> will be used to generate
real <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">SEQUENCE</span></code> DDL with SQL Server in a future release.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4362"><span class="std std-ref">New parameters to affect IDENTITY start and increment, use of Sequence deprecated</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4362">#4362</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-oracle">
<h3>oracle<a class="headerlink" href="#change-1.3.0b1-oracle" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-33"><span class="target" id="change-39b6e94b3055af74e4ca5816d0afad01"><strong>[oracle] [feature]</strong> <a class="changelog-reference headerlink reference internal" href="#change-39b6e94b3055af74e4ca5816d0afad01">¶</a></span><p>Added a new event currently used only by the cx_Oracle dialect,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.setiputsizes()</span></code>.  The event passes a dictionary of
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BindParameter</span></code></a> objects to DBAPI-specific type objects that will be
passed, after conversion to parameter names, to the cx_Oracle
<code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes()</span></code> method.  This allows both visibility into the
setinputsizes process as well as the ability to alter the behavior of what
datatypes are passed to this method.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../dialects/oracle.html#cx-oracle-setinputsizes"><span class="std std-ref">Fine grained control over cx_Oracle data binding performance with setinputsizes</span></a></p>
</div>
<p>This change is also <strong>backported</strong> to: 1.2.9</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4290">#4290</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-34"><span class="target" id="change-342d4880b6312dd4c15ee033fcfbea55"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-342d4880b6312dd4c15ee033fcfbea55">¶</a></span><p>Updated the parameters that can be sent to the cx_Oracle DBAPI to both allow
for all current parameters as well as for future parameters not added yet.
In addition, removed unused parameters that were deprecated in version 1.2,
and additionally we are now defaulting “threaded” to False.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4369"><span class="std std-ref">cx_Oracle connect arguments modernized, deprecated parameters removed</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4369">#4369</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-35"><span class="target" id="change-54fc6a60b98ea236b117f1a22bb56ac7"><strong>[oracle] [bug]</strong> <a class="changelog-reference headerlink reference internal" href="#change-54fc6a60b98ea236b117f1a22bb56ac7">¶</a></span><p>The Oracle dialect will no longer use the NCHAR/NCLOB datatypes
represent generic unicode strings or clob fields in conjunction with
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> and <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a> unless the flag
<code class="docutils literal notranslate"><span class="pre">use_nchar_for_unicode=True</span></code> is passed to <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> -
this includes CREATE TABLE behavior as well as <code class="docutils literal notranslate"><span class="pre">setinputsizes()</span></code> for
bound parameters.   On the read side, automatic Unicode conversion under
Python 2 has been added to CHAR/VARCHAR/CLOB result rows, to match the
behavior of cx_Oracle under Python 3.  In order to mitigate the performance
hit under Python 2, SQLAlchemy’s very performant (when C extensions
are built) native Unicode handlers are used under Python 2.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4242"><span class="std std-ref">National char datatypes de-emphasized for generic unicode, re-enabled with option</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4242">#4242</a></p>
</p>
</li>
</ul>
</section>
<section id="change-1.3.0b1-misc">
<h3>misc<a class="headerlink" href="#change-1.3.0b1-misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="caption" id="change-1.3.0b1-36"><span class="target" id="change-ebf60a359d3a5e8d3c048f04ce5781c9"><strong>[feature] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-ebf60a359d3a5e8d3c048f04ce5781c9">¶</a></span><p>Added new attribute <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.lazy_loaded_from" title="sqlalchemy.orm.Query.lazy_loaded_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.lazy_loaded_from</span></code></a> which is populated
with an <a class="reference internal" href="../orm/internals.html#sqlalchemy.orm.InstanceState" title="sqlalchemy.orm.InstanceState"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceState</span></code></a> that is using this <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> in
order to lazy load a relationship.  The rationale for this is that
it serves as a hint for the horizontal sharding feature to use, such that
the identity token of the state can be used as the default identity token
to use for the query within id_chooser().</p>
<p>This change is also <strong>backported</strong> to: 1.2.9</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4243">#4243</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-37"><span class="target" id="change-f1c0a3193681c4bfd50ea6406c1d2749"><strong>[feature] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f1c0a3193681c4bfd50ea6406c1d2749">¶</a></span><p>Added new feature <a class="reference internal" href="../orm/extensions/baked.html#sqlalchemy.ext.baked.BakedQuery.to_query" title="sqlalchemy.ext.baked.BakedQuery.to_query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BakedQuery.to_query()</span></code></a>, which allows for a
clean way of using one <a class="reference internal" href="../orm/extensions/baked.html#sqlalchemy.ext.baked.BakedQuery" title="sqlalchemy.ext.baked.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a> as a subquery inside of another
<a class="reference internal" href="../orm/extensions/baked.html#sqlalchemy.ext.baked.BakedQuery" title="sqlalchemy.ext.baked.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a> without needing to refer explicitly to a
<a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.</p>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4318">#4318</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-38"><span class="target" id="change-73815ba967c39d874ec295a76ae7f007"><strong>[feature] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-73815ba967c39d874ec295a76ae7f007">¶</a></span><p>The <a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy" title="sqlalchemy.ext.associationproxy.AssociationProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssociationProxy</span></code></a> now has standard column comparison operations
such as <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.like" title="sqlalchemy.sql.expression.ColumnOperators.like"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.like()</span></code></a> and
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.startswith" title="sqlalchemy.sql.expression.ColumnOperators.startswith"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.startswith()</span></code></a> available when the target attribute is a
plain column - the EXISTS expression that joins to the target table is
rendered as usual, but the column expression is then use within the WHERE
criteria of the EXISTS.  Note that this alters the behavior of the
<code class="docutils literal notranslate"><span class="pre">.contains()</span></code> method on the association proxy to make use of
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.ColumnOperators.contains" title="sqlalchemy.sql.expression.ColumnOperators.contains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColumnOperators.contains()</span></code></a> when used on a column-based attribute.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4351"><span class="std std-ref">AssociationProxy now provides standard column operators for a column-oriented target</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4351">#4351</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-39"><span class="target" id="change-419439dfcfd802c3c955085239eb1de3"><strong>[feature] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-419439dfcfd802c3c955085239eb1de3">¶</a></span><p>Added support for bulk <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.update" title="sqlalchemy.orm.Query.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.update()</span></code></a> and <a class="reference internal" href="../orm/query.html#sqlalchemy.orm.Query.delete" title="sqlalchemy.orm.Query.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.delete()</span></code></a>
to the <a class="reference internal" href="../orm/extensions/horizontal_shard.html#sqlalchemy.ext.horizontal_shard.ShardedQuery" title="sqlalchemy.ext.horizontal_shard.ShardedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardedQuery</span></code></a> class within the horizontal sharding
extension.  This also adds an additional expansion hook to the
bulk update/delete methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query._execute_crud()</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4196"><span class="std std-ref">Horizontal Sharding extension supports bulk update and delete methods</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4196">#4196</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-40"><span class="target" id="change-7063f0725026eae42ce1c653677cf03e"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7063f0725026eae42ce1c653677cf03e">¶</a></span><p>Reworked <a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy" title="sqlalchemy.ext.associationproxy.AssociationProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssociationProxy</span></code></a> to store state that’s specific to a
parent class in a separate object, so that a single
<a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy" title="sqlalchemy.ext.associationproxy.AssociationProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssociationProxy</span></code></a> can serve for multiple parent classes, as is
intrinsic to inheritance, without any ambiguity in the state returned by it.
A new method <a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy.for_class" title="sqlalchemy.ext.associationproxy.AssociationProxy.for_class"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AssociationProxy.for_class()</span></code></a> is added to allow
inspection of class-specific state.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-3423"><span class="std std-ref">AssociationProxy stores class-specific state on a per-class basis</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/3423">#3423</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-41"><span class="target" id="change-7d951b9fa17f94ac1b534c0500404d54"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-7d951b9fa17f94ac1b534c0500404d54">¶</a></span><p>The long-standing behavior of the association proxy collection maintaining
only a weak reference to the parent object is reverted; the proxy will now
maintain a strong reference to the parent for as long as the proxy
collection itself is also in memory, eliminating the “stale association
proxy” error. This change is being made on an experimental basis to see if
any use cases arise where it causes side effects.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4268"><span class="std std-ref">New Features and Improvements - Core</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4268">#4268</a></p>
</p>
</li>
<li><p class="caption" id="change-1.3.0b1-42"><span class="target" id="change-f99ba5b9f18fee57c252f94a26324d04"><strong>[bug] [ext]</strong> <a class="changelog-reference headerlink reference internal" href="#change-f99ba5b9f18fee57c252f94a26324d04">¶</a></span><p>Fixed multiple issues regarding de-association of scalar objects with the
association proxy.  <code class="docutils literal notranslate"><span class="pre">del</span></code> now works, and additionally a new flag
<a class="reference internal" href="../orm/extensions/associationproxy.html#sqlalchemy.ext.associationproxy.AssociationProxy.params.cascade_scalar_deletes" title="sqlalchemy.ext.associationproxy.AssociationProxy"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">AssociationProxy.cascade_scalar_deletes</span></code></a> is added, which when
set to True indicates that setting a scalar attribute to <code class="docutils literal notranslate"><span class="pre">None</span></code> or
deleting via <code class="docutils literal notranslate"><span class="pre">del</span></code> will also set the source association to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="migration_13.html#change-4308"><span class="std std-ref">Association proxy has new cascade_scalar_deletes flag</span></a></p>
</div>
<p>References: <a class="reference external" href="https://www.sqlalchemy.org/trac/ticket/4308">#4308</a></p>
</p>
</li>
</ul>
</section>
</section>
</section>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="changelog_14.html" title="previous chapter">1.4 Changelog</a>
        Next:
        <a href="changelog_12.html" title="next chapter">1.2 Changelog</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2021, the SQLAlchemy authors and contributors.


    <p><b>flambé!</b> the dragon and <b><i>The Alchemist</i></b> image designs created and generously donated by <a href="https://github.com/vmalloc">Rotem Yaari</a>.</p>

        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.1.2.
    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '1.4.23',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/detectmobile.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


